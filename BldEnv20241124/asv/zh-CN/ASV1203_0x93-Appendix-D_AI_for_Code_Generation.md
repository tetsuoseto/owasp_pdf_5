# 附录D：AI辅助的安全编码治理与验证

## 目标

本章定义了在软件开发过程中安全有效使用 AI 辅助编码工具的基线组织控制，确保整个软件开发生命周期（SDLC）中的安全性和可追溯性。

---

## AD.1 AI辅助的安全编码工作流程

在不削弱现有安全关卡的情况下，将人工智能工具集成到组织的安全软件开发生命周期（SSDLC）中。

|   #    | Description                                            | Level | Role |
| :----: | ------------------------------------------------------ | :---: | :--: |
| AD.1.1 | 验证已记录的工作流程是否描述了人工智能工具何时以及如何生成、重构或审查代码。                 |   1   | D/V  |
| AD.1.2 | 验证工作流程是否对应每个安全软件生命周期开发阶段（设计、实施、代码审查、测试、部署）。            |   2   |  D   |
| AD.1.3 | 验证是否对 AI 生成的代码收集了指标（例如，漏洞密度、平均检测时间），并将其与仅有人类编写的基线进行比较。 |   3   | D/V  |

---

## AD.2 人工智能工具资格认证与威胁建模

确保在采用人工智能编码工具之前，对其安全能力、风险和供应链影响进行评估。

|   #    | Description                                            | Level | Role |
| :----: | ------------------------------------------------------ | :---: | :--: |
| AD.2.1 | 验证每个人工智能工具的威胁模型是否识别了误用、模型反演、数据泄漏及依赖链风险。                |   1   | D/V  |
| AD.2.2 | 验证工具评估是否包括对任何本地组件的静态/动态分析以及对SaaS端点（TLS、认证/授权、日志记录）的评估。 |   2   |  D   |
| AD.2.3 | 验证评估是否遵循公认的框架，并在重大版本更改后重新执行评估。                         |   3   | D/V  |

---

## AD.3 安全提示与上下文管理

在为人工智能模型构建提示或上下文时，防止泄露机密信息、专有代码和个人数据。

|   #    | Description                                     | Level | Role |
| :----: | ----------------------------------------------- | :---: | :--: |
| AD.3.1 | 验证书面指导是否禁止在提示中发送秘密、凭证或机密数据。                     |   1   | D/V  |
| AD.3.2 | 验证技术控制（客户端编辑、批准的上下文过滤器）是否自动删除敏感信息。              |   2   |  D   |
| AD.3.3 | 验证提示和响应是否经过分词处理，在传输和存储过程中是否加密，并且保留期限是否符合数据分类政策。 |   3   | D/V  |

---

## AD.4 AI生成代码的验证

在代码合并或部署之前，检测并修复由 AI 输出引入的漏洞。

|   #    | Description                                                                               | Level | Role |
| :----: | ----------------------------------------------------------------------------------------- | :---: | :--: |
| AD.4.1 | 确保AI生成的代码始终经过人工代码审查。                                                                      |   1   | D/V  |
| AD.4.2 | 验证所有包含AI生成代码的拉取请求中，是否运行了自动扫描工具（静态应用安全测试/SAST、交互式应用安全测试/IAST、动态应用安全测试/DAST），并在发现严重问题时阻止合并。 |   2   |  D   |
| AD.4.3 | 验证差分模糊测试或基于属性的测试是否证明了安全关键行为（例如，输入验证、授权逻辑）。                                                |   3   | D/V  |

---

## AD.5 代码建议的可解释性与可追溯性

为审计员和开发人员提供有关建议提出原因及其演变过程的洞见。

|   #    | Description                                             | Level | Role |
| :----: | ------------------------------------------------------- | :---: | :--: |
| AD.5.1 | 验证提示/响应对是否已与提交ID一起记录。                                   |   1   | D/V  |
| AD.5.2 | 验证开发者是否能够呈现支持建议的模型引用（训练片段、文档）。                          |   2   |  D   |
| AD.5.3 | 验证解释性报告是否与设计工件一同存储，并在安全评审中被引用，以满足 ISO/IEC 42001 可追溯性原则。 |   3   | D/V  |

---

## AD.6 持续反馈与模型微调

随着时间推移提升模型安全性能，同时防止负面漂移。

|   #    | Description                                           | Level | Role |
| :----: | ----------------------------------------------------- | :---: | :--: |
| AD.6.1 | 验证开发人员是否能够标记不安全或不合规的建议，并且这些标记是否得到跟踪。                  |   1   | D/V  |
| AD.6.2 | 验证汇总的反馈是否用于定期微调或通过经过验证的安全编码语料库（例如 OWASP 作弊表）进行检索增强生成。 |   2   |  D   |
| AD.6.3 | 验证闭环评估系统在每次微调后运行回归测试；安全指标必须达到或超过先前基线才能部署。             |   3   | D/V  |

---

### 参考文献

* [NIST AI Risk Management Framework 1.0](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements](https://www.iso.org/standard/81230.html)
* [OWASP Secure Coding Practices — Quick Reference Guide](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/)

