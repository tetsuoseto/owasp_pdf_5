# التحقق من صحة إدخال المستخدم في المستوى C2

## هدف السيطرة

التحقق القوي من صحة مدخلات المستخدم هو خط الدفاع الأول ضد بعض أكثر الهجمات ضرراً على أنظمة الذكاء الاصطناعي. يمكن لهجمات حقن التعليمات تجاوز تعليمات النظام، وتسريب البيانات الحساسة، أو توجيه النموذج نحو سلوك غير مسموح به. ما لم تكن هناك فلاتر مخصصة وتسلسلات تعليمات منظمة، تُظهر الأبحاث أن "الهجمات متعددة المحاولات" التي تستغل نوافذ السياق الطويلة جدًا ستكون فعالة. بالإضافة إلى ذلك، يمكن للهجمات الطفيفة العدائية مثل تبديلات الحروف المتشابهة (homoglyph) أو لغة الشيفرة (leetspeak) أن تغير قرارات النموذج بصمت.

---

## دفاع ضد حقن الأوامر (C2.1)

حقن المطالبات هو أحد أعلى المخاطر لأنظمة الذكاء الاصطناعي. تستخدم الدفاعات ضد هذه التكتيك مزيجًا من مرشحات الأنماط الثابتة، والمصنفات الديناميكية، وإنفاذ تسلسل التعليمات.

|   #   | Description                                                                                                                                                                                   | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.1.1 | تحقق من أن مدخلات المستخدم يتم فحصها مقابل مكتبة محدثة باستمرار لأنماط حقن التعليمات المعروفة (كلمات تجاوز الحماية، "تجاهل السابق"، سلاسل التقمص، الهجمات غير المباشرة عبر HTML/URL).         |   1   | D/V  |
| 2.1.2 | تحقق من أن النظام يفرض تسلسلًا هرميًا للتعليمات حيث تتجاوز رسائل النظام أو المطور تعليمات المستخدم، حتى بعد توسيع نافذة السياق.                                                               |   1   | D/V  |
| 2.1.3 | تحقق من أن اختبارات التقييم العدائية (مثل مطالبات فريق الإحمر "ذات اللقطات المتعددة") تُجرى قبل كل إصدار للنموذج أو قالب المطالبة، مع تحديد عتبات لمعدل النجاح ووضع حاجبات آلية لمنع التراجع. |   2   | D/V  |
| 2.1.4 | تحقق من أن التعليمات التي تأتي من محتوى طرف ثالث (صفحات الويب، ملفات PDF، رسائل البريد الإلكتروني) يتم تنقيتها في سياق تحليل معزول قبل دمجها في التعليمات الرئيسية.                           |   2   |  D   |
| 2.1.5 | تحقق من أن جميع تحديثات قواعد تصفية المطالبات، إصدارات نماذج المصنفات، وتغييرات قائمة الحظر خاضعة للتحكم بالإصدار وقابلة للتدقيق.                                                             |   3   | D/V  |

---

## C2.2 مقاومة الأمثلة العدائية

نماذج معالجة اللغة الطبيعية (NLP) لا تزال عرضة لتغيرات طفيفة على مستوى الحروف أو الكلمات التي غالبًا ما يغفلها البشر ولكن تميل النماذج إلى تصنيفها بشكل خاطئ.

|   #   | Description                                                                                                                                                          | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.2.1 | تحقق من أن خطوات تطبيع الإدخال الأساسية (NFC يونيكود، تعيين الرموز المتشابهة، إزالة الفراغات الزائدة) تتم قبل التجزئة.                                               |   1   |  D   |
| 2.2.2 | تحقق من أن اكتشاف الشذوذ الإحصائي يحدد المدخلات التي تحتوي على مسافة تحرير غير معتادة عالية عن معايير اللغة، أو تكرار مفرط للرموز، أو مسافات تضمين غير طبيعية.       |   2   | D/V  |
| 2.2.3 | تحقق من أن خط أنابيب الاستدلال يدعم إصدارات النماذج المقواة بالتدريب العدائي الاختياري أو طبقات الدفاع (مثل العشوائية، التقطير الدفاعي) لنقاط النهاية عالية المخاطر. |   2   |  D   |
| 2.2.4 | تحقق من أن المدخلات المشبوهة العدائية يتم عزلها في منطقة الحجز، وتسجيلها مع جميع الحمولات الكاملة (بعد إزالة البيانات الشخصية الحساسة).                              |   2   |  V   |
| 2.2.5 | تأكد من تتبع مقاييس الصلابة (معدل نجاح مجموعات الهجمات المعروفة) مع مرور الوقت وأن التراجعات تؤدي إلى حظر الإصدار.                                                   |   3   | D/V  |

---

## C2.3 التحقق من صحة المخطط والنوع والطول

الهجمات القائمة على الذكاء الاصطناعي التي تتضمن مدخلات مشوهة أو كبيرة الحجم يمكن أن تسبب أخطاء في التحليل، وتسرب الموجهات عبر الحقول، واستنفاد الموارد. كما أن تطبيق القواعد الصارمة للمخططات هو شرط أساسي عند تنفيذ الاستدعاءات الحتمية للأدوات.

|   #   | Description                                                                                                                                                        | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.3.1 | تحقق من أن كل نقطة نهاية لنداء API أو دالة تعرف مخطط إدخال صريح (مخطط JSON، بروتوباف أو ما يعادله متعدد الوسائط) وأنه يتم التحقق من صحة المدخلات قبل تجميع الموجه. |   1   |  D   |
| 2.3.2 | تحقق من أن الإدخالات التي تتجاوز الحد الأقصى لعدد الرموز أو البايتات يتم رفضها برسالة خطأ آمنة ولا يتم اقتطاعها بصمت.                                              |   1   | D/V  |
| 2.3.3 | تحقق من أن فحوصات النوع (مثل نطاقات الأعداد، قيم التعداد، أنواع MIME للصور/الصوت) يتم تطبيقها على جانب الخادم، وليس فقط في كود العميل.                             |   2   | D/V  |
| 2.3.4 | تحقق من أن أدوات التحقق الدلالي (مثل JSON Schema) تعمل في وقت ثابت لمنع هجمات الحرمان من الخدمة الخوارزمية (DoS).                                                  |   2   |  D   |
| 2.3.5 | تحقق من أن إخفاقات التحقق يتم تسجيلها مع مقاطع حمولة مخفَّضة الرموز وأكواد أخطاء واضحة للمساعدة في التصنيف الأمني.                                                 |   3   |  V   |

---

## ج٤.٢ فحص المحتوى والسياسة

يجب أن يكون المطورون قادرين على اكتشاف المطالبات التي تكون صحيحة نحويًا والتي تطلب محتوى غير مسموح به (مثل التعليمات غير القانونية، خطاب الكراهية، والنصوص المحمية بحقوق الطبع والنشر)، ثم منعها من الانتشار.

|   #   | Description                                                                                                                                                              | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.4.1 | تحقق من أن مصنف المحتوى (النموذجي الصفر أو المعدل) يقيم كل إدخال من حيث العنف، وإيذاء النفس، والكراهية، والمحتوى الجنسي، والطلبات غير القانونية، مع إمكانية ضبط العتبات. |   1   |  D   |
| 2.4.2 | تحقق من أن الإدخالات التي تنتهك السياسات ستتلقى رفضات موحدة أو إكمالات آمنة حتى لا تنتقل إلى استدعاءات نموذج اللغة الكبير التالية.                                       |   1   | D/V  |
| 2.4.3 | تحقق من إعادة تدريب/تحديث نموذج الفحص أو مجموعة القواعد على الأقل كل ثلاثة أشهر، مع دمج أنماط الاختراق أو تجاوز السياسات الجديدة التي تم رصدها.                          |   2   |  D   |
| 2.4.4 | تحقق من أن الفحص يحترم السياسات الخاصة بالمستخدم (العمر، القيود القانونية الإقليمية) من خلال قواعد تعتمد على السمات يتم حلها في وقت الطلب.                               |   2   |  D   |
| 2.4.5 | تحقق من أن سجلات الفحص تتضمن درجات ثقة المصنف وعلامات فئة السياسة لتcorrelation SOC وإعادة تشغيل فريق الاختبار الأحمر في المستقبل.                                       |   3   |  V   |

---

## ج2.5 تحديد معدل الإدخال ومنع إساءة الاستخدام

يجب على المطورين منع سوء الاستخدام، واستنزاف الموارد، والهجمات الآلية ضد أنظمة الذكاء الاصطناعي من خلال تحديد معدلات الإدخال واكتشاف أنماط الاستخدام الشاذة.

|   #   | Description                                                                                                   | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.5.1 | تحقق من أن حدود المعدل لكل مستخدم، لكل عنوان IP، ولكل مفتاح API مفروضة على جميع نهايات الإدخال.               |   1   | D/V  |
| 2.5.2 | تحقق من ضبط حدود المعدل المتفجر والمستدام لمنع هجمات الحرمان من الخدمة (DoS) والهجمات بالقوة الغاشمة.         |   2   | D/V  |
| 2.5.3 | تحقق من أن أنماط الاستخدام الشاذة (مثل الطلبات السريعة المتتابعة، تدفق الإدخال) تؤدي إلى حظر تلقائي أو تصعيد. |   2   | D/V  |
| 2.5.4 | تحقق من أن سجلات منع الإساءة محفوظة ويتم مراجعتها لاكتشاف أنماط الهجمات الناشئة.                              |   3   |  V   |

---

## C2.6 التحقق من صحة المدخلات متعددة الوسائط

يجب أن تتضمن أنظمة الذكاء الاصطناعي تحققًا قويًا للمدخلات غير النصية (الصور، الصوت، الملفات) لمنع الحقن، التهرب، أو إساءة استخدام الموارد.

|   #   | Description                                                                                                       | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.6.1 | تحقق من أن جميع المدخلات غير النصية (الصور، الصوتيات، الملفات) قد تم التحقق من نوعها وحجمها وصيغتها قبل المعالجة. |   1   |  D   |
| 2.6.2 | تأكد من فحص الملفات بحثًا عن البرامج الضارة والحملات التخفيّة قبل الاستيعاب.                                      |   2   | D/V  |
| 2.6.3 | تحقق من أن مدخلات الصورة/الصوت قد تم فحصها للكشف عن التعديلات العدائية أو أنماط الهجوم المعروفة.                  |   2   | D/V  |
| 2.6.4 | تحقق من أن فشل التحقق من صحة الإدخال متعدد الوسائط يتم تسجيله ويؤدي إلى تنبيهات للتحقيق.                          |   3   |  V   |

---

## C2.7 مصدر المدخلات والنسبة

يجب أن تدعم أنظمة الذكاء الاصطناعي التدقيق، وتتبع الانتهاكات، والامتثال من خلال مراقبة وتصنيف مصادر جميع مدخلات المستخدم.

|   #   | Description                                                                                                                                           | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.7.1 | تحقق من أن جميع مدخلات المستخدم تم وضع علامة بيانات وصفية لها (معرّف المستخدم، الجلسة، المصدر، الطابع الزمني، عنوان بروتوكول الإنترنت) عند الاستيعاب. |   1   | D/V  |
| 2.7.2 | تحقق من الاحتفاظ ببيانات الأصل (provenance metadata) وقابليتها للمراجعة لجميع المدخلات المعالجة.                                                      |   2   | D/V  |
| 2.7.3 | تحقق من أن مصادر الإدخال الشاذة أو غير الموثوقة يتم تمييزها وتخضع لفحص موسع أو حظر.                                                                   |   2   | D/V  |

---

## C2.8 الكشف التكيفي للتهديدات في الوقت الحقيقي

يجب على المطورين استخدام أنظمة كشف التهديدات المتقدمة للذكاء الاصطناعي التي تتكيف مع أنماط الهجوم الجديدة وتوفر حماية في الوقت الحقيقي باستخدام مطابقة الأنماط المجمعة.

|   #   | Description                                                                                                                                                       | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.8.1 | تحقق من أن أنماط اكتشاف التهديدات يتم تجميعها في محركات تعبيرات نمطية محسّنة لتحقيق أداء عالي في التصفية الحية مع تأثير تأخير منخفض للغاية.                       |   1   | D/V  |
| 2.8.2 | تحقق من أن أنظمة الكشف عن التهديدات تحتفظ بمكتبات نماذج منفصلة للفئات المختلفة من التهديدات (حقن الأوامر، المحتوى الضار، البيانات الحساسة، أوامر النظام).         |   1   | D/V  |
| 2.8.3 | تحقق من أن الكشف التهديدي التكيفي يدمج نماذج التعلم الآلي التي تقوم بتحديث حساسية التهديد بناءً على تكرار الهجوم ومعدلات النجاح.                                  |   2   | D/V  |
| 2.8.4 | تحقق من أن تغذية استخبارات التهديدات في الوقت الحقيقي تقوم بتحديث مكتبات الأنماط تلقائيًا باستخدام تواقيع الهجوم الجديدة ومؤشرات الاختراق (IOCs).                 |   2   | D/V  |
| 2.8.5 | تحقق من أن معدلات الإيجابيات الكاذبة في اكتشاف التهديدات يتم مراقبتها باستمرار وأن تخصيص نمط التهديد يتم ضبطه تلقائيًا لتقليل التداخل مع حالات الاستخدام الشرعية. |   3   | D/V  |
| 2.8.6 | تحقق من أن تحليل التهديد السياقي يأخذ في الاعتبار مصدر الإدخال، وأنماط سلوك المستخدم، وسجل الجلسة لتحسين دقة الكشف.                                               |   3   | D/V  |
| 2.8.7 | تحقق من أن مقاييس أداء اكتشاف التهديدات (معدل الكشف، زمن معالجة البيانات، استخدام الموارد) تتم مراقبتها وتحسينها في الوقت الفعلي.                                 |   3   | D/V  |

---

## C2.9 خط أنابيب التحقق الأمني متعدد الوسائط

يجب على المطورين توفير التحقق من الأمان لنصوص، وصور، وصوتيات، وأنواع الإدخال الأخرى للذكاء الاصطناعي باستخدام أنواع محددة من كشف التهديدات وعزل الموارد.

|   #   | Description                                                                                                                                                                                                                 | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.9.1 | تحقق من أن كل وسيلة إدخال لديها مدققات أمنية مخصصة مع أنماط تهديد موثقة (النص: حقن الموجهات، الصور: تحليل إخفاء المعلومات، الصوت: هجمات الطيف الصوتي) وعوازل الكشف.                                                         |   1   | D/V  |
| 2.9.2 | تحقق من أن المدخلات متعددة الوسائط تتم معالجتها في بيئات معزولة (صناديق رملية) مع حدود موارد محددة (مثل الذاكرة، وحدة المعالجة المركزية، ووقت المعالجة) لكل نوع من أنواع الوسائط، ويتم توثيق ذلك في سياسات الأمان.          |   2   | D/V  |
| 2.9.3 | تحقق من أن الكشف عن الهجمات متعددة الوسائط يحدد الهجمات المنسقة التي تمتد عبر أنواع إدخال متعددة (مثل الأحمال المخفية بالتستيجرافيا في الصور جنبًا إلى جنب مع حقن الموجه في النص) باستخدام قواعد الارتباط وتوليد التنبيهات. |   2   | D/V  |
| 2.9.4 | تحقق من أن فشل التحقق متعدد الوسائط يُحدث تسجيلًا مفصلًا يشمل جميع وسائط الإدخال، ونتائج التحقق، ودرجات التهديد، والتحليل الارتباطي مع تنسيقات تسجيل منظمة لدمجها مع أنظمة إدارة المعلومات الأمنية والأحداث (SIEM).         |   3   | D/V  |
| 2.9.5 | تحقق من تحديث مصنفات المحتوى الخاصة بالأنماط الحسية وفقًا للجداول الموثقة (بحد أدنى ربع سنوي) باستخدام أنماط تهديد جديدة وأمثلة معادية، مع الحفاظ على مؤشرات الأداء فوق الحدود الأساسية.                                    |   3   | D/V  |

---

## المراجع

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)

