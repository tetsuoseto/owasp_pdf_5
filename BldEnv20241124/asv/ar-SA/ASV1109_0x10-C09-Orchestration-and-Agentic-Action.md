# 9 التنسيق المستقل والعمل الوكلي الأمن

## هدف التحكم

ضمان أن تقوم أنظمة الذكاء الاصطناعي المستقلة أو متعددة الوكلاء بتنفيذ الإجراءات التي تكون مقصودة وصريحة فقط، ومصادق عليها، وقابلة للتدقيق، وضمن حدود التكاليف والمخاطر المحددة. هذا يوفر الحماية ضد تهديدات مثل اختراق النظام المستقل، سوء استخدام الأدوات، الكشف عن حلقات الوكيل، اختطاف الاتصالات، تزوير الهوية، التلاعب بالقطعان، والتلاعب بالنوايا.

---

## 9.1 ميزانيات تخطيط مهام الوكيل والتكرار

حدد سرعة تنفيذ الخطط التكرارية وارغم نقاط تحقق بشرية للإجراءات المميزة.

|   #   | Description                                                                                                                                                                           | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.1.1 | تحقق من أن الحد الأقصى لعمق الاستدعاء التكراري، والعرض، ووقت الساعة الحقيقية، وعدد الرموز، والتكلفة المالية لكل تنفيذ للوكيل يتم تكوينها مركزيًا وإدارتها بواسطة التحكم في الإصدارات. |   1   | D/V  |
| 9.1.2 | تحقق من أن الإجراءات المميزة أو التي لا يمكن التراجع عنها (مثل الالتزامات البرمجية، التحويلات المالية) تتطلب موافقة صريحة من الإنسان عبر قناة قابلة للتدقيق قبل التنفيذ.              |   1   | D/V  |
| 9.1.3 | تحقق من أن مراقبات الموارد في الوقت الفعلي تُفعّل مقاطعة قاطع الدائرة عند تجاوز أي حد للميزانية، مما يوقف توسّع المهام بشكل إضافي.                                                    |   2   |  D   |
| 9.1.4 | تحقق من تسجيل أحداث قاطع الدائرة مع معرّف الوكيل، والشرط المُحفّز، وحالة الخطة المُلتقطة للمراجعة الجنائية.                                                                           |   2   | D/V  |
| 9.1.5 | تحقق من أن اختبارات الأمان تغطي سيناريوهات استنفاد الميزانية وخطة الاندفاع، مؤكداً التوقف الآمن دون فقدان البيانات.                                                                   |   3   |  V   |
| 9.1.6 | تأكد من أن سياسات الميزانية معبر عنها كسياسات-كود ويتم تطبيقها في التكامل المستمر/التوصيل المستمر لمنع الانحراف في التكوين.                                                           |   3   |  D   |

---

## 9.2 عزل مكونات الإضافة للأدوات

عزل تفاعلات الأدوات لمنع الوصول غير المصرح به إلى النظام أو تنفيذ الأكواد.

|   #   | Description                                                                                                                                                                                              | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.2.1 | تحقق من أن كل أداة/إضافة تتنفيذ داخل نظام تشغيل، أو حاوية، أو بيئة رملية على مستوى WASM مع سياسات أقل امتيازًا لنظام الملفات، والشبكة، واستدعاءات النظام.                                                |   1   | D/V  |
| 9.2.2 | تحقق من تطبيق قيود موارد البيئة المعزولة (وحدة المعالجة المركزية، الذاكرة، القرص، خرج الشبكة) وفترات انتهاء تنفيذ العمليات، وكذلك تسجيلها.                                                               |   1   | D/V  |
| 9.2.3 | تحقق من أن ملفات التشغيل أو أوصاف الأدوات موقعة رقميًا؛ يتم التحقق من صحة التوقيعات قبل التحميل.                                                                                                         |   2   | D/V  |
| 9.2.4 | تحقق من أن تيارات بيانات القياس عن بُعد (التليمترية) في منطقة الاختبار (السandbox) تُرسل إلى نظام إدارة معلومات وأحداث الأمن (SIEM)؛ بحيث تقوم أي شذوذات (مثل محاولات الاتصال الصادرة) بإثارة التنبيهات. |   2   |  V   |
| 9.2.5 | تأكد من أن الإضافات عالية المخاطر تخضع لمراجعة أمنية واختبارات اختراق قبل النشر في بيئة الإنتاج.                                                                                                         |   3   |  V   |
| 9.2.6 | تحقق من أن محاولات الهروب من الصندوق الرملية تُحظر تلقائيًا وأن الملحق المخالف يُوضع في العزل تلقائيًا في انتظار التحقيق.                                                                                |   3   | D/V  |

---

## 9.3 الحلقة الذاتية وتحديد التكلفة

كشف وإيقاف التكرار غير المسيطر عليه بين الوكلاء والانفجارات في التكلفة.

|   #   | Description                                                                                           | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.3.1 | تحقق من أن المكالمات بين الوكلاء تتضمن حدًا للانتقال أو TTL تقوم بيئة التشغيل بتنزيله وفرضه.          |   1   | D/V  |
| 9.3.2 | تحقق من أن الوكلاء يحتفظون بمعرف فريد لمخطط الاستدعاء لرصد الاستدعاء الذاتي أو الأنماط الدورية.       |   2   |  D   |
| 9.3.3 | تحقق من تتبع عدادات وحدة الحوسبة التراكمية والإنفاق لكل سلسلة طلب؛ يخضع تجاوز الحد لإجهاض السلسلة.    |   2   | D/V  |
| 9.3.4 | تحقق من أن التحليل الرسمي أو فحص النماذج يثبت غياب الاستدعاء الذاتي غير المحدود في بروتوكولات الوكيل. |   3   |  V   |
| 9.3.5 | تحقق من أن أحداث إيقاف الحلقة تولد تنبيهات وتغذي مقاييس التحسين المستمر.                              |   3   |  D   |

---

## 9.4 حماية ضد سوء الاستخدام على مستوى البروتوكول

قنوات اتصال آمنة بين العوامل والأنظمة الخارجية لمنع الاختراق أو التلاعب.

|   #   | Description                                                                                                                                           | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.4.1 | تحقق من أن جميع الرسائل بين الوكيل والأداة وبين الوكيل والوكيل الآخر مُصادق عليها (على سبيل المثال، TLS متبادل أو JWT) ومشفرة من النهاية إلى النهاية. |   1   | D/V  |
| 9.4.2 | تحقق من أن المخططات يتم التحقق منها بدقة؛ يتم رفض الحقول غير المعروفة أو الرسائل ذات التنسيق الخاطئ.                                                  |   1   |  D   |
| 9.4.3 | تحقق من أن فحوصات السلامة (رموز التحقق من الرسائل أو التوقيعات الرقمية) تغطي حمولة الرسالة بالكامل بما في ذلك معلمات الأداة.                          |   2   | D/V  |
| 9.4.4 | تحقق من أن الحماية من إعادة التشغيل (الأعداد العشوائية أو نوافذ الطابع الزمني) مطبقة على طبقة البروتوكول.                                             |   2   |  D   |
| 9.4.5 | تحقق من أن تنفيذات البروتوكول تخضع للاختبار العشوائي (fuzzing) والتحليل الثابت للكشف عن عيوب الحقن أو التسلسل العكسي (deserialization).               |   3   |  V   |

---

## 9.5 هوية الوكيل وإثبات عدم التلاعب

ضمان إمكانية نسب الأفعال واكتشاف التعديلات.

|   #   | Description                                                                                | Level | Role |
| :---: | ------------------------------------------------------------------------------------------ | :---: | :--: |
| 9.5.1 | تحقق من أن كل نسخة من الوكيل تمتلك هوية تشفير فريدة (زوج مفاتيح أو اعتماد مدمج في الجهاز). |   1   | D/V  |
| 9.5.2 | تحقق من أن جميع إجراءات الوكيل موقعة ومؤرخة؛ تشمل السجلات التوقيع لضمان عدم التنصل.        |   2   | D/V  |
| 9.5.3 | تحقق من أن السجلات المقاومة للتلاعب مخزنة في وسط يدعم الإضافة فقط أو الكتابة مرة واحدة.    |   2   |  V   |
| 9.5.4 | تحقق من أن مفاتيح الهوية تدور وفق جدول محدد وعند وجود مؤشرات على الاختراق.                 |   3   |  D   |
| 9.5.5 | تحقق من أن محاولات الانتحال أو تعارض المفاتيح تؤدي إلى الحجر الصحي الفوري للوكيل المتأثر.  |   3   | D/V  |

---

## 9.6 تقليل المخاطر في سرب الوكلاء المتعددين

تخفيف مخاطر السلوك الجماعي من خلال العزل والنمذجة الرسمية للسلامة.

|   #   | Description                                                                                                         | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.6.1 | تحقق من أن الوكلاء العاملين في نطاقات أمنية مختلفة ينفذون ضمن بيئات تشغيل معزولة أو قطاعات شبكية منفصلة.            |   1   | D/V  |
| 9.6.2 | تحقق من أن سلوكيات السرب مُنمذجة ويتم التحقق منها رسميًا من حيث الحيَوية والسلامة قبل النشر.                        |   3   |  V   |
| 9.6.3 | تحقق من أن مراقبي وقت التشغيل يكتشفون الأنماط غير الآمنة الناشئة (مثل التذبذبات، والجمود) ويبدأون بإجراءات تصحيحية. |   3   |  D   |

---

## 9.7 التحقق من هوية المستخدم والأداة / التفويض

قم بتنفيذ ضوابط وصول قوية لكل إجراء يتم تفعيله بواسطة الوكيل.

|   #   | Description                                                                                                                              | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.7.1 | تحقق من أن الوكلاء يقومون بالمصادقة كجهات رئيسية من الدرجة الأولى على الأنظمة التالية، دون إعادة استخدام بيانات اعتماد المستخدم النهائي. |   1   | D/V  |
| 9.7.2 | تحقق من أن سياسات التفويض الدقيقة تقيد الأدوات التي يمكن للوكيل استدعاؤها والمعلمات التي يمكنه تزويدها.                                  |   2   |  D   |
| 9.7.3 | تحقق من إعادة تقييم فحوصات الامتياز في كل استدعاء (الترخيص المستمر)، وليس فقط عند بدء الجلسة.                                            |   2   |  V   |
| 9.7.4 | تحقق من أن الامتيازات المفوضة تنتهي صلاحيتها تلقائيًا وتتطلب إعادة الموافقة بعد انتهاء المهلة أو تغيير النطاق.                           |   3   |  D   |

---

## 9.8 أمان التواصل بين الوكلاء

تشفير وحماية سلامة جميع الرسائل بين الوكلاء لمنع التنصت والتلاعب.

|   #   | Description                                                                                               | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.8.1 | تحقق من أن المصادقة المتبادلة والتشفير ذو السرية الأمامية الكاملة (مثل TLS 1.3) إلزاميان لقنوات الوكيل.   |   1   | D/V  |
| 9.8.2 | تحقق من صحة سلامة الرسالة ومصدرها قبل المعالجة؛ في حالة الفشل يتم إصدار تنبيهات وحذف الرسالة.             |   1   |  D   |
| 9.8.3 | تحقق من تسجيل بيانات تعريف الاتصال (الطوابع الزمنية، أرقام التسلسل) لدعم إعادة البناء التحقيقية.          |   2   | D/V  |
| 9.8.4 | تحقق من أن التحقق الرسمي أو فحص النماذج يؤكدان أن آلات حالات البروتوكول لا يمكن دفعها إلى حالات غير آمنة. |   3   |  V   |

---

## 9.9 التحقق من النوايا وفرض القيود

تحقق من أن إجراءات الوكيل تتماشى مع نية المستخدم المعلنة وقيود النظام.

|   #   | Description                                                                                                                                      | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 9.9.1 | تأكد من أن محركات حل القيود قبل التنفيذ تتحقق من الإجراءات المقترحة مقابل قواعد السلامة والسياسة المبرمجة مسبقًا.                                |   1   |  D   |
| 9.9.2 | تحقق من أن الإجراءات ذات التأثير العالي (المالية، التدميرية، الحساسة للخصوصية) تتطلب تأكيد نية صريح من المستخدم الذي يبدأ الإجراء.               |   2   | D/V  |
| 9.9.3 | تحقق من أن فحوصات ما بعد الشرط تتحقق من أن الإجراءات المكتملة حققت التأثيرات المقصودة دون تأثيرات جانبية؛ أي اختلافات تؤدي إلى التراجع.          |   2   |  V   |
| 9.9.4 | تحقق من أن الطرق الرسمية (مثل التحقق من النماذج، إثبات النظريات) أو الاختبارات المعتمدة على الخصائص تثبت أن خطط الوكيل تلبي جميع القيود المعلنة. |   3   |  V   |
| 9.9.5 | تحقق من أن حوادث عدم تطابق النية أو انتهاك القيود تغذي دورات التحسين المستمر ومشاركة معلومات التهديدات.                                          |   3   |  D   |

---

## 9.10 استراتيجية أمان الاستدلال للوكيل

الاختيار الآمن وتنفيذ استراتيجيات الاستدلال المختلفة بما في ذلك طرق ReAct وChain-of-Thought وTree-of-Thoughts.

|   #    | Description                                                                                                                                                                                    | Level | Role |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.10.1 | تحقق من أن اختيار استراتيجية التفكير يستخدم معايير حتمية (تعقيد الإدخال، نوع المهمة، سياق الأمان) وأن المدخلات المتطابقة تُنتج اختيار استراتيجيات متطابقة داخل نفس سياق الأمان.                |   1   | D/V  |
| 9.10.2 | تحقق من أن كل استراتيجية استدلال (ReAct، سلسلة الأفكار، شجرة الأفكار) تحتوي على تحقق مخصص من صحة الإدخال، وتنقية المخرجات، وحدود زمنية للتنفيذ تتناسب مع نهجها المعرفي الخاص.                  |   1   | D/V  |
| 9.10.3 | تحقق من تسجيل انتقالات استراتيجية الاستدلال مع السياق الكامل بما في ذلك خصائص الإدخال وقيم معايير الاختيار وبيانات تنفيذ العمليات لإعادة بناء سجل التدقيق.                                     |   2   | D/V  |
| 9.10.4 | تحقق من أن استدلال شجرة الأفكار يتضمن آليات تقليم الفروع التي تنهي الاستكشاف عند اكتشاف انتهاكات السياسة، أو حدود الموارد، أو حدود السلامة.                                                    |   2   | D/V  |
| 9.10.5 | تحقق من أن دورات ReAct (التفكير-الفعل-الملاحظة) تشمل نقاط تحقق في كل مرحلة: التحقق من خطوة التفكير، تفويض الفعل، وتنقية الملاحظة قبل المتابعة.                                                 |   2   | D/V  |
| 9.10.6 | تحقق من مراقبة مقاييس أداء استراتيجية الاستدلال (وقت التنفيذ، استخدام الموارد، جودة المخرجات) مع وجود تنبيهات تلقائية عند انحراف المقاييس عن الحدود المعينة.                                   |   3   | D/V  |
| 9.10.7 | تحقق من أن أساليب الاستدلال الهجينة التي تجمع بين استراتيجيات متعددة تحافظ على التحقق من صحة المدخلات وقيود المخرجات لجميع الاستراتيجيات المكونة دون تجاوز أي ضوابط أمان.                      |   3   | D/V  |
| 9.10.8 | تحقق من أن اختبار أمان استراتيجية التفكير يشمل الفحص العشوائي (fuzzing) باستخدام مدخلات مشوهة، والطلبات العدائية المصممة لإجبار التبديل بين الاستراتيجيات، واختبار ظروف الحدود لكل نهج إدراكي. |   3   | D/V  |

---

## 9.11 إدارة حالة دورة حياة الوكيل والأمن

تهيئة الوكيل الآمن، انتقالات الحالة، وإنهاء العمليات مع مسارات تدقيق تشفيرية وإجراءات استرداد محددة.

|   #    | Description                                                                                                                                                                                                         | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.11.1 | تحقق من أن تهيئة الوكيل تتضمن إنشاء هوية تشفيرية باستخدام بيانات اعتماد مدعومة بالأجهزة وسجلات تدقيق بدء تشغيل غير قابلة للتغيير تحتوي على معرف الوكيل، والطابع الزمني، وهاش التكوين، ومعلمات التهيئة.              |   1   | D/V  |
| 9.11.2 | تحقق من أن انتقالات حالة الوكيل موقعة تشفيرياً، ومؤرخة زمنياً، ومسجلة مع سياق كامل يشمل الأحداث المسببة، تجزئة الحالة السابقة، تجزئة الحالة الجديدة، والتحققات الأمنية التي تم تنفيذها.                             |   2   | D/V  |
| 9.11.3 | تحقق من أن إجراءات إيقاف الوكيل تشمل مسح الذاكرة بأمان باستخدام محو تشفيري أو الكتابة متعددة المراحل، وإلغاء صلاحيات الاعتماد مع إشعار سلطة الشهادات، وإنشاء شهادات إنهاء مقاومة للعبث.                             |   2   | D/V  |
| 9.11.4 | تحقق من أن آليات استرداد الوكيل تقوم بالتحقق من سلامة الحالة باستخدام مجموعات التحقق التشفيرية (حد أدنى SHA-256) والعودة إلى حالات معروفة وصحيحة عند اكتشاف تلف، مع وجود تنبيهات تلقائية ومتطلبات للموافقة اليدوية. |   3   | D/V  |
| 9.11.5 | تحقق من أن آليات استمرارية الوكلاء تقوم بتشفير بيانات الحالة الحساسة باستخدام مفاتيح AES-256 خاصة بكل وكيل وتنفيذ تدوير آمن للمفاتيح وفق جداول قابلة للتكوين (بحد أقصى 90 يومًا) مع نشر بدون توقف.                  |   3   | D/V  |

---

## 9.12 إطار عمل أمان تكامل الأدوات

ضوابط الأمان لتحميل الأدوات الديناميكية وتنفيذها والتحقق من صحة النتائج مع عمليات تقييم المخاطر والموافقة المحددة.

|   #    | Description                                                                                                                                                                                                                               | Level | Role |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.12.1 | تحقق من أن مواصفات الأدوات تتضمن بيانات أمان تحدد الامتيازات المطلوبة (قراءة/كتابة/تنفيذ)، ومستويات المخاطر (منخفضة/متوسطة/عالية)، وحدود الموارد (وحدة المعالجة المركزية، الذاكرة، الشبكة)، ومتطلبات التحقق الموثقة في ملفات وصف الأدوات. |   1   | D/V  |
| 9.12.2 | تحقق من أن نتائج تنفيذ الأدوات يتم التحقق من صحتها مقابل المخططات المتوقعة (مخطط JSON، مخطط XML) وسياسات الأمان (تطهير المخرجات، تصنيف البيانات) قبل التكامل مع تحديد حدود المهلة وإجراءات التعامل مع الأخطاء.                            |   1   | D/V  |
| 9.12.3 | تحقق من أن سجلات التفاعل مع الأدوات تتضمن سياق أمني مفصل يشمل استخدام الامتيازات، وأنماط الوصول إلى البيانات، ووقت التنفيذ، واستهلاك الموارد، وأكواد الإرجاع مع تسجيل منظم لدمج SIEM.                                                     |   2   | D/V  |
| 9.12.4 | تحقق من أن آليات تحميل الأدوات الديناميكية تقوم بالتحقق من صحة التوقيعات الرقمية باستخدام بنية المفتاح العام (PKI) وتنفذ بروتوكولات تحميل آمنة مع عزل في الصندوق الرملي (sandbox) والتحقق من الأذونات قبل التنفيذ.                        |   2   | D/V  |
| 9.12.5 | تحقق من أن تقييمات أمان الأدوات تُفعّل تلقائيًا للإصدارات الجديدة مع وجود بوابات موافقة إلزامية تشمل التحليل الثابت، والاختبار الديناميكي، ومراجعة فريق الأمان مع وجود معايير موافقة موثقة ومتطلبات اتفاقية مستوى الخدمة (SLA).           |   3   | D/V  |

---

### المراجع

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)

