# Επικύρωση Εισόδου Χρήστη C2

## Στόχος Ελέγχου

Η αξιόπιστη επαλήθευση της εισόδου του χρήστη αποτελεί την πρώτη γραμμή άμυνας κατά ορισμένων από τις πιο επιβλαβείς επιθέσεις σε συστήματα ΤΝ. Οι επιθέσεις παρεμβολής εντολών μπορούν να αντικαταστήσουν τις οδηγίες του συστήματος, να διαρρεύσουν ευαίσθητα δεδομένα ή να κατευθύνουν το μοντέλο σε συμπεριφορά που δεν επιτρέπεται. Εκτός εάν υπάρχουν αφιερωμένα φίλτρα και ιεραρχίες οδηγιών, η έρευνα δείχνει ότι τα "multi-shot" jailbreaks που εκμεταλλεύονται πολύ μεγάλα παράθυρα συμφραζομένων θα είναι αποτελεσματικά. Επίσης, οι λεπτές επιθέσεις με αντιπαρασιτικές διαταραχές — όπως οι ανταλλαγές ομογλύφων ή η γλώσσα leetspeak — μπορούν αθόρυβα να αλλάξουν τις αποφάσεις ενός μοντέλου.

---

## C2.1 Άμυνα κατά της Εισαγωγής Εντολών (Prompt Injection)

Η εισαγωγή κακόβουλων εντολών (prompt injection) είναι ένας από τους κορυφαίους κινδύνους για τα συστήματα τεχνητής νοημοσύνης. Οι άμυνες απέναντι σε αυτή την τακτική χρησιμοποιούν έναν συνδυασμό στατικών φίλτρων προτύπων, δυναμικών ταξινομητών και επιβολής ιεραρχίας οδηγιών.

|   #   | Description                                                                                                                                                                                                                                           | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.1.1 | Επαληθεύστε ότι οι είσοδοι χρηστών ελέγχονται με βάση μια συνεχώς ενημερωμένη βιβλιοθήκη γνωστών προτύπων ένεσης εντολών (λέξεις-κλειδιά για παράκαμψη, "αγνόηση προηγούμενου", αλυσίδες ρόλων, έμμεσες επιθέσεις HTML/URL).                          |   1   | D/V  |
| 2.1.2 | Επαληθεύστε ότι το σύστημα εφαρμόζει μια ιεραρχία οδηγιών στην οποία τα μηνύματα του συστήματος ή του προγραμματιστή υπερισχύουν των οδηγιών χρήστη, ακόμα και μετά την επέκταση του παραθύρου συμφραζομένων.                                         |   1   | D/V  |
| 2.1.3 | Επιβεβαιώστε ότι τα τεστ αξιολόγησης αντιπάλων (π.χ., οι "many-shot" εντολές της Κόκκινης Ομάδας) εκτελούνται πριν από κάθε κυκλοφορία μοντέλου ή προτύπου εντολών, με κατώτατα όρια ποσοστού επιτυχίας και αυτόματους αποκλεισμούς για υποβαθμίσεις. |   2   | D/V  |
| 2.1.4 | Επιβεβαιώστε ότι τα προτροπές που προέρχονται από περιεχόμενο τρίτων (ιστοσελίδες, αρχεία PDF, email) καθαρίζονται σε απομονωμένο περιβάλλον ανάλυσης πριν συγχωνευθούν στην κύρια προτροπή.                                                          |   2   |  D   |
| 2.1.5 | Επαληθεύστε ότι όλες οι ενημερώσεις κανόνων φιλτραρίσματος προτροπών, οι εκδόσεις μοντέλων ταξινομητών και οι αλλαγές στη λίστα αποκλεισμού είναι ελεγχόμενες μέσω εκδόσεων και ελέγξιμες.                                                            |   3   | D/V  |

---

## C2.2 Αντίσταση σε Παραδείγματα Αντιπάλου

Τα μοντέλα Επεξεργασίας Φυσικής Γλώσσας (NLP) εξακολουθούν να είναι ευάλωτα σε διακριτικές μετατροπές σε επίπεδο χαρακτήρα ή λέξης, τις οποίες οι άνθρωποι συχνά δεν παρατηρούν, αλλά τα μοντέλα τείνουν να ταξινομούν λανθασμένα.

|   #   | Description                                                                                                                                                                                                              | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.2.1 | Επαληθεύστε ότι τα βασικά βήματα κανονικοποίησης εισόδου (Unicode NFC, αντιστοίχιση ομογράφων, αποκοπή κενών) εκτελούνται πριν από την τοκενικοποίηση.                                                                   |   1   |  D   |
| 2.2.2 | Επαληθεύστε ότι η στατιστική ανίχνευση ανωμαλιών εντοπίζει εισροές με ασυνήθιστα υψηλή απόσταση επεξεργασίας από τα γλωσσικά πρότυπα, υπερβολικά επαναλαμβανόμενους χαρακτήρες ή μη φυσιολογικές αποστάσεις ενσωμάτωσης. |   2   | D/V  |
| 2.2.3 | Επαληθεύστε ότι η διαδικασία συμπεράσματος υποστηρίζει προαιρετικές παραλλαγές μοντέλων σκληροποιημένα με εκπαίδευση αντιπαραθέσεων ή επίπεδα άμυνας (π.χ., τυχαιοποίηση, αμυντική απόσταξη) για σημεία υψηλού κινδύνου. |   2   |  D   |
| 2.2.4 | Επαληθεύστε ότι οι ύποπτες επιθετικές εισόδοι τίθενται σε καραντίνα και καταγράφονται με πλήρη ωφέλιμο φορτίο (μετά την αφαίρεση προσωπικών δεδομένων - PII).                                                            |   2   |  V   |
| 2.2.5 | Επιβεβαιώστε ότι οι μετρικές ανθεκτικότητας (ποσοστό επιτυχίας γνωστών σετ επιθέσεων) παρακολουθούνται με την πάροδο του χρόνου και οι υποβαθμίσεις ενεργοποιούν αποκλεισμό έκδοσης.                                     |   3   | D/V  |

---

## C2.3 Έλεγχος Σχήματος, Τύπου και Μήκους

Επιθέσεις τεχνητής νοημοσύνης με κακώς μορφοποιημένα ή υπερμεγέθη δεδομένα εισόδου μπορούν να προκαλέσουν σφάλματα ανάλυσης, διαρροή εντολών μεταξύ πεδίων και εξάντληση πόρων. Η αυστηρή επιβολή του σχήματος αποτελεί επίσης προαπαιτούμενο όταν εκτελούνται ντετερμινιστικές κλήσεις εργαλείων.

|   #   | Description                                                                                                                                                                                                       | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.3.1 | Επαληθεύστε ότι κάθε endpoint κλήσης API ή λειτουργίας ορίζει ένα ρητό σχήμα εισόδου (JSON Schema, Protobuf ή ισοδύναμο πολυτροπικής μορφής) και ότι οι είσοδοι επικυρώνονται πριν από τη σύνθεση του prompt.     |   1   |  D   |
| 2.3.2 | Επαληθεύστε ότι οι είσοδοι που υπερβαίνουν τα μέγιστα όρια σε tokens ή bytes απορρίπτονται με ασφαλές σφάλμα και ποτέ δεν περικόπτονται σιωπηρά.                                                                  |   1   | D/V  |
| 2.3.3 | Επαληθεύστε ότι οι έλεγχοι τύπων (π.χ., αριθμητικά εύρη, τιμές enum, τύποι MIME για εικόνες/ήχο) εφαρμόζονται στην πλευρά του διακομιστή και όχι μόνο στον κώδικα του πελάτη.                                     |   2   | D/V  |
| 2.3.4 | Επαληθεύστε ότι οι σημασιολογικοί έλεγχοι εγκυρότητας (π.χ., JSON Schema) εκτελούνται σε σταθερό χρόνο για να αποτρέψουν επιθέσεις άρνησης υπηρεσίας (DoS) που βασίζονται σε αλγορίθμους.                         |   2   |  D   |
| 2.3.5 | Επαληθεύστε ότι οι αποτυχίες επικύρωσης καταγράφονται με αποσπάσματα φόρτου εργασίας όπου έχουν απορρυθμιστεί ευαίσθητα δεδομένα και με σαφείς κωδικούς σφαλμάτων για να διευκολύνεται η ιεράρχηση της ασφάλειας. |   3   |  V   |

---

## C2.4 Έλεγχος Περιεχομένου & Πολιτικής

Οι προγραμματιστές θα πρέπει να είναι σε θέση να ανιχνεύουν συντακτικά έγκυρα αιτήματα που ζητούν απαγορευμένο περιεχόμενο (όπως παράνομες οδηγίες, λόγο μίσους και κείμενο με πνευματικά δικαιώματα) και στη συνέχεια να τα εμποδίζουν από το να διαδοθούν.

|   #   | Description                                                                                                                                                                                                                         | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.4.1 | Επαληθεύστε ότι ένας ταξινομητής περιεχομένου (χωρίς εκπαίδευση ή με λεπτής ρύθμισης) αξιολογεί κάθε είσοδο για βία, αυτοτραυματισμό, μίσος, σεξουαλικό περιεχόμενο και παράνομες αιτήσεις, με ρυθμιζόμενα όρια.                    |   1   |  D   |
| 2.4.2 | Επαληθεύστε ότι οι εισόδοι που παραβιάζουν τις πολιτικές θα λαμβάνουν τυποποιημένες απορρίψεις ή ασφαλείς ολοκληρώσεις, ώστε να μην προωθούνται σε επόμενες κλήσεις μεγάλων μοντέλων γλώσσας (LLM).                                 |   1   | D/V  |
| 2.4.3 | Επαληθεύστε ότι το μοντέλο φιλτραρίσματος ή το σύνολο κανόνων επανεκπαιδεύεται/ενημερώνεται τουλάχιστον σε τριμηνιαία βάση, ενσωματώνοντας νέες παρατηρούμενες τεχνικές παραβίασης ασφαλείας (jailbreak) ή παρακάμπτησης πολιτικής. |   2   |  D   |
| 2.4.4 | Επαληθεύστε ότι η διαδικασία ελέγχου συμμορφώνεται με τις πολιτικές που αφορούν τον χρήστη (ηλικία, νομικούς περιορισμούς περιοχής) μέσω κανόνων βασισμένων σε χαρακτηριστικά που επιλύονται κατά το χρόνο του αιτήματος.           |   2   |  D   |
| 2.4.5 | Επαληθεύστε ότι τα αρχεία καταγραφής ελέγχου περιλαμβάνουν βαθμολογίες εμπιστοσύνης ταξινομητή και ετικέτες κατηγορίας πολιτικής για συσχέτιση SOC και μελλοντική αναπαραγωγή από την ομάδα κόκκινου (red-team).                    |   3   |  V   |

---

## C2.5 Περιορισμός Ρυθμού Εισόδου & Πρόληψη Κακόβουλης Χρήσης

Οι προγραμματιστές θα πρέπει να αποτρέπουν την κατάχρηση, την εξάντληση πόρων και τις αυτοματοποιημένες επιθέσεις κατά των συστημάτων ΤΝ περιορίζοντας τους ρυθμούς εισόδου και ανιχνεύοντας ανώμαλα πρότυπα χρήσης.

|   #   | Description                                                                                                                                            | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.5.1 | Επαληθεύστε ότι οι περιορισμοί ρυθμού ανά χρήστη, ανά διεύθυνση IP και ανά κλειδί API εφαρμόζονται για όλα τα σημεία εισόδου.                          |   1   | D/V  |
| 2.5.2 | Επαληθεύστε ότι τα όρια ρυθμού εκρήξεων και διαρκούς ροής είναι ρυθμισμένα ώστε να αποτρέπουν επιθέσεις DoS και brute force.                           |   2   | D/V  |
| 2.5.3 | Επαληθεύστε ότι τα ανώμαλα πρότυπα χρήσης (π.χ., αιτήματα σε γρήγορη διαδοχή, υπερφόρτωση εισόδου) ενεργοποιούν αυτόματους αποκλεισμούς ή κλιμακώσεις. |   2   | D/V  |
| 2.5.4 | Επιβεβαιώστε ότι τα αρχεία καταγραφής πρόληψης κακοποίησης διατηρούνται και εξετάζονται για αναδυόμενα πρότυπα επιθέσεων.                              |   3   |  V   |

---

## C2.6 Πολυτροπικός Έλεγχος Εισόδου

Τα συστήματα ΤΝ πρέπει να περιλαμβάνουν ανθεκτική επικύρωση για μη κειμενικές εισόδους (εικόνες, ήχο, αρχεία) για να αποτρέπεται η έγχυση, η αποφυγή ή η κατάχρηση πόρων.

|   #   | Description                                                                                                                        | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.6.1 | Επαληθεύστε ότι όλα τα μη κείμενα εισόδου (εικόνες, ήχος, αρχεία) ελέγχονται για τύπο, μέγεθος και μορφή πριν από την επεξεργασία. |   1   |  D   |
| 2.6.2 | Επαληθεύστε ότι τα αρχεία σαρώνονται για κακόβουλο λογισμικό και στεγανογραφικά αρχεία πριν από την εισαγωγή τους.                 |   2   | D/V  |
| 2.6.3 | Επιβεβαιώστε ότι τα εισερχόμενα δεδομένα εικόνας/ήχου ελέγχονται για επιθετικές παρεμβολές ή γνωστά πρότυπα επιθέσεων.             |   2   | D/V  |
| 2.6.4 | Επιβεβαιώστε ότι οι αποτυχίες επικύρωσης εισόδου πολλαπλών μορφών καταγράφονται και ενεργοποιούν ειδοποιήσεις για διερεύνηση.      |   3   |  V   |

---

## C2.7 Προέλευση και Απόδοση Εισόδου

Τα συστήματα ΤΝ θα πρέπει να υποστηρίζουν τον έλεγχο, την παρακολούθηση κακόβουλης χρήσης και τη συμμόρφωση μέσω της παρακολούθησης και της ετικετοποίησης των προελεύσεων όλων των εισροών των χρηστών.

|   #   | Description                                                                                                                                                 | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.7.1 | Επαληθεύστε ότι όλες οι εισροές χρηστών επισημαίνονται με μεταδεδομένα (ταυτότητα χρήστη, συνεδρία, πηγή, χρονική σήμανση, διεύθυνση IP) κατά την εισαγωγή. |   1   | D/V  |
| 2.7.2 | Επιβεβαιώστε ότι τα μεταδεδομένα προέλευσης διατηρούνται και είναι ελέγξιμα για όλες τις επεξεργασμένες εισόδους.                                           |   2   | D/V  |
| 2.7.3 | Επιβεβαιώστε ότι οι ανώμαλες ή μη αξιόπιστες πηγές εισόδου επισημαίνονται και υπόκεινται σε αυξημένη επανεξέταση ή αποκλεισμό.                              |   2   | D/V  |

---

## C2.8 Ανίχνευση Απειλών σε Πραγματικό Χρόνο με Προσαρμογή

Οι προγραμματιστές θα πρέπει να χρησιμοποιούν προηγμένα συστήματα ανίχνευσης απειλών για τεχνητή νοημοσύνη που προσαρμόζονται σε νέα μοτίβα επιθέσεων και παρέχουν προστασία σε πραγματικό χρόνο με τη χρήση συναρμολόγησης μοτίβων.

|   #   | Description                                                                                                                                                                                                              | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.8.1 | Επαληθεύστε ότι τα πρότυπα ανίχνευσης απειλών μεταγλωττίζονται σε βελτιστοποιημένες μηχανές regex για υψηλή απόδοση φιλτραρίσματος σε πραγματικό χρόνο με ελάχιστο αντίκτυπο καθυστέρησης.                               |   1   | D/V  |
| 2.8.2 | Επαληθεύστε ότι τα συστήματα ανίχνευσης απειλών διατηρούν ξεχωριστές βιβλιοθήκες προτύπων για διαφορετικές κατηγορίες απειλών (έγχυση εντολών προτροπής, επιβλαβές περιεχόμενο, ευαίσθητα δεδομένα, εντολές συστήματος). |   1   | D/V  |
| 2.8.3 | Επαληθεύστε ότι η προσαρμοστική ανίχνευση απειλών ενσωματώνει μοντέλα μηχανικής μάθησης που ενημερώνουν την ευαισθησία απειλών βάσει της συχνότητας και των ποσοστών επιτυχίας των επιθέσεων.                            |   2   | D/V  |
| 2.8.4 | Επαληθεύστε ότι τα ροές πληροφοριών απειλών σε πραγματικό χρόνο ενημερώνουν αυτόματα τις βιβλιοθήκες προτύπων με νέες υπογραφές επιθέσεων και δεικτών συμβιβασμού (Indicators of Compromise - IOCs).                     |   2   | D/V  |
| 2.8.5 | Επαληθεύστε ότι τα ποσοστά ψευδώς θετικών ανιχνεύσεων απειλών παρακολουθούνται συνεχώς και η ειδικότητα των προτύπων ρυθμίζεται αυτόματα για να ελαχιστοποιηθεί η παρεμβολή σε νόμιμες περιπτώσεις χρήσης.               |   3   | D/V  |
| 2.8.6 | Επαληθεύστε ότι η ανάλυση απειλών στο πλαίσιο λαμβάνει υπόψη την πηγή εισόδου, τα πρότυπα συμπεριφοράς χρήστη και το ιστορικό συνεδρίας για να βελτιώσει την ακρίβεια εντοπισμού.                                        |   3   | D/V  |
| 2.8.7 | Επιβεβαιώστε ότι οι μετρήσεις απόδοσης ανίχνευσης απειλών (ρυθμός ανίχνευσης, καθυστέρηση επεξεργασίας, χρήση πόρων) παρακολουθούνται και βελτιστοποιούνται σε πραγματικό χρόνο.                                         |   3   | D/V  |

---

## C2.9 Αγωγός Επαλήθευσης Ασφάλειας Πολυτροπικού Τύπου

Οι προγραμματιστές θα πρέπει να παρέχουν επικύρωση ασφαλείας για το κείμενο, την εικόνα, τον ήχο και άλλες μορφές εισόδου τεχνητής νοημοσύνης με συγκεκριμένους τύπους ανίχνευσης απειλών και απομόνωσης πόρων.

|   #   | Description                                                                                                                                                                                                                                                                        | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.9.1 | Επαληθεύστε ότι κάθε είσοδος δεδομένων έχει αφοσιωμένους επαληθευτές ασφαλείας με τεκμηριωμένα μοτίβα απειλών (κείμενο: ενέσιμα αιτήματα, εικόνες: στεγανογραφία, ήχος: επιθέσεις σε φάσματα συχνοτήτων) και κατώφλια ανίχνευσης.                                                  |   1   | D/V  |
| 2.9.2 | Επιβεβαιώστε ότι οι πολυτροπικές εισόδοι επεξεργάζονται σε απομονωμένα sandbox με καθορισμένα όρια πόρων (μνήμη, CPU, χρόνος επεξεργασίας) συγκεκριμένα για κάθε τύπο μορφής και είναι τεκμηριωμένα στις πολιτικές ασφάλειας.                                                      |   2   | D/V  |
| 2.9.3 | Επαληθεύστε ότι ο εντοπισμός επιθέσεων δια-μονάδων αναγνωρίζει συντονισμένες επιθέσεις που εκτείνονται σε πολλούς τύπους εισόδου (π.χ., στεγανογραφικά δεδομένα σε εικόνες σε συνδυασμό με εισαγωγή αιτήματος σε κείμενο) με κανόνες συσχέτισης και δημιουργία ειδοποιήσεων.       |   2   | D/V  |
| 2.9.4 | Επαληθεύστε ότι οι αποτυχίες πολυτροπικής επαλήθευσης ενεργοποιούν λεπτομερή καταγραφή, συμπεριλαμβανομένων όλων των μορφών εισόδου, των αποτελεσμάτων επαλήθευσης, των βαθμολογιών απειλής και της ανάλυσης συσχέτισης με δομημένα φορμάτ καταγραφής για ενσωμάτωση SIEM.         |   3   | D/V  |
| 2.9.5 | Επαληθεύστε ότι οι ταξινομητές περιεχομένου ειδικοί για κάθε μορφή ενημερώνονται σύμφωνα με τα τεκμηριωμένα χρονοδιαγράμματα (τουλάχιστον σε τριμηνιαία βάση) με νέα πρότυπα απειλών, παραδείγματα επιθετών και ότι τα benchmarks απόδοσης διατηρούνται πάνω από τα ελάχιστα όρια. |   3   | D/V  |

---

## Αναφορές

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)

