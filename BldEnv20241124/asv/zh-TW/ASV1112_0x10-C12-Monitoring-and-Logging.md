# C12 監控、日誌記錄與異常檢測

## 控制目標

本節提供關於即時及法證可見性的需求，用以呈現模型及其他人工智慧元件所觀察、執行及回傳的內容，以便於威脅的偵測、分級及學習。

## C12.1 請求與回應日誌記錄

|   #    | Description                                                     | Level | Role |
| :----: | --------------------------------------------------------------- | :---: | :--: |
| 12.1.1 | 確認所有使用者提示和模型回應均已附帶適當的元資料（例如時間戳記、使用者識別碼、會話識別碼、模型版本）進行記錄。         |   1   | D/V  |
| 12.1.2 | 確認日誌存儲在安全且具有存取控制的儲存庫中，並且具有適當的保留政策和備份程序。                         |   1   | D/V  |
| 12.1.3 | 確認日誌存儲系統實施靜態加密和傳輸加密，以保護日誌中包含的敏感信息。                              |   1   | D/V  |
| 12.1.4 | 確認在記錄之前，提示和輸出中的敏感資料會自動被遮蔽或隱藏，並且針對個人識別信息（PII）、憑證和專有信息，有可配置的遮蔽規則。 |   1   | D/V  |
| 12.1.5 | 確認政策決策和安全過濾行動被詳細記錄，以便對內容審核系統進行審計和調試。                            |   2   | D/V  |
| 12.1.6 | 驗證日誌完整性是否透過例如密碼學簽章或只能寫入的儲存方式得到保護。                               |   2   | D/V  |

---

## C12.2 濫用偵測與警報

|   #    | Description                                     | Level | Role |
| :----: | ----------------------------------------------- | :---: | :--: |
| 12.2.1 | 驗證系統是否能使用基於簽名的檢測來識別並警報已知的越獄模式、提示注入嘗試及對抗性輸入。     |   1   | D/V  |
| 12.2.2 | 確認系統使用標準日誌格式和協定與現有的安全信息和事件管理（SIEM）平台整合。         |   1   | D/V  |
| 12.2.3 | 驗證增強的安全事件是否包含特定於人工智慧的上下文，例如模型識別碼、信心分數和安全過濾決策。   |   2   | D/V  |
| 12.2.4 | 驗證行為異常檢測是否能識別不尋常的對話模式、過度重試嘗試或系統性探測行為。           |   2   | D/V  |
| 12.2.5 | 驗證即時警報機制在檢測到潛在的政策違規或攻擊嘗試時，能通知安全團隊。              |   2   | D/V  |
| 12.2.6 | 確認包含自訂規則以偵測特定於人工智慧的威脅模式，包括協同越獄嘗試、提示注入活動及模型提取攻擊。 |   2   | D/V  |
| 12.2.7 | 驗證自動化事件回應工作流程能夠隔離受損模型、阻止惡意用戶，並升級關鍵安全事件。         |   3   | D/V  |

---

## C12.3 模型漂移檢測

|   #    | Description                                | Level | Role |
| :----: | ------------------------------------------ | :---: | :--: |
| 12.3.1 | 驗證系統是否能追蹤各模型版本及時期的基本效能指標，如準確率、置信分數、延遲和錯誤率。 |   1   | D/V  |
| 12.3.2 | 驗證當效能指標超過預先定義的退化閾值或與基準值有顯著偏差時，自動警報是否會觸發。   |   2   | D/V  |
| 12.3.3 | 確認幻覺檢測監控能夠識別並標記模型輸出中包含事實錯誤、不一致或捏造資訊的情況。    |   2   | D/V  |

---

## C12.4 性能與行為遙測

|   #    | Description                                    | Level | Role |
| :----: | ---------------------------------------------- | :---: | :--: |
| 12.4.1 | 確認持續收集並監控包括請求延遲、令牌消耗、記憶體使用量及吞吐量在內的操作指標。        |   1   | D/V  |
| 12.4.2 | 確認成功率和失敗率是否有被追蹤，並且對錯誤類型及其根本原因進行分類。             |   1   | D/V  |
| 12.4.3 | 確認資源使用監控包含 GPU/CPU 使用率、記憶體消耗及儲存需求，並在超出閾值時發出警報。 |   2   | D/V  |

---

## C12.5 人工智慧事件響應計劃與執行

|   #    | Description                                    | Level | Role |
| :----: | ---------------------------------------------- | :---: | :--: |
| 12.5.1 | 確認事故應變計劃特別針對與AI相關的安全事件，包括模型遭破壞、數據中毒和對抗性攻擊。     |   1   | D/V  |
| 12.5.2 | 確認事件響應團隊具備存取特定於人工智慧的取證工具和專業知識，以調查模型行為和攻擊向量。    |   2   | D/V  |
| 12.5.3 | 驗證事後事件分析是否包括模型再訓練的考量、安全過濾器的更新，以及將經驗教訓整合到安全控制中。 |   3   | D/V  |

---

## C12.5 AI 性能退化檢測

監控並檢測人工智慧模型效能及品質隨時間的退化情況。

|   #    | Description                             | Level | Role |
| :----: | --------------------------------------- | :---: | :--: |
| 12.5.1 | 驗證模型的準確率、精確率、召回率及F1分數是否持續被監測並與基線閾值進行比較。 |   1   | D/V  |
| 12.5.2 | 驗證資料漂移檢測是否監控可能影響模型效能的輸入分布變化。            |   1   | D/V  |
| 12.5.3 | 驗證概念漂移檢測是否能識別輸入與期望輸出之間關係的變化。            |   2   | D/V  |
| 12.5.4 | 驗證性能下降是否會觸發自動警報並啟動模型再訓練或替換工作流程。         |   2   | D/V  |
| 12.5.5 | 驗證退化根本原因分析是否將性能下降與數據變化、基礎設施問題或外部因素相關聯。  |   3   |  V   |

---

## C12.6 有向無環圖（DAG）視覺化與工作流程安全

保護工作流程可視化系統免受資訊洩漏和操縱攻擊。

|   #    | Description                                | Level | Role |
| :----: | ------------------------------------------ | :---: | :--: |
| 12.6.1 | 確認有向無環圖（DAG）視覺化數據在存儲或傳輸前已進行清理，以移除敏感信息。     |   1   | D/V  |
| 12.6.2 | 驗證工作流程視覺化的存取控制，確保僅授權用戶能查看代理決策路徑及推理追蹤。      |   1   | D/V  |
| 12.6.3 | 確認DAG數據完整性通過加密簽名和可檢測篡改的存儲機制得到保護。           |   2   | D/V  |
| 12.6.4 | 確認工作流程視覺化系統實施輸入驗證，以防止通過精心製作的節點或邊數據進行的注入攻擊。 |   2   | D/V  |
| 12.6.5 | 驗證實時DAG更新是否受到速率限制並經過驗證，以防止對可視化系統的拒絕服務攻擊。   |   3   | D/V  |

---

## C12.7 主動式安全行為監控

透過主動代理行為分析進行安全威脅的偵測與防範。

|   #    | Description                              | Level | Role |
| :----: | ---------------------------------------- | :---: | :--: |
| 12.7.1 | 在執行前，透過風險評估整合，驗證主動代理行為的安全性。              |   1   | D/V  |
| 12.7.2 | 驗證自主行動啟動條件是否包含安全情境評估與威脅態勢分析。             |   2   | D/V  |
| 12.7.3 | 確認主動行為模式是否已進行分析，以評估其潛在的安全影響和意外後果。        |   2   | D/V  |
| 12.7.4 | 驗證安全關鍵的主動措施需要有帶審計追蹤的明確批准鏈。               |   3   | D/V  |
| 12.7.5 | 驗證行為異常檢測是否能識別出主動代理行為模式中的偏差，這些偏差可能表明遭到入侵。 |   3   | D/V  |

---

## 參考文獻

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)

