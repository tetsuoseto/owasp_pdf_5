# C12 監控、日誌記錄與異常檢測

## 控制目標

本節提供對模型及其他人工智慧組件所見、所做及所返回內容進行即時與鑑識能見性的需求，以便能夠偵測威脅、進行分級處理並從中學習。

## C12.1 請求與回應日誌記錄

|   #    | Description                                                   | Level | Role |
| :----: | ------------------------------------------------------------- | :---: | :--: |
| 12.1.1 | 確認所有用戶提示和模型回應均被記錄並附有適當的元數據（例如時間戳、用戶ID、會話ID、模型版本）。             |   1   | D/V  |
| 12.1.2 | 確認日誌儲存在具備適當保留政策和備份程序的安全、受控存取的儲存庫中。                            |   1   | D/V  |
| 12.1.3 | 驗證日誌儲存系統是否實施靜態加密和傳輸中加密，以保護日誌中包含的敏感資訊。                         |   1   | D/V  |
| 12.1.4 | 驗證提示和輸出中的敏感數據在記錄前是否自動被刪除或遮蔽，並且對個人識別信息（PII）、憑證和專有信息具有可配置的刪除規則。 |   1   | D/V  |
| 12.1.5 | 驗證政策決策和安全過濾行動已記錄足夠詳細，以便於內容審查系統的審計和除錯。                         |   2   | D/V  |
| 12.1.6 | 驗證日誌完整性是否透過例如加密簽章或只寫入存儲來保護。                                   |   2   | D/V  |

---

## C12.2 濫用偵測與警示

|   #    | Description                                       | Level | Role |
| :----: | ------------------------------------------------- | :---: | :--: |
| 12.2.1 | 確認系統能使用基於特徵的檢測來偵測並警示已知的越獄模式、提示注入嘗試及對抗性輸入。         |   1   | D/V  |
| 12.2.2 | 確認系統是否使用標準的日誌格式和協議與現有的安全資訊與事件管理（SIEM）平台整合。        |   1   | D/V  |
| 12.2.3 | 確認強化的安全事件包含 AI 特有的上下文，如模型識別碼、信心水準分數及安全過濾決策。       |   2   | D/V  |
| 12.2.4 | 確認行為異常檢測能識別不尋常的對話模式、過度重試嘗試或系統性探查行為。               |   2   | D/V  |
| 12.2.5 | 驗證即時警報機制在偵測到潛在政策違規或攻擊嘗試時是否能通知安全團隊。                |   2   | D/V  |
| 12.2.6 | 確認是否包含用於檢測 AI 特定威脅模式的自訂規則，包括協同越獄嘗試、提示注入活動及模型提取攻擊。 |   2   | D/V  |
| 12.2.7 | 驗證自動化事件響應工作流程是否能隔離被入侵的模型、封鎖惡意用戶，並升級關鍵安全事件。        |   3   | D/V  |

---

## C12.3 模型漂移檢測

|   #    | Description                                       | Level | Role |
| :----: | ------------------------------------------------- | :---: | :--: |
| 12.3.1 | 驗證系統是否追蹤基本效能指標，如準確率、信心分數、延遲時間和錯誤率，並涵蓋不同模型版本及時間區段。 |   1   | D/V  |
| 12.3.2 | 驗證當性能指標超過預定的降級閾值或顯著偏離基線時，自動警報是否會觸發。               |   2   | D/V  |
| 12.3.3 | 確認幻覺檢測監控是否能識別並標記模型輸出中包含事實錯誤、不一致或虛構資訊的情況。          |   2   | D/V  |

---

## C12.4 性能與行為遙測

|   #    | Description                                    | Level | Role |
| :----: | ---------------------------------------------- | :---: | :--: |
| 12.4.1 | 確認包含請求延遲、代幣消耗、記憶體使用量和吞吐量在內的運營指標持續被收集和監控。       |   1   | D/V  |
| 12.4.2 | 確認成功率和失敗率是否被追蹤，並對錯誤類型及其根本原因進行分類。               |   1   | D/V  |
| 12.4.3 | 確認資源利用監控包括 GPU/CPU 使用率、記憶體消耗和儲存需求，並在閾值超過時發出警報。 |   2   | D/V  |

---

## C12.5 人工智慧事件應對規劃與執行

|   #    | Description                                 | Level | Role |
| :----: | ------------------------------------------- | :---: | :--: |
| 12.5.1 | 確認事件響應計劃特別針對與人工智慧相關的安全事件，包括模型妥協、數據中毒和對抗性攻擊。 |   1   | D/V  |
| 12.5.2 | 確保事件回應團隊能夠使用特定於人工智慧的取證工具和專業知識，以調查模型行為和攻擊向量。 |   2   | D/V  |
| 12.5.3 | 確認事件後分析包含模型再訓練的考量、安全過濾器更新，以及將經驗教訓整合到安全控制中。  |   3   | D/V  |

---

## C12.5 AI 性能退化檢測

監控並檢測AI模型性能和質量隨時間的退化。

|   #    | Description                            | Level | Role |
| :----: | -------------------------------------- | :---: | :--: |
| 12.5.1 | 確認模型的準確率、精確度、召回率和F1分數持續被監控並與基準門檻進行比較。  |   1   | D/V  |
| 12.5.2 | 驗證資料漂移檢測監控輸入分佈的變化，這些變化可能影響模型的效能。       |   1   | D/V  |
| 12.5.3 | 驗證概念漂移檢測是否能識別輸入與預期輸出之間關係的變化。           |   2   | D/V  |
| 12.5.4 | 驗證性能下降是否觸發自動警報並啟動模型重新訓練或替換流程。          |   2   | D/V  |
| 12.5.5 | 驗證退化根本原因分析是否將性能下降與資料變更、基礎架構問題或外部因素相關聯。 |   3   |  V   |

---

## C12.6 有向無環圖（DAG）視覺化與工作流程安全

保護工作流程視覺化系統免於資訊洩漏和操作攻擊。

|   #    | Description                                  | Level | Role |
| :----: | -------------------------------------------- | :---: | :--: |
| 12.6.1 | 確認有向無環圖（DAG）視覺化數據在存儲或傳輸前已經過清理，以去除敏感信息。       |   1   | D/V  |
| 12.6.2 | 驗證工作流程視覺化存取控制，確保只有授權使用者可以查看代理決策路徑和推理軌跡。      |   1   | D/V  |
| 12.6.3 | 驗證透過加密簽名和防篡改存儲機制保護DAG數據的完整性。                 |   2   | D/V  |
| 12.6.4 | 驗證工作流程視覺化系統是否實施輸入驗證，以防止透過精心製作的節點或邊資料進行注入攻擊。  |   2   | D/V  |
| 12.6.5 | 驗證即時有向無環圖（DAG）更新是否有限速並經過驗證，以防止對視覺化系統的拒絕服務攻擊。 |   3   | D/V  |

---

## C12.7 主動式安全行為監控

透過主動式代理行為分析來偵測與防範安全威脅。

|   #    | Description                     | Level | Role |
| :----: | ------------------------------- | :---: | :--: |
| 12.7.1 | 驗證主動代理行為在執行前已通過安全驗證，並整合風險評估。    |   1   | D/V  |
| 12.7.2 | 驗證自主啟動觸發條件包括安全環境評估和威脅態勢評估。      |   2   | D/V  |
| 12.7.3 | 確認主動行為模式是否已被分析其潛在的安全影響和意外後果。    |   2   | D/V  |
| 12.7.4 | 驗證安全關鍵的主動行動需要明確的批准鏈和審計追蹤。       |   3   | D/V  |
| 12.7.5 | 驗證行為異常檢測能識別出可能表示受到入侵的主動型代理模式偏差。 |   3   | D/V  |

---

## 參考資料

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)

