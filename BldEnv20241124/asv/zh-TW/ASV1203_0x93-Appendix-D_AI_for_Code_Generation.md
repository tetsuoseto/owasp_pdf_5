# 附錄D：AI輔助安全編碼治理與驗證

## 目標

本章定義了在軟體開發過程中安全且有效使用人工智慧輔助程式編寫工具的基線組織控制措施，確保軟體開發生命週期中的安全性與可追蹤性。

---

## AD.1 人工智慧輔助的安全編碼工作流程

將 AI 工具整合到組織的安全軟體開發生命週期（SSDLC）中，同時不削弱現有的安全防護措施。

|   #    | Description                                          | Level | Role |
| :----: | ---------------------------------------------------- | :---: | :--: |
| AD.1.1 | 確認已記錄的工作流程描述AI工具何時以及如何生成、重構或審查程式碼。                   |   1   | D/V  |
| AD.1.2 | 驗證工作流程是否對應到每個安全軟體開發生命週期（SSDLC）階段（設計、實作、程式碼審查、測試、部署）。 |   2   |  D   |
| AD.1.3 | 驗證是否對 AI 生成的程式碼收集指標（例如漏洞密度、平均檢測時間），並與僅有人類編寫的基準進行比較。  |   3   | D/V  |

---

## AD.2 AI 工具資格認證與威脅建模

確保在採用人工智慧程式設計工具之前，評估其安全性能、風險及供應鏈影響。

|   #    | Description                                               | Level | Role |
| :----: | --------------------------------------------------------- | :---: | :--: |
| AD.2.1 | 驗證每個 AI 工具的威脅模型是否識別出誤用、模型反演、資料洩漏和依賴鏈風險。                   |   1   | D/V  |
| AD.2.2 | 確認工具評估包括對任何本地元件的靜態/動態分析，以及對 SaaS 端點（TLS、身份驗證/授權、日誌記錄）的評估。 |   2   |  D   |
| AD.2.3 | 驗證評估是否遵循公認的框架，並在重大版本變更後重新執行評估。                            |   3   | D/V  |

---

## AD.3 安全的提示詞與上下文管理

在為 AI 模型構建提示或上下文時，防止洩露機密、專有代碼和個人數據。

|   #    | Description                               | Level | Role |
| :----: | ----------------------------------------- | :---: | :--: |
| AD.3.1 | 確認書面指引禁止在提示中傳送機密、憑證或機密資料。                 |   1   | D/V  |
| AD.3.2 | 驗證技術控制（客戶端編輯、核准的上下文篩選器）能自動剝除敏感資訊。         |   2   |  D   |
| AD.3.3 | 確認提示詞和回應在傳輸及靜止狀態下均已進行分詞與加密，且保留期限符合資料分類政策。 |   3   | D/V  |

---

## AD.4 AI生成代碼的驗證

在程式碼合併或部署之前，偵測並修復由人工智慧輸出引入的漏洞。

|   #    | Description                                                 | Level | Role |
| :----: | ----------------------------------------------------------- | :---: | :--: |
| AD.4.1 | 確認 AI 生成的程式碼始終經過人工程式碼審查。                                    |   1   | D/V  |
| AD.4.2 | 確認所有包含 AI 生成代碼的拉取請求都會運行自動掃描器（SAST/IAST/DAST），並在發現關鍵問題時阻止合併。 |   2   |  D   |
| AD.4.3 | 驗證差分模糊測試或基於屬性的測試是否證明了安全關鍵行為（例如，輸入驗證、授權邏輯）。                  |   3   | D/V  |

---

## AD.5 代碼建議的可解釋性與可追溯性

向審計人員和開發人員提供有關建議原因及其演變過程的見解。

|   #    | Description                                              | Level | Role |
| :----: | -------------------------------------------------------- | :---: | :--: |
| AD.5.1 | 確認提示詞/回應對是否已使用提交識別碼進行日誌記錄。                               |   1   | D/V  |
| AD.5.2 | 驗證開發者能夠展示支持建議的模型引用（訓練片段、文件）。                             |   2   |  D   |
| AD.5.3 | 驗證可解釋性報告是否與設計工件一同存儲，並在安全審查中被引用，以符合 ISO/IEC 42001 可追蹤性原則。 |   3   | D/V  |

---

## AD.6 持續反饋與模型微調

隨著時間推移提升模型安全性能，同時防止負向漂移。

|   #    | Description                                        | Level | Role |
| :----: | -------------------------------------------------- | :---: | :--: |
| AD.6.1 | 確認開發人員能標記不安全或不合規的建議，並且標記能被追蹤。                      |   1   | D/V  |
| AD.6.2 | 確保彙總的反饋用於定期微調或結合經過審核的安全編碼語料庫（例如 OWASP 速查表）的檢索增強生成。 |   2   |  D   |
| AD.6.3 | 確保閉環評估機制在每次微調後執行迴歸測試；安全性指標必須達到或超過先前基準，方可部署。        |   3   | D/V  |

---

### 參考文獻

* [NIST AI Risk Management Framework 1.0](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements](https://www.iso.org/standard/81230.html)
* [OWASP Secure Coding Practices — Quick Reference Guide](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/)

