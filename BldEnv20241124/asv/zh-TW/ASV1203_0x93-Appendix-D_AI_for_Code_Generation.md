# 附錄D：人工智慧輔助安全程式碼治理與驗證

## 目標

本章定義了基線組織控制，用於在軟體開發過程中安全且有效地使用 AI 輔助編碼工具，確保軟體開發生命週期（SDLC）中的安全性和可追溯性。

---

## AD.1 AI輔助安全編碼工作流程

將 AI 工具整合到組織的安全軟體開發生命週期 (SSDLC) 中，同時不削弱現有的安全門檻。

|   #    | Description                                     | Level | Role |
| :----: | ----------------------------------------------- | :---: | :--: |
| AD.1.1 | 驗證已記錄的工作流程是否描述了 AI 工具何時以及如何生成、重構或審查代碼。          |   1   | D/V  |
| AD.1.2 | 確認工作流程對應至每個 SSDLC 階段（設計、實作、程式碼審查、測試、部署）。        |   2   |  D   |
| AD.1.3 | 驗證是否對 AI 生成的程式碼收集指標（例如漏洞密度、平均偵測時間），並與純人工基準進行比較。 |   3   | D/V  |

---

## AD.2 AI 工具資格認證與威脅建模

在採用人工智慧程式編寫工具前，務必評估其安全功能、風險及供應鏈影響。

|   #    | Description                                             | Level | Role |
| :----: | ------------------------------------------------------- | :---: | :--: |
| AD.2.1 | 確認每個 AI 工具的威脅模型涵蓋誤用、模型反演、資料外洩及依賴鏈風險。                    |   1   | D/V  |
| AD.2.2 | 請確認工具評估包括對任何本地組件的靜態/動態分析以及對SaaS端點（TLS、身份驗證/授權、日誌記錄）的評估。 |   2   |  D   |
| AD.2.3 | 確認評估遵循公認框架，並在主要版本變更後重新執行。                               |   3   | D/V  |

---

## AD.3 安全提示與上下文管理

在為 AI 模型構建提示或上下文時，防止機密信息、專有代碼和個人數據的洩漏。

|   #    | Description                                   | Level | Role |
| :----: | --------------------------------------------- | :---: | :--: |
| AD.3.1 | 確認書面指導禁止在提示中發送秘密、憑證或機密資料。                     |   1   | D/V  |
| AD.3.2 | 驗證技術控制（用戶端刪除、已批准的上下文過濾器）是否自動剝除敏感資訊。           |   2   |  D   |
| AD.3.3 | 驗證提示和回應在傳輸過程中及靜止狀態下是否經過分詞和加密，並且保留期是否符合資料分類政策。 |   3   | D/V  |

---

## AD.4 AI 生成代碼的驗證

在代碼合併或部署之前，檢測並修復由 AI 輸出引入的漏洞。

|   #    | Description                                                 | Level | Role |
| :----: | ----------------------------------------------------------- | :---: | :--: |
| AD.4.1 | 確認 AI 產生的程式碼始終接受人工程式碼審查。                                    |   1   | D/V  |
| AD.4.2 | 確認所有包含 AI 生成代碼的拉取請求均執行自動掃描工具（SAST/IAST/DAST），並在發現嚴重問題時阻止合併。 |   2   |  D   |
| AD.4.3 | 驗證差分模糊測試或基於屬性的測試能證明安全關鍵行為（例如，輸入驗證、授權邏輯）。                    |   3   | D/V  |

---

## AD.5 代碼建議的可解釋性與可追溯性

為審計人員和開發人員提供建議產生的原因及其演變過程的見解。

|   #    | Description                                              | Level | Role |
| :----: | -------------------------------------------------------- | :---: | :--: |
| AD.5.1 | 驗證提示/回應對是否已與提交 ID 一起記錄。                                  |   1   | D/V  |
| AD.5.2 | 驗證開發人員是否能夠呈現支持建議的模型引用（訓練片段、文件）。                          |   2   |  D   |
| AD.5.3 | 驗證可解釋性報告是否與設計文件一起存檔，並在安全性審查中引用，以符合 ISO/IEC 42001 可追溯性原則。 |   3   | D/V  |

---

## AD.6 持續反饋與模型微調

隨著時間推移提升模型安全性能，同時防止負面偏移。

|   #    | Description                                           | Level | Role |
| :----: | ----------------------------------------------------- | :---: | :--: |
| AD.6.1 | 確認開發人員能標記不安全或不合規的建議，並且標記會被追蹤。                         |   1   | D/V  |
| AD.6.2 | 確認彙總的反饋意見用於周期性微調或使用經審核的安全編碼語料庫（例如 OWASP 速查表）進行檢索增強生成。 |   2   |  D   |
| AD.6.3 | 確認閉環評估機制在每次微調後執行回歸測試；部署前安全指標必須達到或超過先前基準。              |   3   | D/V  |

---

### 參考文獻

* [NIST AI Risk Management Framework 1.0](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements](https://www.iso.org/standard/81230.html)
* [OWASP Secure Coding Practices — Quick Reference Guide](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/)

