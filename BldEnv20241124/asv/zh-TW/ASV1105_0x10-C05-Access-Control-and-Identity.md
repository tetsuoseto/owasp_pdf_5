# C5 人工智慧組件與使用者之存取控制與身份管理

## 控制目標

對人工智慧系統實施有效的存取控制需要強健的身份管理、具情境感知的授權，以及遵循零信任原則的執行機制。這些控制確保人類、服務與自主代理僅在明確授予的範圍內與模型、資料及計算資源互動，並具備持續驗證與稽核能力。

---

## C5.1 身份管理與認證

為所有實體建立具密碼學支持的身份，並對特權操作實施多因素驗證。

|   #   | Description                                                                         | Level | Role |
| :---: | ----------------------------------------------------------------------------------- | :---: | :--: |
| 5.1.1 | 驗證所有人類使用者和服務主體是否透過集中式企業身分識別提供者（IdP）使用 OIDC/SAML 協定進行身份驗證，並且具有唯一的身份對應令牌映射（無共用帳號或憑證）。 |   1   | D/V  |
| 5.1.2 | 確認高風險操作（模型部署、權重導出、訓練數據訪問、產品配置更改）需要多因素身份驗證或階段性驗證並進行會話重新驗證。                           |   1   | D/V  |
| 5.1.3 | 驗證新的主要使用者在獲得生產系統存取權之前，必須進行符合 NIST 800-63-3 IAL-2 或同等標準的身份驗證。                        |   2   |  D   |
| 5.1.4 | 驗證是否每季度進行存取審查，並自動偵測閒置帳戶、強制憑證輪換及執行帳戶停用流程。                                            |   2   |  V   |
| 5.1.5 | 驗證聯邦 AI 代理是否透過簽署的 JWT 斷言進行身份驗證，該斷言的最大有效期限為 24 小時，並包含起源的密碼學證明。                       |   3   | D/V  |

---

## C5.2 資源授權與最小權限

為所有人工智慧資源實施細緻的存取控制，並建立明確的權限模型及審計追蹤。

|   #   | Description                                                          | Level | Role |
| :---: | -------------------------------------------------------------------- | :---: | :--: |
| 5.2.1 | 驗證每個 AI 資源（數據集、模型、端點、向量集合、嵌入索引、計算實例）是否實施基於角色的存取控制，並具有明確的允許清單和預設拒絕政策。 |   1   | D/V  |
| 5.2.2 | 驗證服務帳戶預設遵循最小權限原則，初始權限為唯讀，且寫入權限需有文件化的業務理由。                            |   1   | D/V  |
| 5.2.3 | 驗證所有存取控制的修改均與經批准的變更請求相關聯，並以不可變方式記錄，包括時間戳記、執行者身份、資源識別碼及權限差異。          |   1   |  V   |
| 5.2.4 | 驗證數據分類標籤（PII、PHI、出口管制、專有）是否自動傳播到派生資源（嵌入、提示快取、模型輸出），並確保政策執行一致。        |   2   |  D   |
| 5.2.5 | 驗證未經授權的存取嘗試和權限提升事件是否在 5 分鐘內觸發帶有上下文元資料的即時警報至 SIEM 系統。                 |   2   | D/V  |

---

## C5.3 動態策略評估

部署屬性基礎存取控制（ABAC）引擎，以進行具備稽核能力的情境感知授權決策。

|   #   | Description                                                          | Level | Role |
| :---: | -------------------------------------------------------------------- | :---: | :--: |
| 5.3.1 | 驗證授權決策是否已外部化至專用的政策引擎（如 OPA、Cedar 或同等系統），並且該系統可透過具備加密完整性保護的認證 API 存取。 |   1   | D/V  |
| 5.3.2 | 驗證政策是否在執行時評估動態屬性，包括使用者權限等級、資源敏感性分類、請求上下文、租戶隔離和時間限制。                  |   1   | D/V  |
| 5.3.3 | 驗證政策定義是否在生產部署前經過版本控制、同儕審查，並透過持續整合/持續部署(CI/CD)管線中的自動化測試進行驗證。          |   2   |  D   |
| 5.3.4 | 驗證政策評估結果是否包含結構化決策理由，並傳送至SIEM系統以進行相關性分析和合規報告。                         |   2   |  V   |
| 5.3.5 | 驗證策略快取的存活時間（TTL）值是否未超過對高敏感度資源為5分鐘，以及對具有快取失效功能的標準資源為1小時。              |   3   | D/V  |

---

## C5.4 查詢時安全性強制執行

實施資料庫層級安全控制，包含強制篩選和列級安全性策略。

|   #   | Description                                                                     | Level | Role |
| :---: | ------------------------------------------------------------------------------- | :---: | :--: |
| 5.4.1 | 驗證所有向量資料庫和 SQL 查詢均包含強制性的安全篩選條件（租戶 ID、敏感度標籤、使用者範圍），且這些篩選條件是在資料庫引擎層級執行，而非應用程式代碼中。 |   1   | D/V  |
| 5.4.2 | 驗證是否針對所有向量資料庫、搜尋索引和訓練資料集啟用了具有政策繼承的列級安全性 (RLS) 策略和欄位級遮罩。                         |   1   | D/V  |
| 5.4.3 | 確認失敗的授權評估將通過立即中止查詢並返回明確的授權錯誤代碼，而非返回空結果集，來防止「混淆代理攻擊」。                            |   2   |  D   |
| 5.4.4 | 確認政策評估延遲持續受到監控，並設有自動化警報以提醒可能導致授權繞過的逾時狀況。                                        |   2   |  V   |
| 5.4.5 | 驗證查詢重試機制是否重新評估授權政策，以考慮在活動用戶會話中動態權限變更。                                           |   3   | D/V  |

---

## C5.5 輸出過濾與資料遺失防護

部署後處理控制以防止未經授權的數據暴露於人工智慧生成的內容中。

|   #   | Description                                               | Level | Role |
| :---: | --------------------------------------------------------- | :---: | :--: |
| 5.5.1 | 確認推理後的過濾機制在向請求者提供內容之前，會掃描並刪除未經授權的個人識別資訊（PII）、機密資訊及專有資料。   |   1   | D/V  |
| 5.5.2 | 驗證模型輸出中的引文、參考資料及來源歸屬，確保符合呼叫者權限，若發現未授權存取則予以移除。             |   1   | D/V  |
| 5.5.3 | 驗證輸出格式限制（淨化的 PDF、去除元資料的圖像、核准的檔案類型）是否根據使用者權限等級和資料分類得到強制執行。 |   2   |  D   |
| 5.5.4 | 驗證刪節算法是否為確定性、版本控制且維護審計日志，以支持合規調查和法證分析。                    |   2   |  V   |
| 5.5.5 | 驗證高風險塗銷事件會產生包含原始內容加密雜湊值的自適應日誌，以便進行法證檢索且不會暴露數據。            |   3   |  V   |

---

## C5.6 多租戶隔離

確保共用 AI 基礎設施中租戶之間的加密及邏輯隔離。

|   #   | Description                                           | Level | Role |
| :---: | ----------------------------------------------------- | :---: | :--: |
| 5.6.1 | 驗證記憶體空間、嵌入存儲、快取條目和臨時檔案是否依租戶進行命名空間隔離，並在租戶刪除或會話終止時安全清除。 |   1   | D/V  |
| 5.6.2 | 驗證每個 API 請求皆包含經過認證的租戶識別碼，並對其進行密碼學驗證，以符合會話上下文和用戶權限。    |   1   | D/V  |
| 5.6.3 | 驗證網路政策是否在服務網格和容器編排平台中對跨租戶通訊實施了默認拒絕規則。                 |   2   |  D   |
| 5.6.4 | 驗證加密金鑰在每個租戶中皆唯一，並支援客戶管理金鑰（CMK）及租戶資料存儲之間的密碼學隔離。        |   3   |  D   |

---

## C5.7 自主代理授權

通過範圍能力令牌和持續授權來控制 AI 代理和自動化系統的權限。

|   #   | Description                                                   | Level | Role |
| :---: | ------------------------------------------------------------- | :---: | :--: |
| 5.7.1 | 驗證自動代理是否接收範圍限定的能力令牌，該令牌明確列出允許的操作、可訪問的資源、時間邊界和操作限制。            |   1   | D/V  |
| 5.7.2 | 確認高風險功能（檔案系統存取、程式碼執行、外部 API 呼叫、金融交易）預設為停用，並且啟用時需要具備業務理由的明確授權。 |   1   | D/V  |
| 5.7.3 | 驗證能力令牌是否綁定至用戶會話，包含密碼學完整性保護，並確保其無法在離線情況下持久化或重複使用。              |   2   |  D   |
| 5.7.4 | 驗證代理發起的行動是否經由 ABAC 政策引擎，透過完整上下文評估及審計日誌進行次級授權。                 |   2   |  V   |
| 5.7.5 | 確認代理錯誤狀況和例外處理包含能力範圍資訊，以支援事件分析和取證調查。                           |   3   |  V   |

---

## 參考文獻

### 標準與框架

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### 實作指南

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### 人工智慧專屬安全

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)

