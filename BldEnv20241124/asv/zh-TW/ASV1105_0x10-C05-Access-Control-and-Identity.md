# C5 AI 元件與使用者的存取控制與身分管理

## 控制目標

AI 系統的有效存取控制需要強大的身份管理、情境感知授權，以及遵循零信任原則的執行時強制。這些控制確保人類、服務和自主代理僅在明確授權的範圍內與模型、數據和計算資源互動，並具備持續的驗證與審核能力。

---

## C5.1 身份管理與認證

為所有實體建立具密碼學支持的身份，並針對特權操作採用多重身份驗證。

|   #   | Description                                                                    | Level | Role |
| :---: | ------------------------------------------------------------------------------ | :---: | :--: |
| 5.1.1 | 驗證所有人類使用者和服務主體皆透過集中式企業身份提供者（IdP）使用 OIDC/SAML 協議進行驗證，並採用唯一的身份對令牌映射（不使用共享帳號或憑證）。 |   1   | D/V  |
| 5.1.2 | 確認高風險操作（模型部署、權重導出、訓練數據存取、生產環境配置更改）需進行多因素身份驗證或升級身份驗證並重新驗證會話。                    |   1   | D/V  |
| 5.1.3 | 確認新任主管在獲得生產系統訪問權限之前，已進行符合 NIST 800-63-3 IAL-2 或等效標準的身份驗證。                      |   2   |  D   |
| 5.1.4 | 驗證是否每季度進行訪問審查，並自動檢測閒置帳戶，強制執行憑證輪換，以及執行帳戶解除權限流程。                                 |   2   |  V   |
| 5.1.5 | 驗證聯邦 AI 代理通過簽署的 JWT 斷言進行身份驗證，該斷言的最大有效期限為 24 小時，並包含來源的加密證明。                     |   3   | D/V  |

---

## C5.2 資源授權與最小權限

對所有人工智慧資源實施精細的存取控制，採用明確的許可模型及審計追蹤。

|   #   | Description                                                               | Level | Role |
| :---: | ------------------------------------------------------------------------- | :---: | :--: |
| 5.2.1 | 確認每個 AI 資源（資料集、模型、端點、向量集合、嵌入索引、計算實例）皆實施基於角色的存取控制，並採用明確的允許清單和預設拒絕政策。       |   1   | D/V  |
| 5.2.2 | 驗證服務帳戶默認情況下是否執行最小權限原則，從只讀權限開始，並且需要有書面業務理由才能取得寫入權限。                        |   1   | D/V  |
| 5.2.3 | 驗證所有存取控制修改均與經核准的變更請求相關聯，並以不可變方式記錄，包含時間戳記、執行者身份、資源識別碼及權限差異。                |   1   |  V   |
| 5.2.4 | 驗證資料分類標籤（個人識別資訊、受保護健康資訊、出口管制、專有資料）是否自動傳遞至衍生資源（向量表示、提示快取、模型輸出），並確保政策一致性執行。 |   2   |  D   |
| 5.2.5 | 驗證未經授權的存取嘗試和權限提升事件是否在5分鐘內觸發含上下文元資料的即時警報，並傳送至SIEM系統。                       |   2   | D/V  |

---

## C5.3 動態政策評估

部署基於屬性的存取控制（ABAC）引擎，以實現具備審計功能的上下文感知授權決策。

|   #   | Description                                                           | Level | Role |
| :---: | --------------------------------------------------------------------- | :---: | :--: |
| 5.3.1 | 確認授權決策已外部化至專用的政策引擎（如 OPA、Cedar 或等效系統），並可透過具備密碼完整性保護且經過身份驗證的 API 進行存取。 |   1   | D/V  |
| 5.3.2 | 驗證政策是否在運行時評估動態屬性，包括使用者許可等級、資源敏感度分類、請求上下文、租戶隔離以及時間限制。                  |   1   | D/V  |
| 5.3.3 | 確認政策定義在正式部署前，已通過版本控制、同儕審查，並且通過 CI/CD 管線中的自動化測試驗證。                     |   2   |  D   |
| 5.3.4 | 驗證策略評估結果是否包含結構化的決策依據，並且是否傳送至 SIEM 系統以進行關聯分析和合規報告。                     |   2   |  V   |
| 5.3.5 | 驗證政策快取的存活時間（TTL）值是否不超過高敏感資源的5分鐘以及具有快取失效功能的標準資源的1小時。                   |   3   | D/V  |

---

## C5.4 查詢時安全執行

實施資料庫層級的安全控制，包含強制過濾和列級安全性政策。

|   #   | Description                                                                       | Level | Role |
| :---: | --------------------------------------------------------------------------------- | :---: | :--: |
| 5.4.1 | 驗證所有向量資料庫和 SQL 查詢均包含強制的安全過濾條件（租戶 ID、敏感性標籤、使用者範圍），且這些過濾條件是在資料庫引擎層級強制執行，而非應用程式程式碼中。 |   1   | D/V  |
| 5.4.2 | 驗證所有向量資料庫、搜尋索引和訓練資料集是否已啟用具繼承性的列級安全性（RLS）政策及欄位級遮罩。                                 |   1   | D/V  |
| 5.4.3 | 確認失敗的授權評估將通過立即中止查詢並返回明確的授權錯誤代碼，而不是返回空的結果集，來防止「混淆受托人攻擊」。                           |   2   |  D   |
| 5.4.4 | 確認策略評估延遲持續被監控，並有自動警報系統針對可能導致授權繞過的逾時狀況發出警示。                                        |   2   |  V   |
| 5.4.5 | 確認查詢重試機制能重新評估授權政策，以考量活動用戶會話中動態權限變更。                                               |   3   | D/V  |

---

## C5.5 輸出過濾與資料防洩漏

部署後處理控制以防止未經授權的AI生成內容數據洩露。

|   #   | Description                                                | Level | Role |
| :---: | ---------------------------------------------------------- | :---: | :--: |
| 5.5.1 | 確認推理後的過濾機制會在將內容提供給請求者之前，掃描並刪除未經授權的個人識別資訊（PII）、機密資訊及專有資料。   |   1   | D/V  |
| 5.5.2 | 驗證模型輸出中的引用、參考文獻及來源歸屬，確保其符合呼叫者權限，若發現未經授權的存取則予以移除。           |   1   | D/V  |
| 5.5.3 | 根據使用者權限等級及資料分類，驗證輸出格式限制（經淨化的 PDF、去除元資料的影像、核准的檔案類型）是否被強制執行。 |   2   |  D   |
| 5.5.4 | 驗證去識別演算法具有確定性、版本控制，並且維持審計日誌以支援合規調查和鑑識分析。                   |   2   |  V   |
| 5.5.5 | 驗證高風險修訂事件是否產生包含原始內容加密雜湊值的自適應日誌，以便進行偵查檢索而不暴露數據。             |   3   |  V   |

---

## C5.6 多租戶隔離

確保共用 AI 基礎設施中租戶之間的加密與邏輯隔離。

|   #   | Description                                             | Level | Role |
| :---: | ------------------------------------------------------- | :---: | :--: |
| 5.6.1 | 確認記憶體空間、嵌入存儲、快取項目以及臨時檔案均依每個租戶進行命名空間隔離，並在租戶刪除或會話終止時安全清除。 |   1   | D/V  |
| 5.6.2 | 驗證每個 API 請求皆包含經身份驗證的租戶識別碼，並對其進行加密驗證以確保其符合會話上下文及使用者權限。   |   1   | D/V  |
| 5.6.3 | 確認網路政策在服務網格和容器編排平台中，對跨租戶通訊實施預設拒絕規則。                     |   2   |  D   |
| 5.6.4 | 驗證加密金鑰在每個租戶中均唯一，並支援客戶管理金鑰（CMK）及租戶資料存儲之間的密碼學隔離。          |   3   |  D   |

---

## C5.7 自主代理授權

透過範圍能力令牌與持續授權，控制 AI 代理與自動系統的權限。

|   #   | Description                                             | Level | Role |
| :---: | ------------------------------------------------------- | :---: | :--: |
| 5.7.1 | 驗證自主代理是否接收範圍明確的能力令牌，該令牌明確列出允許的操作、可訪問的資源、時間界限以及運行約束。     |   1   | D/V  |
| 5.7.2 | 確認高風險功能（檔案系統存取、程式碼執行、外部API呼叫、金融交易）預設為停用，且啟用需有明確授權及業務理由。 |   1   | D/V  |
| 5.7.3 | 驗證能力令牌已綁定至用戶會話，包含密碼學完整性保護，並確保其無法在離線情況下被持久化或重複使用。        |   2   |  D   |
| 5.7.4 | 確認代理人發起的操作通過基於屬性的存取控制（ABAC）政策引擎進行二次授權，並進行完整的上下文評估與審計記錄。 |   2   |  V   |
| 5.7.5 | 驗證代理錯誤條件和異常處理是否包含能力範圍資訊，以支持事件分析和取證調查。                   |   3   |  V   |

---

## 參考文獻

### 標準與框架

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### 實作指南

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### 人工智慧專用安全性

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)

