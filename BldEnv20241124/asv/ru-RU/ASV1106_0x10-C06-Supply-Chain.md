# C6 Безопасность цепочки поставок для моделей, фреймворков и данных

## Цель контроля

Атаки на цепочку поставок ИИ используют сторонние модели, фреймворки или наборы данных для внедрения бекдоров, предвзятости или уязвимого кода. Эти меры обеспечивают полную прослеживаемость, управление уязвимостями и мониторинг для защиты всего жизненного цикла модели.

---

## C6.1 Проверка и происхождение предварительно обученной модели

Оценивайте и проверяйте происхождение моделей третьих сторон, лицензии и скрытые поведения перед любой донастройкой или развертыванием.

|   #   | Description                                                                                                                                                        | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 6.1.1 | Убедитесь, что каждый сторонний артефакт модели содержит подписанную запись происхождения с указанием исходного репозитория и хэша коммита.                        |   1   | D/V  |
| 6.1.2 | Убедитесь, что модели сканируются на наличие вредоносных слоев или триггеров Трояна с помощью автоматизированных инструментов перед импортом.                      |   1   | D/V  |
| 6.1.3 | Проверьте, что дообучение методом transfer-learning проходит адверсариальное тестирование для выявления скрытых поведений.                                         |   2   |  D   |
| 6.1.4 | Проверьте, что лицензии моделей, теги экспортного контроля и заявления об источнике данных зафиксированы в записи ML‑BOM.                                          |   2   |  V   |
| 6.1.5 | Убедитесь, что модели с высоким риском (публично загруженные веса, непроверенные создатели) остаются в карантине до проведения человеческого обзора и утверждения. |   3   | D/V  |

---

## C6.2 Сканирование фреймворков и библиотек

Постоянно сканируйте фреймворки и библиотеки машинного обучения на наличие CVE и вредоносного кода, чтобы обеспечить безопасность среды выполнения.

|   #   | Description                                                                                                                                   | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.2.1 | Проверьте, что конвейеры CI запускают сканеры зависимостей для AI-фреймворков и критически важных библиотек.                                  |   1   | D/V  |
| 6.2.2 | Проверьте, что критические уязвимости (CVSS ≥ 7.0) блокируют продвижение к образам для производства.                                          |   1   | D/V  |
| 6.2.3 | Проверьте, что статический анализ кода выполняется для форкнутых или включённых в проект ML-библиотек.                                        |   2   |  D   |
| 6.2.4 | Проверьте, что в предложениях по обновлению фреймворка включена оценка воздействия на безопасность с ссылками на общедоступные источники CVE. |   2   |  V   |
| 6.2.5 | Проверьте, что сенсоры времени выполнения оповещают о неожиданных загрузках динамических библиотек, которые отклоняются от подписанного SBOM. |   3   |  V   |

---

## C6.3 Фиксация и проверка зависимостей

Зафиксируйте каждую зависимость на неизменяемых дайджестах и воспроизводите сборки, чтобы гарантировать идентичные, защищённые от подделки артефакты.

|   #   | Description                                                                                                                        | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.3.1 | Убедитесь, что все менеджеры пакетов обеспечивают фиксацию версий через lockfile.                                                  |   1   | D/V  |
| 6.3.2 | Проверьте, что в ссылках на контейнеры используются неизменяемые дайджесты вместо изменяемых тегов.                                |   1   | D/V  |
| 6.3.3 | Проверьте, что проверки воспроизводимых сборок сравнивают хеши между запусками CI, чтобы обеспечить идентичные результаты.         |   2   |  D   |
| 6.3.4 | Проверьте, что свидетельства сборки хранятся в течение 18 месяцев для обеспечения аудиторской прослеживаемости.                    |   2   |  V   |
| 6.3.5 | Проверьте, что истекшие зависимости вызывают автоматические запросы на слияние (PR) для обновления или форка фиксированных версий. |   3   |  D   |

---

## C6.4 Принудительное обеспечение доверенного источника

Разрешать загрузку артефактов только из криптографически проверенных источников, одобренных организацией, и блокировать всё остальное.

|   #   | Description                                                                                                                          | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 6.4.1 | Убедитесь, что веса модели, наборы данных и контейнеры загружаются только с одобренных доменов или внутренних реестров.              |   1   | D/V  |
| 6.4.2 | Проверяйте, что подписи Sigstore/Cosign подтверждают личность издателя перед локальным кэшированием артефактов.                      |   1   | D/V  |
| 6.4.3 | Проверьте, что исходящие прокси блокируют неаутентифицированные загрузки артефактов для обеспечения политики доверенного источника.  |   2   |  D   |
| 6.4.4 | Проверьте, что списки разрешённых репозиториев пересматриваются ежеквартально с подтверждением бизнес-обоснования для каждой записи. |   2   |  V   |
| 6.4.5 | Проверьте, что нарушения политики вызывают карантин артефактов и откат зависимых запусков конвейера.                                 |   3   |  V   |

---

## C6.5 Оценка рисков использования сторонних наборов данных

Оценивайте внешние наборы данных на наличие отравления, предвзятости и соответствия законодательству, а также контролируйте их в течение всего жизненного цикла.

|   #   | Description                                                                                                                          | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 6.5.1 | Проверьте, проходят ли внешние наборы данных оценку риска отравления (например, создание отпечатков данных, обнаружение выбросов).   |   1   | D/V  |
| 6.5.2 | Убедитесь, что метрики предвзятости (демографическое равенство, равные возможности) рассчитываются перед утверждением набора данных. |   1   |  D   |
| 6.5.3 | Проверьте, что происхождение и условия лицензирования наборов данных зафиксированы в записях ML-BOM.                                 |   2   |  V   |
| 6.5.4 | Проверяйте, что периодический мониторинг выявляет дрейф или повреждение размещённых наборов данных.                                  |   2   |  V   |
| 6.5.5 | Убедитесь, что запрещённый контент (авторские права, персональные данные) удалён с помощью автоматической очистки перед обучением.   |   3   |  D   |

---

## C6.6 Мониторинг атак на цепочку поставок

Раннее обнаружение угроз в цепочке поставок через ленты CVE, аналитику журналов аудита и симуляции красной команды.

|   #   | Description                                                                                                                                                                    | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 6.6.1 | Проверьте, что журналы аудита CI/CD передаются в SIEM для обнаружения аномальных загрузок пакетов или подмененных этапов сборки.                                               |   1   |  V   |
| 6.6.2 | Проверьте, что в планах реагирования на инциденты включены процедуры отката для скомпрометированных моделей или библиотек.                                                     |   2   |  D   |
| 6.6.3 | Проверьте, что теги обогащения разведданных о угрозах маркируют специфичные для машинного обучения индикаторы (например, IoC загрязнения модели) при приоритизации оповещений. |   3   |  V   |

---

## C6.7 ML‑BOM для артефактов модели

Генерируйте и подписывайте подробные специализированные SBOM для машинного обучения (ML‑BOM), чтобы конечные пользователи могли проверять целостность компонентов во время развертывания.

|   #   | Description                                                                                                                          | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 6.7.1 | Убедитесь, что каждый артефакт модели публикует ML‑BOM, который содержит списки наборов данных, весов, гиперпараметров и лицензий.   |   1   | D/V  |
| 6.7.2 | Проверьте, что генерация ML‑BOM и подписание Cosign автоматизированы в CI и обязательны для слияния.                                 |   1   | D/V  |
| 6.7.3 | Проверьте, что проверки полноты ML‑BOM вызывают сбой сборки, если отсутствуют метаданные любого компонента (хэш, лицензия).          |   2   |  D   |
| 6.7.4 | Проверьте, что конечные пользователи могут запрашивать ML-BOM через API для проверки импортированных моделей во время развертывания. |   2   |  V   |
| 6.7.5 | Проверьте, что ML-BOM находятся под управлением версий и сравниваются для выявления несанкционированных изменений.                   |   3   |  V   |

---

## Ссылки

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)

