# C6 Безопасность цепочки поставок для моделей, фреймворков и данных

## Цель контроля

Атаки на цепочку поставок ИИ используют сторонние модели, фреймворки или наборы данных для внедрения бэкдоров, предвзятости или уязвимого кода. Эти меры обеспечивают полную прослеживаемость, управление уязвимостями и мониторинг для защиты всего жизненного цикла модели.

---

## C6.1 Проверка и происхождение предварительно обученной модели

Оцените и подтвердите происхождение сторонних моделей, лицензии и скрытые поведения до любой донастройки или развертывания.

|   #   | Description                                                                                                                                                                  | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.1.1 | Проверьте, что каждый артефакт модели третьей стороны содержит подписанную запись происхождения с указанием исходного репозитория и хеша коммита.                            |   1   | D/V  |
| 6.1.2 | Проверьте, что модели сканируются на наличие вредоносных слоев или триггеров Трояна с использованием автоматизированных инструментов перед импортом.                         |   1   | D/V  |
| 6.1.3 | Проверьте, что дообучение с использованием трансферного обучения успешно проходит адверсариальную оценку для обнаружения скрытого поведения.                                 |   2   |  D   |
| 6.1.4 | Проверьте, что лицензии модели, теги экспортного контроля и заявления о происхождении данных зафиксированы в записи ML-BOM.                                                  |   2   |  V   |
| 6.1.5 | Убедитесь, что модели высокого риска (загруженные с общедоступными весами, от непроверенных создателей) остаются в карантине до проведения проверки и утверждения человеком. |   3   | D/V  |

---

## C6.2 Сканирование фреймворков и библиотек

Постоянно сканируйте ML-фреймворки и библиотеки на наличие CVE и вредоносного кода, чтобы обеспечить безопасность среды выполнения.

|   #   | Description                                                                                                                                      | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 6.2.1 | Убедитесь, что CI-пайплайны запускают сканеры зависимостей для AI-фреймворков и критически важных библиотек.                                     |   1   | D/V  |
| 6.2.2 | Проверьте, что критические уязвимости (CVSS ≥ 7.0) блокируют продвижение до производственных образов.                                            |   1   | D/V  |
| 6.2.3 | Проверьте, что статический анализ кода выполняется для форкнутых или подключённых библиотек машинного обучения.                                  |   2   |  D   |
| 6.2.4 | Убедитесь, что предложения по обновлению фреймворка включают оценку воздействия на безопасность с ссылкой на общедоступные потоки CVE.           |   2   |  V   |
| 6.2.5 | Проверьте, что датчики времени выполнения сигнализируют о неожиданных загрузках динамических библиотек, которые отклоняются от подписанной SBOM. |   3   |  V   |

---

## C6.3 Закрепление и проверка зависимостей

Закрепляйте каждую зависимость за неизменяемыми дайджестами и воспроизводите сборки, чтобы гарантировать идентичные и защищённые от подделки артефакты.

|   #   | Description                                                                                                                                     | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.3.1 | Проверьте, что все менеджеры пакетов обеспечивают фиксацию версий с помощью lock-файлов.                                                        |   1   | D/V  |
| 6.3.2 | Проверьте, что в ссылках на контейнеры используются неизменяемые дайджесты вместо изменяемых тегов.                                             |   1   | D/V  |
| 6.3.3 | Проверьте, что проверки воспроизводимых сборок сравнивают хэши между запусками CI для обеспечения идентичных результатов.                       |   2   |  D   |
| 6.3.4 | Проверьте, что подтверждения сборки хранятся в течение 18 месяцев для аудиторской прослеживаемости.                                             |   2   |  V   |
| 6.3.5 | Проверьте, что устаревшие зависимости вызывают автоматические запросы на включение изменений (PR) для обновления или форка закрепленных версий. |   3   |  D   |

---

## C6.4 Принудительное соблюдение доверенных источников

Разрешайте загрузку артефактов только с криптографически проверенных, одобренных организацией источников и блокируйте все остальное.

|   #   | Description                                                                                                                            | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.4.1 | Проверяйте, что веса моделей, датасеты и контейнеры загружаются только с одобренных доменов или внутренних реестров.                   |   1   | D/V  |
| 6.4.2 | Проверьте, что подписи Sigstore/Cosign подтверждают личность издателя перед тем, как артефакты кэшируются локально.                    |   1   | D/V  |
| 6.4.3 | Проверьте, что исходящие прокси блокируют неаутентифицированные загрузки артефактов для обеспечения политики доверенных источников.    |   2   |  D   |
| 6.4.4 | Проверьте, что списки разрешённых репозиториев пересматриваются ежеквартально с подтверждением делового обоснования для каждой записи. |   2   |  V   |
| 6.4.5 | Проверьте, что нарушения политики вызывают помещение артефактов в карантин и откат зависимых запусков конвейера.                       |   3   |  V   |

---

## C6.5 Оценка рисков при использовании сторонних наборов данных

Оценивайте внешние наборы данных на предмет отравления, предвзятости и соответствия законодательству, а также контролируйте их на протяжении всего жизненного цикла.

|   #   | Description                                                                                                                           | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.5.1 | Проверьте, что внешние наборы данных проходят оценку риска отравления (например, отпечатки данных, обнаружение выбросов).             |   1   | D/V  |
| 6.5.2 | Проверьте, что метрики смещения (демографический паритет, равные возможности) рассчитываются до утверждения набора данных.            |   1   |  D   |
| 6.5.3 | Проверьте, что сведения о происхождении и условиях лицензирования наборов данных зафиксированы в записях ML-BOM.                      |   2   |  V   |
| 6.5.4 | Проверьте, что периодический мониторинг обнаруживает дрейф или повреждение в размещённых наборах данных.                              |   2   |  V   |
| 6.5.5 | Проверьте, что запрещённый контент (авторские права, персональные данные) удалён с помощью автоматической очистки до начала обучения. |   3   |  D   |

---

## C6.6 Мониторинг атак на цепочку поставок

Обнаруживайте угрозы в цепочке поставок на ранних стадиях с помощью потоков CVE, анализа журналов аудита и симуляций красной команды.

|   #   | Description                                                                                                                                                                                     | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.6.1 | Проверьте, что журналы аудита CI/CD передаются в SIEM для обнаружения аномальных загрузок пакетов или нарушенных этапов сборки.                                                                 |   1   |  V   |
| 6.6.2 | Проверьте, что планы реагирования на инциденты включают процедуры отката для скомпрометированных моделей или библиотек.                                                                         |   2   |  D   |
| 6.6.3 | Проверьте, что теги обогащения разведданных об угрозах относятся к специфическим для машинного обучения индикаторам (например, IoC, связанным с отравлением моделей) при сортировке оповещений. |   3   |  V   |

---

## C6.7 ML‑BOM для артефактов модели

Создавайте и подписывайте подробные специфичные для машинного обучения спецификации состава программного обеспечения (ML-БОМы), чтобы конечные пользователи могли проверять целостность компонентов во время развертывания.

|   #   | Description                                                                                                                                                      | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.7.1 | Убедитесь, что каждый артефакт модели публикует ML‑BOM, который содержит список наборов данных, весов, гиперпараметров и лицензий.                               |   1   | D/V  |
| 6.7.2 | Проверьте, что генерация ML-BOM и подпись Cosign автоматизированы в CI и обязательны для слияния.                                                                |   1   | D/V  |
| 6.7.3 | Проверьте, что проверки полноты ML‑BOM прерывают сборку, если отсутствуют какие-либо метаданные компонента (хэш, лицензия).                                      |   2   |  D   |
| 6.7.4 | Проверьте, что конечные пользователи могут запрашивать ML-BOM через API для проверки импортированных моделей во время развертывания.                             |   2   |  V   |
| 6.7.5 | Проверьте, что ML‑BOM (машинные спецификации материалов) находятся под версионным контролем и сравниваются (diff) для обнаружения несанкционированных изменений. |   3   |  V   |

---

## Ссылки

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)

