# Контроль доступа C5 и управление идентификацией компонентов и пользователей ИИ

## Цель управления

Эффективный контроль доступа к системам ИИ требует надежного управления идентификацией, авторизации с учетом контекста и исполнения политик во время работы в соответствии с принципами модели «ноль доверия». Эти меры обеспечивают, что пользователи, сервисы и автономные агенты взаимодействуют с моделями, данными и вычислительными ресурсами только в пределах явно предоставленных полномочий с постоянной проверкой и возможностями аудита.

---

## C5.1 Управление идентификацией и аутентификация

Установите криптографически защищённые идентификаторы для всех сущностей с многофакторной аутентификацией для привилегированных операций.

|   #   | Description                                                                                                                                                                                                                                                                                                 | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.1.1 | Убедитесь, что все пользователи-люди и сервисные принципы аутентифицируются через централизованного корпоративного поставщика удостоверений (IdP) с использованием протоколов OIDC/SAML и уникальных соответствий между идентификацией и токеном (без совместно используемых аккаунтов или учетных данных). |   1   | D/V  |
| 5.1.2 | Проверьте, что операции с высоким уровнем риска (развертывание модели, экспорт весов, доступ к обучающим данным, изменения конфигурации в продуктивной среде) требуют многофакторной аутентификации или повышения уровня аутентификации с повторной проверкой сессии.                                       |   1   | D/V  |
| 5.1.3 | Убедитесь, что новые руководители проходят проверку личности, соответствующую стандартам NIST 800-63-3 IAL-2 или эквивалентным, перед получением доступа к производственной системе.                                                                                                                        |   2   |  D   |
| 5.1.4 | Проверьте, чтобы обзоры доступа проводились ежеквартально с автоматическим обнаружением неактивных аккаунтов, обеспечением ротации учетных данных и рабочими процессами деактивации.                                                                                                                        |   2   |  V   |
| 5.1.5 | Проверьте, что федеративные AI-агенты аутентифицируются с помощью подписанных JWT-утверждений, которые имеют максимальный срок действия 24 часа и содержат криптографическое доказательство происхождения.                                                                                                  |   3   | D/V  |

---

## C5.2 Авторизация ресурсов и принцип наименьших привилегий

Реализуйте детализированные меры контроля доступа ко всем AI-ресурсам с явными моделями разрешений и журналами аудита.

|   #   | Description                                                                                                                                                                                                                                                             | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.2.1 | Проверьте, что каждый ИИ-ресурс (наборы данных, модели, конечные точки, векторные коллекции, индексы встраиваний, вычислительные экземпляры) применяет управление доступом на основе ролей с явными списками разрешений и политиками по умолчанию, запрещающими доступ. |   1   | D/V  |
| 5.2.2 | Убедитесь, что принципы наименьших привилегий применяются по умолчанию для сервисных учетных записей, начиная с прав только для чтения, и требуется документальное обоснование для доступа на запись.                                                                   |   1   | D/V  |
| 5.2.3 | Проверьте, что все изменения контроля доступа связаны с одобренными заявками на изменения и неизменно записаны с временными отметками, идентификациями участников, идентификаторами ресурсов и дельтами разрешений.                                                     |   1   |  V   |
| 5.2.4 | Проверьте, что метки классификации данных (PII, PHI, экспорт-контролируемые, собственнические) автоматически распространяются на производные ресурсы (векторные представления, кэши подсказок, выходы моделей) с последовательным применением политики.                 |   2   |  D   |
| 5.2.5 | Проверьте, что попытки несанкционированного доступа и события повышения привилегий вызывают оповещения в реальном времени с контекстными метаданными в системы SIEM в течение 5 минут.                                                                                  |   2   | D/V  |

---

## C5.3 Динамическая оценка политики

Развертывайте движки управления доступом на основе атрибутов (ABAC) для принятия решений об авторизации с учетом контекста и возможностью аудита.

|   #   | Description                                                                                                                                                                                                              | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 5.3.1 | Проверьте, что решения об авторизации вынесены во внешний специализированный движок политик (OPA, Cedar или эквивалент), доступный через аутентифицированные API с защитой целостности с помощью криптографии.           |   1   | D/V  |
| 5.3.2 | Проверьте, что политики оценивают динамические атрибуты во время выполнения, включая уровень допуск пользователя, классификацию чувствительности ресурса, контекст запроса, изоляцию арендатора и временные ограничения. |   1   | D/V  |
| 5.3.3 | Убедитесь, что определения политик находятся под версионным контролем, проходят экспертную оценку и проверяются с помощью автоматизированного тестирования в CI/CD конвейерах перед развертыванием в продуктивной среде. |   2   |  D   |
| 5.3.4 | Проверьте, что результаты оценки политики включают структурированные обоснования решений и передаются в системы SIEM для анализа корреляции и отчетности по соблюдению нормативных требований.                           |   2   |  V   |
| 5.3.5 | Проверьте, что значения времени жизни (TTL) кэша политик не превышают 5 минут для высокочувствительных ресурсов и 1 часа для стандартных ресурсов с возможностями инвалидирования кэша.                                  |   3   | D/V  |

---

## C5.4 Применение мер безопасности во время выполнения запросов

Реализуйте меры безопасности на уровне базы данных с обязательной фильтрацией и политиками безопасности на уровне строк.

|   #   | Description                                                                                                                                                                                                                                             | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.4.1 | Проверьте, что все запросы к векторной базе данных и SQL включают обязательные фильтры безопасности (ID арендатора, метки конфиденциальности, область действия пользователя), которые применяются на уровне движка базы данных, а не в коде приложения. |   1   | D/V  |
| 5.4.2 | Убедитесь, что политики безопасности на уровне строк (RLS) и маскировка на уровне полей включены с наследованием политик для всех векторных баз данных, поисковых индексов и обучающих наборов данных.                                                  |   1   | D/V  |
| 5.4.3 | Проверьте, что неудачные проверки авторизации предотвращают «атаки путаницы доверенного лица» путем немедленной отмены запросов и возврата явных кодов ошибок авторизации вместо возврата пустых наборов результатов.                                   |   2   |  D   |
| 5.4.4 | Проверьте, что задержка оценки политики непрерывно контролируется с использованием автоматических оповещений о случаях таймаута, которые могут привести к обходу авторизации.                                                                           |   2   |  V   |
| 5.4.5 | Убедитесь, что механизмы повторной попытки запросов повторно оценивают политики авторизации с учётом динамических изменений прав доступа в рамках активных пользовательских сессий.                                                                     |   3   | D/V  |

---

## Фильтрация вывода C5.5 и предотвращение потери данных

Внедрите постобработку для предотвращения несанкционированного раскрытия данных в контенте, созданном ИИ.

|   #   | Description                                                                                                                                                                                                         | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.5.1 | Проверьте, что механизмы фильтрации после инференса сканируют и редактируют несанкционированные персональные данные (PII), конфиденциальную информацию и проприетарные данные перед доставкой контента запросчикам. |   1   | D/V  |
| 5.5.2 | Проверяйте, чтобы цитаты, ссылки и указания источников в выводах модели проверялись на соответствие правам вызывающего и удалялись при обнаружении несанкционированного доступа.                                    |   1   | D/V  |
| 5.5.3 | Проверьте, что ограничения формата вывода (очищенные PDF-файлы, изображения без метаданных, утвержденные типы файлов) применяются в зависимости от уровней разрешений пользователей и классификаций данных.         |   2   |  D   |
| 5.5.4 | Убедитесь, что алгоритмы редактирования детерминированы, имеют контроль версий и ведут журналы аудита для поддержки расследований соблюдения нормативных требований и судебного анализа.                            |   2   |  V   |
| 5.5.5 | Проверьте, что события редактирования с высоким уровнем риска генерируют адаптивные журналы, которые включают криптографические хэши исходного содержимого для судебного восстановления без раскрытия данных.       |   3   |  V   |

---

## C5.6 Многоарендная изоляция

Обеспечьте криптографическую и логическую изоляцию между арендаторами в общей инфраструктуре ИИ.

|   #   | Description                                                                                                                                                                                                                   | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.6.1 | Проверьте, что области памяти, хранилища эмбеддингов, записи кеша и временные файлы разделены по пространствам имён для каждого арендатора с обеспечением безопасного удаления при удалении арендатора или завершении сессии. |   1   | D/V  |
| 5.6.2 | Проверьте, что каждый API-запрос включает аутентифицированный идентификатор арендатора, который криптографически проверяется относительно контекста сессии и прав пользователя.                                               |   1   | D/V  |
| 5.6.3 | Проверьте, что сетевые политики реализуют правила по умолчанию, запрещающие коммуникацию между арендаторами в рамках сервисных мешей и платформ оркестрации контейнеров.                                                      |   2   |  D   |
| 5.6.4 | Проверьте, что ключи шифрования уникальны для каждого арендатора при поддержке ключей, управляемых клиентом (CMK), и обеспечивается криптографическая изоляция между хранилищами данных арендаторов.                          |   3   |  D   |

---

## C5.7 Авторизация автономного агента

Управление разрешениями для AI-агентов и автономных систем с помощью токенов возможностей с ограниченным доступом и непрерывной авторизации.

|   #   | Description                                                                                                                                                                                                             | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.7.1 | Убедитесь, что автономные агенты получают ограниченные токены возможностей, которые явно перечисляют разрешённые действия, доступные ресурсы, временные рамки и эксплуатационные ограничения.                           |   1   | D/V  |
| 5.7.2 | Проверьте, что возможности высокого риска (доступ к файловой системе, выполнение кода, вызовы внешних API, финансовые операции) по умолчанию отключены и требуют явного разрешения для активации с бизнес-обоснованием. |   1   | D/V  |
| 5.7.3 | Проверьте, что токены возможностей привязаны к пользовательским сессиям, включают криптографическую защиту целостности и гарантируют, что они не могут быть сохранены или повторно использованы в автономных сценариях. |   2   |  D   |
| 5.7.4 | Проверьте, что действия, инициированные агентом, проходят вторичную авторизацию через механизм политики ABAC с полной оценкой контекста и ведением аудита.                                                              |   2   |  V   |
| 5.7.5 | Проверьте, что условия ошибок агента и обработка исключений включают информацию о пределах возможностей для поддержки анализа инцидентов и судебного расследования.                                                     |   3   |  V   |

---

## Ссылки

### Стандарты и рамки

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### Руководства по внедрению

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### Специфическая безопасность ИИ

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)

