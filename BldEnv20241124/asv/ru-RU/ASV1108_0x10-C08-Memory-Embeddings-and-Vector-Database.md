# Безопасность памяти C8, векторных представлений и векторных баз данных

## Цель управления

Встраивания и векторные хранилища выступают в роли «живой памяти» современных систем искусственного интеллекта, постоянно принимая данные, предоставленные пользователем, и возвращая их в контекст моделей через метод Retrieval-Augmented Generation (RAG). Если такую память не контролировать, она может раскрывать персональные данные (PII), нарушать согласие или быть использована для восстановления исходного текста. Задача данного набора мер — усилить защиту каналов памяти и векторных баз данных, обеспечив минимально необходимый уровень доступа, конфиденциальность встраиваний, автоматическое удаление или отзыв сохранённых векторов по запросу, а также предотвращение смешивания памяти разных пользователей в подсказках или результатах.

---

## C8.1 Контроль доступа к памяти и индексам RAG

Применяйте детализированные механизмы управления доступом для каждой коллекции векторов.

|   #   | Description                                                                                                                                                                                | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 8.1.1 | Проверьте, что правила контроля доступа на уровне строки/пространства имен ограничивают операции вставки, удаления и запроса для каждого арендатора, коллекции или тега документа.         |   1   | D/V  |
| 8.1.2 | Проверьте, что API-ключи или JWT содержат ограниченные права (например, идентификаторы коллекций, глаголы действий) и обновляются не реже чем ежеквартально.                               |   1   | D/V  |
| 8.1.3 | Проверьте, что попытки повышения привилегий (например, запросы на сопоставление похожести между пространствами имён) обнаруживаются и регистрируются в SIEM в течение 5 минут.             |   2   | D/V  |
| 8.1.4 | Проверьте, что база данных векторов ведёт журнал аудита с указанием идентификатора субъекта, операции, идентификатора вектора/пространства имён, порога схожести и количества результатов. |   2   | D/V  |
| 8.1.5 | Проверьте, что решения по доступу проверяются на наличие уязвимостей обхода всякий раз, когда обновляются движки или меняются правила разбиения индекса.                                   |   3   |  V   |

---

## C8.2 Очистка и проверка встраиваемых элементов

Предварительно проверяйте текст на наличие персональных данных (PII), редактируйте или псевдонимизируйте перед векторизацией и при необходимости выполняйте постобработку встраиваний для удаления остаточных сигналов.

|   #   | Description                                                                                                                                                                                                                              | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.2.1 | Проверьте, что персональные идентифицируемые данные (PII) и регулируемые данные обнаруживаются с помощью автоматизированных классификаторов и маскируются, токенизируются или удаляются до этапа встраивания.                            |   1   | D/V  |
| 8.2.2 | Проверьте, что конвейеры встраивания отвергают или изолируют входные данные, содержащие исполняемый код или не являющиеся UTF-8 артефакты, которые могут повредить индекс.                                                               |   1   |  D   |
| 8.2.3 | Проверьте, что к векторным представлениям предложений, расстояние которых до любого известного токена персональных данных (PII) ниже настраиваемого порога, применяется локальная или метрическая дифференциально-приватная санитизация. |   2   | D/V  |
| 8.2.4 | Проверяйте эффективность очистки данных (например, полноту удаления персональной информации, семантическое искажение) не реже одного раза в полгода на основе эталонных корпусов.                                                        |   2   |  V   |
| 8.2.5 | Проверьте, что конфигурации санитации находятся под версионным контролем, а изменения проходят проверку коллегами.                                                                                                                       |   3   | D/V  |

---

## C8.3 Истечение срока действия, отзыв и удаление памяти

Право на забвение в соответствии с GDPR и аналогичные законы требуют своевременного удаления данных; поэтому хранилища векторов должны поддерживать время жизни (TTL), безвозвратное удаление и использование "могильных записей" (tomb-stoning), чтобы отозванные векторы не могли быть восстановлены или повторно проиндексированы.

|   #   | Description                                                                                                                                                                        | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.3.1 | Проверьте, что каждая запись векторных данных и метаданных содержит TTL или явную метку хранения, соблюдаемую автоматизированными задачами очистки.                                |   1   | D/V  |
| 8.3.2 | Проверить, что запросы на удаление, инициированные пользователем, удаляют векторы, метаданные, копии кэша и производные индексы в течение 30 дней.                                 |   1   | D/V  |
| 8.3.3 | Убедитесь, что логическое удаление сопровождается криптографическим уничтожением блоков хранения, если оборудование это поддерживает, либо уничтожением ключа из хранилища ключей. |   2   |  D   |
| 8.3.4 | Проверьте, что устаревшие векторы исключаются из результатов поиска ближайших соседей менее чем через 500 мс после истечения срока действия.                                       |   3   | D/V  |

---

## C8.4 Предотвращение инверсии и утечки встраиваний

Недавние методы защиты — наложение шума, проекционные сети, возмущение нейронов конфиденциальности и шифрование на уровне приложений — могут снизить показатели инверсии на уровне токенов до менее чем 5%.

|   #   | Description                                                                                                                                                                     | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.4.1 | Проверьте, что существует формальная модель угроз, охватывающая атаки на инверсию, установление членства и вывод атрибутов, и что она пересматривается ежегодно.                |   1   |  V   |
| 8.4.2 | Убедитесь, что шифрование на уровне прикладного слоя или поисковое шифрование защищает векторы от прямого чтения администраторами инфраструктуры или персоналом облачных служб. |   2   | D/V  |
| 8.4.3 | Проверьте, что параметры защиты (ε для DP, шум σ, ранг проекции k) обеспечивают баланс между конфиденциальностью ≥ 99 % защиты токенов и полезностью ≤ 3 % потери точности.     |   3   |  V   |
| 8.4.4 | Проверьте, что метрики устойчивости к инверсии включены в критерии выпуска обновлений модели, с определёнными бюджетами регрессии.                                              |   3   | D/V  |

---

## C8.5 Контроль объема памяти, предназначенной для конкретного пользователя

Утечка данных между арендаторами остается одной из основных рисков RAG: неправильно отфильтрованные запросы по схожести могут привести к появлению приватных документов другого клиента.

|   #   | Description                                                                                                                                                                                  | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.5.1 | Проверьте, что каждый запрос на извлечение данных проходит постфильтрацию по идентификатору арендатора/пользователя перед передачей в запрос к LLM.                                          |   1   | D/V  |
| 8.5.2 | Проверьте, что имена коллекций или идентификаторы с пространствами имён засолены для каждого пользователя или арендатора, чтобы векторы не пересекались между областями.                     |   1   |  D   |
| 8.5.3 | Проверьте, что результаты сходства, превышающие настраиваемый порог расстояния, но выходящие за пределы области вызова, отбрасываются и вызывают предупреждения безопасности.                |   2   | D/V  |
| 8.5.4 | Проверьте, что многоарендные стресс-тесты моделируют враждебные запросы, пытающиеся получить доступ к документам за пределами разрешённой области, и демонстрируют отсутствие утечек данных. |   2   |  V   |
| 8.5.5 | Проверьте, что ключи шифрования разделены по арендаторам, обеспечивая криптографическую изоляцию даже при общем физическом хранении.                                                         |   3   | D/V  |

---

## C8.6 Расширенная безопасность системы памяти

Контроль безопасности для сложных архитектур памяти, включая эпизодическую, семантическую и оперативную память, с особыми требованиями к изоляции и проверке.

|   #   | Description                                                                                                                                                                                                                                                        | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 8.6.1 | Проверьте, что различные типы памяти (эпизодическая, семантическая, рабочая) имеют изолированные контексты безопасности с управлением доступом на основе ролей, отдельными ключами шифрования и задокументированными схемами доступа для каждого типа памяти.      |   1   | D/V  |
| 8.6.2 | Проверьте, что процессы консолидации памяти включают проверку безопасности для предотвращения внедрения вредоносных воспоминаний посредством очистки контента, проверки источника и проверки целостности перед сохранением.                                        |   2   | D/V  |
| 8.6.3 | Проверьте, что запросы на извлечение данных из памяти проходят проверку и очистку для предотвращения получения несанкционированной информации путем анализа шаблонов запросов, обеспечения контроля доступа и фильтрации результатов.                              |   2   | D/V  |
| 8.6.4 | Проверяйте, что механизмы забывания в памяти надежно удаляют конфиденциальную информацию с криптографическими гарантиями стирания с помощью удаления ключей, многократного перезаписывания или аппаратного безопасного удаления с сертификатами проверки.          |   3   | D/V  |
| 8.6.5 | Убедитесь, что целостность системы памяти непрерывно контролируется на предмет несанкционированных изменений или повреждений с помощью контрольных сумм, журналов аудита и автоматических оповещений при изменении содержимого памяти вне рамок нормальной работы. |   3   | D/V  |

---

## Ссылки

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)

