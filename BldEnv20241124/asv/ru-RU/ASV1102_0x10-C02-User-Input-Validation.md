# Проверка входных данных пользователя C2

## Цель управления

Надёжная проверка пользовательского ввода является первой линией защиты от некоторых из самых разрушительных атак на системы ИИ. Атаки с внедрением подсказок могут переопределять системные инструкции, раскрывать конфиденциальные данные или направлять модель к недопустимому поведению. Если не используются специализированные фильтры и иерархии инструкций, исследования показывают, что "мультишот" джейлбрейки, эксплуатирующие очень длинные окна контекста, будут эффективны. Кроме того, тонкие атаки с использованием враждебных возмущений — такие как замена гомоглифов или использование «лита» — могут незаметно изменять решения модели.

---

## C2.1 Защита от внедрения запросов

Внедрение подсказок является одним из основных рисков для AI систем. Защита от этой тактики использует комбинацию статических фильтров шаблонов, динамических классификаторов и контроля иерархии инструкций.

|   #   | Description                                                                                                                                                                                                                                                 | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.1.1 | Убедитесь, что пользовательский ввод проверяется на соответствие постоянно обновляемой библиотеке известных шаблонов внедрения запросов (ключевые слова джейлбрейка, "игнорировать предыдущие", цепочки ролевой игры, косвенные HTML/URL-атаки).            |   1   | D/V  |
| 2.1.2 | Проверьте, что система соблюдает иерархию инструкций, в которой сообщения системы или разработчика имеют приоритет над инструкциями пользователя, даже после расширения контекстного окна.                                                                  |   1   | D/V  |
| 2.1.3 | Проверьте, что тесты на адверсариальную оценку (например, многоходовые подсказки Red Team) проводятся перед каждым выпуском модели или шаблона подсказок, с установлением порогов успешности и автоматическими блокировщиками для предотвращения регрессий. |   2   | D/V  |
| 2.1.4 | Проверьте, что запросы, исходящие из стороннего контента (веб-страницы, PDF, электронные письма), проходят обработку очистки в изолированном контекстепарсинга перед их объединением в основной запрос.                                                     |   2   |  D   |
| 2.1.5 | Убедитесь, что все обновления правил фильтрации запросов, версии моделей классификаторов и изменения в блок-листе находятся под версионным контролем и могут быть проверены.                                                                                |   3   | D/V  |

---

## C2.2 Защита от атак с использованием контрпримеров

Модели обработки естественного языка (NLP) все еще уязвимы к неявным возмущениям на уровне символов или слов, которые люди часто не замечают, но которые модели склонны неправильно классифицировать.

|   #   | Description                                                                                                                                                                                                                         | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.2.1 | Убедитесь, что базовые шаги нормализации ввода (Unicode NFC, отображение гомоглифов, обрезка пробелов) выполняются до токенизации.                                                                                                  |   1   |  D   |
| 2.2.2 | Проверьте, что обнаружение статистических аномалий отмечает входные данные с необычно высоким расстоянием редактирования до языковых норм, чрезмерным повторением токенов или аномальными расстояниями в эмбеддингах.               |   2   | D/V  |
| 2.2.3 | Проверьте, что конвейер инференса поддерживает необязательные варианты моделей, закалённых с помощью адверсариального обучения, или защитные слои (например, рандомизацию, защитную дистилляцию) для высокорисковых конечных точек. |   2   |  D   |
| 2.2.4 | Проверяйте, что предполагаемые вредоносные входные данные изолируются, фиксируются с полными полезными нагрузками (после удаления личной идентифицируемой информации).                                                              |   2   |  V   |
| 2.2.5 | Проверьте, что метрики устойчивости (коэффициент успешности известных наборов атак) отслеживаются с течением времени, и регрессии вызывают блокировку выпуска.                                                                      |   3   | D/V  |

---

## C2.3 Проверка схемы, типа и длины

Атаки на ИИ с использованием некорректных или чрезмерно больших входных данных могут вызывать ошибки парсинга, перекрытие подсказок между полями и исчерпание ресурсов. Строгое соблюдение схемы также является обязательным условием при выполнении детерминированных вызовов инструментов.

|   #   | Description                                                                                                                                                                                                     | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.3.1 | Проверьте, что каждая конечная точка вызова API или функции определяет явную схему входных данных (JSON Schema, Protobuf или многомодальный эквивалент) и что входные данные проверяются перед сборкой запроса. |   1   |  D   |
| 2.3.2 | Убедитесь, что входные данные, превышающие максимальные ограничения по токенам или байтам, отклоняются с безопасной ошибкой и никогда не подвергаются молчаливому усечению.                                     |   1   | D/V  |
| 2.3.3 | Проверьте, что проверки типов (например, числовые диапазоны, значения перечислений, MIME-типы для изображений/аудио) выполняются на стороне сервера, а не только в клиентском коде.                             |   2   | D/V  |
| 2.3.4 | Проверьте, что семантические валидаторы (например, JSON Schema) работают за постоянное время, чтобы предотвратить алгоритмические DoS-атаки.                                                                    |   2   |  D   |
| 2.3.5 | Проверьте, что ошибки проверки записываются с отредактированными фрагментами полезной нагрузки и однозначными кодами ошибок для облегчения безопасности триажа.                                                 |   3   |  V   |

---

## C2.4 Контент и проверка политики

Разработчики должны иметь возможность обнаруживать синтаксически корректные запросы, которые содержат запрещённый контент (например, нелегальные инструкции, разжигающую ненависть речь и защищённый авторским правом текст), и предотвращать их распространение.

|   #   | Description                                                                                                                                                                                                                                       | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.4.1 | Проверьте, что классификатор контента (zero shot или с дополнительной настройкой) оценивает каждый ввод на наличие насилия, причинения вреда себе, ненависти, сексуального контента и незаконных запросов с настраиваемыми пороговыми значениями. |   1   |  D   |
| 2.4.2 | Убедитесь, что вводы, нарушающие правила, получают стандартные отказы или безопасные завершения, чтобы они не передавались в последующие вызовы LLM.                                                                                              |   1   | D/V  |
| 2.4.3 | Убедитесь, что модель скрининга или набор правил пересматриваются/обновляются как минимум ежеквартально с учетом недавно обнаруженных схем обхода ограничений или политики.                                                                       |   2   |  D   |
| 2.4.4 | Проверяйте, что скрининг соответствует пользовательским политикам (возрастным, региональным правовым ограничениям) с помощью правил на основе атрибутов, разрешаемых во время запроса.                                                            |   2   |  D   |
| 2.4.5 | Проверьте, что журналы скрининга включают оценки уверенности классификатора и теги категорий политики для корреляции SOC и последующего воспроизведения красной командой.                                                                         |   3   |  V   |

---

## C2.5 Ограничение скорости ввода и предотвращение злоупотреблений

Разработчикам следует предотвращать злоупотребления, исчерпание ресурсов и автоматизированные атаки на ИИ-системы, ограничивая скорость ввода и обнаруживая аномальные модели использования.

|   #   | Description                                                                                                                                                                | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.5.1 | Проверьте, что ограничения скорости по пользователю, по IP-адресу и по ключу API применяются ко всем входным конечным точкам.                                              |   1   | D/V  |
| 2.5.2 | Проверьте, что пороговые значения для пикового и устойчивого ограничения скорости настроены для предотвращения DoS-атак и атак перебором.                                  |   2   | D/V  |
| 2.5.3 | Проверьте, что аномальные модели использования (например, быстрые последовательные запросы, затопление входными данными) вызывают автоматические блокировки или эскалации. |   2   | D/V  |
| 2.5.4 | Проверьте, что журналы предотвращения злоупотреблений сохраняются и просматриваются для выявления новых моделей атак.                                                      |   3   |  V   |

---

## C2.6 Многофункциональная проверка входных данных

AI-системы должны включать надежную проверку нетекстовых входных данных (изображения, аудио, файлы) для предотвращения инъекций, обхода или злоупотребления ресурсами.

|   #   | Description                                                                                                                   | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.6.1 | Убедитесь, что все нетекстовые входные данные (изображения, аудио, файлы) проверены на тип, размер и формат перед обработкой. |   1   |  D   |
| 2.6.2 | Убедитесь, что файлы сканируются на наличие вредоносного ПО и стеганографических нагрузок перед загрузкой.                    |   2   | D/V  |
| 2.6.3 | Проверьте, что входные данные изображения/аудио проверяются на наличие атакующих возмущений или известных шаблонов атак.      |   2   | D/V  |
| 2.6.4 | Проверьте, что ошибки валидации мультимодального ввода регистрируются и вызывают тревоги для проведения расследования.        |   3   |  V   |

---

## C2.7 Происхождение и атрибуция входных данных

Системы ИИ должны поддерживать аудит, отслеживание злоупотреблений и соблюдение требований путем мониторинга и маркировки источников всех входных данных пользователей.

|   #   | Description                                                                                                                                              | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.7.1 | Проверьте, что все пользовательские вводы сопровождаются метаданными (ID пользователя, сессия, источник, временная метка, IP-адрес) при внесении данных. |   1   | D/V  |
| 2.7.2 | Проверьте, что метаданные происхождения сохраняются и подлежат аудиту для всех обработанных входных данных.                                              |   2   | D/V  |
| 2.7.3 | Проверьте, что аномальные или ненадежные источники ввода помечаются и подвергаются усиленному контролю или блокировке.                                   |   2   | D/V  |

---

## C2.8 Адаптивное обнаружение угроз в реальном времени

Разработчикам следует использовать передовые системы обнаружения угроз для ИИ, которые адаптируются к новым типам атак и обеспечивают защиту в режиме реального времени с использованием компилированного сопоставления шаблонов.

|   #   | Description                                                                                                                                                                                               | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.8.1 | Убедитесь, что шаблоны обнаружения угроз скомпилированы в оптимизированные движки регулярных выражений для высокопроизводительной фильтрации в реальном времени с минимальным влиянием на задержку.       |   1   | D/V  |
| 2.8.2 | Проверьте, что системы обнаружения угроз поддерживают отдельные библиотеки шаблонов для различных категорий угроз (внедрение подсказок, вредоносный контент, конфиденциальные данные, системные команды). |   1   | D/V  |
| 2.8.3 | Проверьте, что адаптивное обнаружение угроз включает модели машинного обучения, которые обновляют чувствительность к угрозам на основе частоты атак и уровней их успешности.                              |   2   | D/V  |
| 2.8.4 | Проверьте, что каналы обмена данными о реальных угрозах автоматически обновляют библиотеки шаблонов новыми сигнатурами атак и IOC (индикаторами компрометации).                                           |   2   | D/V  |
| 2.8.5 | Убедитесь, что показатели ложных срабатываний обнаружения угроз постоянно контролируются, а специфичность паттернов автоматически настраивается для минимизации помех легитимным сценариям использования. |   3   | D/V  |
| 2.8.6 | Убедитесь, что контекстный анализ угроз учитывает источник ввода, модели поведения пользователя и историю сессий для повышения точности обнаружения.                                                      |   3   | D/V  |
| 2.8.7 | Убедитесь, что показатели производительности обнаружения угроз (уровень обнаружения, задержка обработки, использование ресурсов) контролируются и оптимизируются в режиме реального времени.              |   3   | D/V  |

---

## C2.9 Многоформатный конвейер проверки безопасности

Разработчики должны обеспечивать проверку безопасности для текстовых, графических, аудио и других модальностей ввода ИИ с использованием определённых типов обнаружения угроз и изоляции ресурсов.

|   #   | Description                                                                                                                                                                                                                                                                                                                | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.9.1 | Проверьте, что для каждой входной модальности существуют выделенные средства проверки безопасности с задокументированными моделями угроз (текст: инъекция в подсказки, изображения: стеганография, аудио: атаки на спектрограмму) и порогами обнаружения.                                                                  |   1   | D/V  |
| 2.9.2 | Убедитесь, что мультимодальные входные данные обрабатываются в изолированных песочницах с определёнными ограничениями ресурсов (память, ЦП, время обработки), специфичными для каждого типа модальности, и эти ограничения задокументированы в политиках безопасности.                                                     |   2   | D/V  |
| 2.9.3 | Проверьте, что обнаружение атак с использованием кросс-модальных методов идентифицирует скоординированные атаки, охватывающие несколько типов входных данных (например, стеганографические нагрузки в изображениях, совмещённые с инъекциями запросов в тексте) с использованием правил корреляции и генерации оповещений. |   2   | D/V  |
| 2.9.4 | Проверьте, что сбои многоаспектной проверки вызывают подробное ведение журналов, включающее все входные модальности, результаты проверки, оценки угроз и корреляционный анализ с использованием структурированных форматов журналов для интеграции с SIEM.                                                                 |   3   | D/V  |
| 2.9.5 | Проверьте, что классификаторы контента, специфичные для каждой модальности, обновляются в соответствии с задокументированными графиками (не реже ежеквартально) с новыми шаблонами угроз, примерами атак и поддерживают показатели производительности выше базовых порогов.                                                |   3   | D/V  |

---

## Ссылки

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)

