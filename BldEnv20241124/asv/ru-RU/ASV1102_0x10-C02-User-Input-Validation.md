# Проверка пользовательского ввода C2

## Цель контроля

Надежная проверка пользовательского ввода является первоочередной защитой от одних из самых опасных атак на системы искусственного интеллекта. Атаки с внедрением подсказок могут переписывать системные инструкции, раскрывать конфиденциальные данные или направлять модель на выполнение запрещенного поведения. Если не использовать специальные фильтры и иерархии инструкций, исследования показывают, что «мульти-шот» jailbreak-атаки, эксплуатирующие очень длинные контекстные окна, будут эффективными. Кроме того, тонкие атаки с использованием враждебных возмущений — такие как замены гомоглифов или «лиспик» (leetspeak) — могут незаметно изменить решения модели.

---

## C2.1 Защита от внедрения подсказок

Внедрение подсказок является одним из основных рисков для ИИ-систем. Защита от этой тактики использует комбинацию статических фильтров по шаблонам, динамических классификаторов и соблюдения иерархии инструкций.

|   #   | Description                                                                                                                                                                                                                                                            | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.1.1 | Проверьте, что пользовательские вводы проверяются на соответствие постоянно обновляемой библиотеке известных шаблонов внедрения подсказок (ключевые слова джейлбрейка, «игнорировать предыдущие», цепочки ролевой игры, косвенные HTML/URL-атаки).                     |   1   | D/V  |
| 2.1.2 | Проверьте, что система поддерживает иерархию инструкций, в которой системные или сообщения разработчика имеют приоритет над пользовательскими инструкциями, даже после расширения окна контекста.                                                                      |   1   | D/V  |
| 2.1.3 | Убедитесь, что тесты с использованием методов противодействия (например, многократные запросы Red Team) проводятся перед каждым выпуском модели или шаблона запроса, с установлением порогов успешности и автоматическими блокировщиками для предотвращения регрессий. |   2   | D/V  |
| 2.1.4 | Проверьте, что подсказки, исходящие из стороннего контента (веб-страницы, PDF, электронная почта), очищаются в изолированном контексте парсинга перед их объединением в основную подсказку.                                                                            |   2   |  D   |
| 2.1.5 | Убедитесь, что все обновления правил фильтрации запросов, версии моделей классификаторов и изменения в черных списках находятся под управлением версий и подлежат аудиту.                                                                                              |   3   | D/V  |

---

## C2.2 Сопротивляемость к примерам-антогонистам

Модели обработки естественного языка (NLP) по-прежнему уязвимы к тонким искажениям на уровне символов или слов, которые люди часто не замечают, но модели склонны классифицировать неправильно.

|   #   | Description                                                                                                                                                                                                                                | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.2.1 | Проверьте, что базовые шаги нормализации входных данных (Unicode NFC, отображение гомоглифов, обрезка пробелов) выполняются до токенизации.                                                                                                |   1   |  D   |
| 2.2.2 | Проверьте, что статистическое обнаружение аномалий отмечает входные данные с необычно большим расстоянием редактирования относительно норм языка, чрезмерным количеством повторяющихся токенов или аномальными расстояниями в эмбеддингах. |   2   | D/V  |
| 2.2.3 | Проверьте, что конвейер вывода поддерживает варианты моделей с опциональной защитой путем обучения с противодействием или защитные слои (например, рандомизация, защитная дистилляция) для высоко рисковых конечных точек.                 |   2   |  D   |
| 2.2.4 | Проверяйте, что подозрительные враждебные входные данные помещаются в карантин и регистрируются с полными нагрузками (после удаления персональных данных).                                                                                 |   2   |  V   |
| 2.2.5 | Убедитесь, что метрики надежности (процент успешных атак из известных наборов) отслеживаются со временем, и регрессии вызывают блокировку выпуска.                                                                                         |   3   | D/V  |

---

## C2.3 Проверка схемы, типа и длины

Атаки на ИИ с использованием искажённых или чрезмерно больших входных данных могут вызвать ошибки разбора, утечку подсказок между полями и истощение ресурсов. Строгое соблюдение схемы также является необходимым условием при выполнении детерминированных вызовов инструментов.

|   #   | Description                                                                                                                                                                                                                           | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.3.1 | Убедитесь, что каждая конечная точка вызова API или функции определяет явную схему входных данных (JSON Schema, Protobuf или эквивалент мультимодального формата) и что входные данные проходят проверку перед формированием запроса. |   1   |  D   |
| 2.3.2 | Проверьте, что вводы, превышающие максимальные ограничения по количеству токенов или байтов, отклоняются с безопасной ошибкой и никогда не обрезаются без уведомления.                                                                |   1   | D/V  |
| 2.3.3 | Убедитесь, что проверки типов (например, числовые диапазоны, значения перечислений, MIME-типы для изображений/аудио) выполняются на стороне сервера, а не только в клиентском коде.                                                   |   2   | D/V  |
| 2.3.4 | Убедитесь, что семантические валидаторы (например, JSON Schema) выполняются за постоянное время, чтобы предотвратить алгоритмические атаки типа отказ в обслуживании (DoS).                                                           |   2   |  D   |
| 2.3.5 | Проверьте, что ошибки валидации регистрируются с отредактированными фрагментами полезной нагрузки и однозначными кодами ошибок для облегчения процедуры анализа безопасности.                                                         |   3   |  V   |

---

## C2.4 Контент и проверка политики

Разработчики должны иметь возможность обнаруживать синтаксически корректные запросы, которые содержат запрещённый контент (например, незаконные инструкции, речь ненависти и защищённые авторским правом тексты), и предотвращать их распространение.

|   #   | Description                                                                                                                                                                                                                        | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.4.1 | Проверьте, что классификатор контента (ноль выстрелов или дообученный) оценивает каждый ввод на предмет насилия, самоповреждения, ненависти, сексуального содержания и незаконных запросов с настраиваемыми пороговыми значениями. |   1   |  D   |
| 2.4.2 | Проверьте, что входные данные, нарушающие политики, будут получать стандартизированные отказы или безопасные завершения, чтобы они не распространялись на последующие вызовы больших языковых моделей (LLM).                       |   1   | D/V  |
| 2.4.3 | Убедитесь, что модель скрининга или набор правил проходят повторное обучение/обновление не реже одного раза в квартал, включая недавно обнаруженные схемы обхода защит или нарушений политики.                                     |   2   |  D   |
| 2.4.4 | Проверять, что скрининг соответствует пользовательским политикам (возрастным, региональным правовым ограничениям) с помощью правил, основанных на атрибутах, которые разрешаются во время запроса.                                 |   2   |  D   |
| 2.4.5 | Убедитесь, что журналы скрининга содержат оценки уверенности классификатора и теги категорий политики для корреляции SOC и последующего воспроизведения красной командой.                                                          |   3   |  V   |

---

## C2.5 Ограничение скорости ввода данных и предотвращение злоупотреблений

Разработчики должны предотвращать злоупотребления, истощение ресурсов и автоматизированные атаки на системы ИИ путем ограничения скорости ввода и обнаружения аномальных моделей использования.

|   #   | Description                                                                                                                                                       | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.5.1 | Проверьте, что ограничения скорости запросов по пользователю, по IP-адресу и по API-ключу применяются ко всем входным конечным точкам.                            |   1   | D/V  |
| 2.5.2 | Проверьте, что пределы скорости для всплесков и постоянной нагрузки настроены таким образом, чтобы предотвращать DoS-атаки и атаки перебором.                     |   2   | D/V  |
| 2.5.3 | Проверьте, что аномальные шаблоны использования (например, стремительные запросы, переполнение вводимых данных) вызывают автоматические блокировки или эскалации. |   2   | D/V  |
| 2.5.4 | Проверьте, что журналы предотвращения злоупотреблений сохраняются и анализируются на предмет выявления новых схем атак.                                           |   3   |  V   |

---

## C2.6 Мультимодальная проверка входных данных

Системы искусственного интеллекта должны включать надежную проверку нетекстовых входных данных (изображений, аудио, файлов) для предотвращения инъекций, обхода защиты или злоупотребления ресурсами.

|   #   | Description                                                                                                                                   | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.6.1 | Проверяйте, чтобы все не текстовые входные данные (изображения, аудио, файлы) проходили проверку по типу, размеру и формату перед обработкой. |   1   |  D   |
| 2.6.2 | Проверьте, что файлы сканируются на наличие вредоносного ПО и стеганографических нагрузок перед загрузкой.                                    |   2   | D/V  |
| 2.6.3 | Проверьте, что входные данные изображения/аудио проверены на наличие враждебных искажений или известных шаблонов атак.                        |   2   | D/V  |
| 2.6.4 | Проверьте, что сбои проверки входных данных в мультимодальном режиме фиксируются в журналах и вызывают оповещения для расследования.          |   3   |  V   |

---

## C2.7 Происхождение и атрибуция входных данных

Системы ИИ должны поддерживать аудит, отслеживание злоупотреблений и соблюдение требований путем мониторинга и маркировки источников всех пользовательских вводов.

|   #   | Description                                                                                                                                            | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.7.1 | Проверьте, что все пользовательские входные данные помечены метаданными (ID пользователя, сеанс, источник, временная метка, IP-адрес) при поступлении. |   1   | D/V  |
| 2.7.2 | Проверьте, что метаданные происхождения сохраняются и доступны для аудита для всех обработанных входных данных.                                        |   2   | D/V  |
| 2.7.3 | Убедитесь, что аномальные или ненадежные источники ввода помечаются и подвергаются усиленному контролю или блокируются.                                |   2   | D/V  |

---

## C2.8 Адаптивное обнаружение угроз в реальном времени

Разработчикам следует использовать продвинутые системы обнаружения угроз для искусственного интеллекта, которые адаптируются к новым паттернам атак и обеспечивают защиту в реальном времени с помощью скомпилированного сопоставления шаблонов.

|   #   | Description                                                                                                                                                                                                   | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.8.1 | Проверьте, что шаблоны обнаружения угроз скомпилированы в оптимизированные движки регулярных выражений для высокопроизводительной фильтрации в реальном времени с минимальным воздействием на задержку.       |   1   | D/V  |
| 2.8.2 | Убедитесь, что системы обнаружения угроз поддерживают отдельные библиотеки шаблонов для различных категорий угроз (внедрение подсказок, вредоносный контент, конфиденциальные данные, системные команды).     |   1   | D/V  |
| 2.8.3 | Убедитесь, что система адаптивного обнаружения угроз включает модели машинного обучения, которые обновляют чувствительность к угрозам на основе частоты атак и уровней их успешности.                         |   2   | D/V  |
| 2.8.4 | Проверьте, что потоки угроз в реальном времени автоматически обновляют библиотеки шаблонов новыми сигнатурами атак и IOC (индикаторами компрометации).                                                        |   2   | D/V  |
| 2.8.5 | Убедитесь, что уровни ложных срабатываний при обнаружении угроз постоянно контролируются, а специфичность шаблонов автоматически настраивается для минимизации вмешательства в законные случаи использования. |   3   | D/V  |
| 2.8.6 | Проверьте, что контекстный анализ угроз учитывает источник ввода, модели поведения пользователя и историю сессии для повышения точности обнаружения.                                                          |   3   | D/V  |
| 2.8.7 | Убедитесь, что показатели эффективности обнаружения угроз (коэффициент обнаружения, задержка обработки, использование ресурсов) контролируются и оптимизируются в режиме реального времени.                   |   3   | D/V  |

---

## C2.9 Много-модальная конвейерная проверка безопасности

Разработчики должны обеспечить проверку безопасности для текстовых, графических, аудиовходных и других модальностей ИИ с использованием специализированных методов обнаружения угроз и изоляции ресурсов.

|   #   | Description                                                                                                                                                                                                                                                                                                            | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.9.1 | Проверьте, что у каждой входной модальности есть выделенные средства безопасности с задокументированными шаблонами угроз (текст: инъекция подсказок, изображения: стеганография, аудио: атаки на спектрограмму) и установленными порогами обнаружения.                                                                 |   1   | D/V  |
| 2.9.2 | Проверьте, что мультимодальные входные данные обрабатываются в изолированных песочницах с определёнными лимитами ресурсов (памяти, CPU, времени обработки), специфичными для каждого типа модальности, и задокументированными в политиках безопасности.                                                                |   2   | D/V  |
| 2.9.3 | Проверьте, что обнаружение атак с несколькими модальностями идентифицирует скоординированные атаки, охватывающие несколько типов входных данных (например, стеганографические полезные нагрузки в изображениях в сочетании с инъекцией подсказок в тексте), с использованием правил корреляции и генерации оповещений. |   2   | D/V  |
| 2.9.4 | Проверьте, что сбои мультимодальной валидации вызывают подробное ведение журналов, включая все входные модальности, результаты валидации, оценки угроз и корреляционный анализ с использованием структурированных форматов журналов для интеграции с SIEM.                                                             |   3   | D/V  |
| 2.9.5 | Проверьте, что классификаторы содержимого, специфичные для модальностей, обновляются в соответствии с задокументированными графиками (минимум ежеквартально) новыми шаблонами угроз, примерами атак и эталонными показателями производительности, поддерживаемыми выше базовых порогов.                                |   3   | D/V  |

---

## Список литературы

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)

