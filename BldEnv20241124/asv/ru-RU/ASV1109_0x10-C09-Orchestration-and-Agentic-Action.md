# 9 Автономная оркестрация и агентное действие безопасности

## Цель управления

Обеспечьте, чтобы автономные или многоагентные системы ИИ могли выполнять только те действия, которые явно предусмотрены, аутентифицированы, подлежат аудиту и находятся в пределах установленных ограничений по затратам и рискам. Это защищает от угроз, таких как компрометация автономной системы, неправильное использование инструментов, обнаружение цикла агента, перехват коммуникаций, подделка идентичности, манипуляция роем и манипуляция намерениями.

---

## 9.1 Бюджеты планирования задач агента и рекурсии

Ограничивайте рекурсивные планы и требуйте контроль со стороны человека для привилегированных действий.

|   #   | Description                                                                                                                                                                                               | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.1.1 | Убедитесь, что максимальная глубина рекурсии, ширина, реальное время выполнения, количество токенов и денежные затраты на выполнение агента централизованно настроены и находятся под управлением версий. |   1   | D/V  |
| 9.1.2 | Проверьте, что привилегированные или необратимые действия (например, коммиты кода, финансовые переводы) требуют явного одобрения человеком через поддающийся аудиту канал перед выполнением.              |   1   | D/V  |
| 9.1.3 | Проверьте, что мониторы ресурсов в реальном времени запускают прерывание срабатывания прерывателя цепи при превышении любого порогового значения бюджета, останавливая дальнейшее расширение задач.       |   2   |  D   |
| 9.1.4 | Проверьте, что события срабатывания автоматического выключателя фиксируются с идентификатором агента, условием срабатывания и зафиксированным состоянием плана для последующего судебного анализа.        |   2   | D/V  |
| 9.1.5 | Проверьте, что тесты безопасности охватывают сценарии исчерпания бюджета и неконтролируемого выполнения плана, гарантируя безопасное завершение без потери данных.                                        |   3   |  V   |
| 9.1.6 | Убедитесь, что бюджетные политики выражены в виде политики-кода и реализуются в CI/CD для предотвращения дрейфа конфигураций.                                                                             |   3   |  D   |

---

## 9.2 Песочница для плагинов инструментов

Изолируйте взаимодействия с инструментами, чтобы предотвратить несанкционированный доступ к системе или выполнение кода.

|   #   | Description                                                                                                                                                                                                  | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 9.2.1 | Убедитесь, что каждый инструмент/плагин выполняется внутри операционной системы, контейнера или песочницы уровня WASM с минимально необходимыми привилегиями для файловой системы, сети и системных вызовов. |   1   | D/V  |
| 9.2.2 | Проверьте, что квоты ресурсов песочницы (ЦПУ, память, диск, исходящий сетевой трафик) и тайм-ауты выполнения соблюдаются и фиксируются в журнале.                                                            |   1   | D/V  |
| 9.2.3 | Проверьте, что бинарные файлы или дескрипторы инструментов имеют цифровую подпись; подписи проверяются перед загрузкой.                                                                                      |   2   | D/V  |
| 9.2.4 | Проверьте, что телеметрия песочницы передается в SIEM; аномалии (например, попытки исходящих подключений) вызывают оповещения.                                                                               |   2   |  V   |
| 9.2.5 | Убедитесь, что высокорисковые плагины проходят проверку безопасности и тестирование на проникновение перед развертыванием в производственной среде.                                                          |   3   |  V   |
| 9.2.6 | Убедитесь, что попытки выхода из песочницы автоматически блокируются, а нарушающий плагин помещается в карантин до проведения расследования.                                                                 |   3   | D/V  |

---

## 9.3 Автономная петля и ограничение затрат

Обнаружение и предотвращение неконтролируемой рекурсии между агентами и взрывного роста затрат.

|   #   | Description                                                                                                                                            | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 9.3.1 | Проверьте, что межагентные вызовы включают ограничение числа переходов (hop-limit) или TTL, которое среда выполнения уменьшает и контролирует.         |   1   | D/V  |
| 9.3.2 | Проверьте, что агенты поддерживают уникальный идентификатор графа вызовов для обнаружения самовызова или циклических шаблонов.                         |   2   |  D   |
| 9.3.3 | Проверьте, что суммарные счётчики вычислительных единиц и затрат отслеживаются для каждой цепочки запросов; при превышении лимита цепочка прерывается. |   2   | D/V  |
| 9.3.4 | Проверьте, что формальный анализ или проверка моделей подтверждают отсутствие неограниченной рекурсии в протоколах агента.                             |   3   |  V   |
| 9.3.5 | Проверьте, что события прерывания цикла генерируют оповещения и передают метрики непрерывного улучшения.                                               |   3   |  D   |

---

## 9.4 Защита от неправильного использования на уровне протокола

Обеспечьте защищённые коммуникационные каналы между агентами и внешними системами для предотвращения захвата управления или манипуляций.

|   #   | Description                                                                                                                                                                             | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.4.1 | Убедитесь, что все сообщения между агентом и инструментом, а также между агентами, проходят аутентификацию (например, с помощью взаимного TLS или JWT) и защищены сквозным шифрованием. |   1   | D/V  |
| 9.4.2 | Проверьте, что схемы строго валидируются; неизвестные поля или некорректные сообщения отвергаются.                                                                                      |   1   |  D   |
| 9.4.3 | Убедитесь, что проверки целостности (MAC или цифровые подписи) охватывают весь полезный нагрузку сообщения, включая параметры инструмента.                                              |   2   | D/V  |
| 9.4.4 | Убедитесь, что защита от повторного воспроизведения (nonce или временные окна) реализована на уровне протокола.                                                                         |   2   |  D   |
| 9.4.5 | Убедитесь, что реализации протоколов проходят фуззинг и статический анализ на наличие уязвимостей, связанных с инъекцией или десериализацией.                                           |   3   |  V   |

---

## 9.5 Идентификация агента и защита от подделки

Обеспечьте возможность установления ответственных за действия и обнаружения изменений.

|   #   | Description                                                                                                                                       | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.5.1 | Проверьте, что каждый экземпляр агента обладает уникальной криптографической идентичностью (пара ключей или аппаратно защищённый учетный данные). |   1   | D/V  |
| 9.5.2 | Проверьте, что все действия агента подписаны и имеют отметку времени; логи содержат подпись для обеспечения неотказуемости.                       |   2   | D/V  |
| 9.5.3 | Убедитесь, что журналы с защитой от подделки хранятся в среде только для добавления или записи один раз.                                          |   2   |  V   |
| 9.5.4 | Проверьте, что ключи идентификации вращаются по заданному расписанию и при появлении признаков компрометации.                                     |   3   |  D   |
| 9.5.5 | Проверьте, что попытки подделки или конфликта ключей вызывают немедленную изоляцию затронутого агента.                                            |   3   | D/V  |

---

## 9.6 Снижение риска с помощью многоагентного роя

Снижайте риски, связанные с коллективным поведением, через изоляцию и формальное моделирование безопасности.

|   #   | Description                                                                                                                                                       | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.6.1 | Убедитесь, что агенты, работающие в различных доменах безопасности, выполняются в изолированных средах выполнения или сетевых сегментах.                          |   1   | D/V  |
| 9.6.2 | Убедитесь, что поведение роя смоделировано и формально проверено на живучесть и безопасность до развертывания.                                                    |   3   |  V   |
| 9.6.3 | Проверьте, что мониторы времени выполнения обнаруживают возникающие опасные паттерны (например, колебания, взаимные блокировки) и инициируют корректирующие меры. |   3   |  D   |

---

## 9.7 Аутентификация / Авторизация пользователя и инструмента

Реализуйте надежные механизмы контроля доступа для каждого действия, вызванного агентом.

|   #   | Description                                                                                                                                                                             | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.7.1 | Проверяйте, что агенты аутентифицируются как полноценные субъекты (first-class principals) для подчинённых систем, никогда не повторно используя учетные данные конечных пользователей. |   1   | D/V  |
| 9.7.2 | Проверьте, что политики точечной авторизации ограничивают, какие инструменты агент может вызывать и какие параметры он может указывать.                                                 |   2   |  D   |
| 9.7.3 | Проверьте, что проверки привилегий выполняются повторно при каждом вызове (непрерывная авторизация), а не только при начале сессии.                                                     |   2   |  V   |
| 9.7.4 | Проверьте, что делегированные привилегии автоматически истекают и требуют повторного согласия после истечения времени действия или изменения области.                                   |   3   |  D   |

---

## 9.8 Безопасность взаимодействия агентов

Шифруйте и обеспечьте защиту целостности всех сообщений между агентами, чтобы предотвратить перехват и подделку.

|   #   | Description                                                                                                                                        | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.8.1 | Убедитесь, что взаимная аутентификация и шифрование с совершенной прямой секретностью (например, TLS 1.3) обязательны для каналов агента.          |   1   | D/V  |
| 9.8.2 | Проверяйте целостность и происхождение сообщения перед обработкой; при сбоях генерируются предупреждения и сообщение отбрасывается.                |   1   |  D   |
| 9.8.3 | Проверьте, что метаданные коммуникации (метки времени, номера последовательности) записываются для поддержки судебного восстановления.             |   2   | D/V  |
| 9.8.4 | Проверьте, что формальная верификация или моделирование подтверждают невозможность перевода конечных автоматов протокола в небезопасные состояния. |   3   |  V   |

---

## 9.9 Проверка намерений и обеспечение соблюдения ограничений

Проверьте, что действия агента соответствуют заявленному намерению пользователя и системным ограничениям.

|   #   | Description                                                                                                                                                                                                         | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.9.1 | Проверьте, что решатели ограничений на этапе предварительного выполнения проверяют предлагаемые действия на соответствие жестко заданным правилам безопасности и политики.                                          |   1   |  D   |
| 9.9.2 | Проверьте, что действия с высоким уровнем воздействия (финансовые, разрушительные, связанные с конфиденциальностью) требуют явного подтверждения намерения со стороны инициирующего пользователя.                   |   2   | D/V  |
| 9.9.3 | Проверьте, что проверки постусловий подтверждают, что выполненные действия достигли предполагаемых эффектов без побочных эффектов; несоответствия вызывают откат.                                                   |   2   |  V   |
| 9.9.4 | Проверьте, что формальные методы (например, автоматическая проверка моделей, доказательство теорем) или тесты, основанные на свойствах, демонстрируют, что планы агента удовлетворяют всем заявленным ограничениям. |   3   |  V   |
| 9.9.5 | Проверьте, что инциденты с несоответствием намерений или нарушением ограничений способствуют циклам непрерывного улучшения и обмену разведданными об угрозах.                                                       |   3   |  D   |

---

## 9.10 Безопасность стратегии рассуждения агента

Безопасный выбор и выполнение различных стратегий рассуждения, включая подходы ReAct, Chain-of-Thought и Tree-of-Thoughts.

|   #    | Description                                                                                                                                                                                                                                                                                              | Level | Role |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.10.1 | Проверьте, что выбор стратегии рассуждения использует детерминированные критерии (сложность входных данных, тип задачи, контекст безопасности), и одинаковые входные данные приводят к одинаковому выбору стратегии в рамках одного и того же контекста безопасности.                                    |   1   | D/V  |
| 9.10.2 | Убедитесь, что у каждой стратегии рассуждения (ReAct, Chain-of-Thought, Tree-of-Thoughts) есть специализированная проверка входных данных, очистка выходных данных и установленные лимиты времени выполнения, соответствующие её когнитивному подходу.                                                   |   1   | D/V  |
| 9.10.3 | Проверьте, что переходы стратегии рассуждения регистрируются с полным контекстом, включая характеристики входных данных, значения критериев выбора и метаданные выполнения для восстановления аудиторского следа.                                                                                        |   2   | D/V  |
| 9.10.4 | Убедитесь, что метод рассуждения Tree-of-Thoughts включает механизмы отсечения ветвей, которые прекращают исследование при обнаружении нарушений политики, ограничений ресурсов или границ безопасности.                                                                                                 |   2   | D/V  |
| 9.10.5 | Проверьте, что циклы ReAct (Reason-Act-Observe) включают контрольные точки валидации на каждом этапе: проверку шага рассуждения, авторизацию действия и очистку наблюдений перед продолжением.                                                                                                           |   2   | D/V  |
| 9.10.6 | Проверьте, что метрики производительности стратегии рассуждения (время выполнения, использование ресурсов, качество вывода) отслеживаются с помощью автоматических оповещений при отклонении метрик за пределы настроенных порогов.                                                                      |   3   | D/V  |
| 9.10.7 | Проверьте, что гибридные методы рассуждений, комбинирующие несколько стратегий, сохраняют проверку входных данных и ограничения выхода всех составляющих стратегий без обхода каких-либо механизмов безопасности.                                                                                        |   3   | D/V  |
| 9.10.8 | Проверьте, что тестирование безопасности стратегии рассуждений включает фуззинг с неправильными входными данными, приводящие к ошибкам запросы (adversarial prompts), разработанные для принудительного переключения стратегии, а также тестирование граничных условий для каждого когнитивного подхода. |   3   | D/V  |

---

## 9.11 Управление состояниями жизненного цикла агента и безопасность

Безопасная инициализация агента, переходы состояний и завершение работы с криптографическими журналами аудита и определёнными процедурами восстановления.

|   #    | Description                                                                                                                                                                                                                                                                                    | Level | Role |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.11.1 | Проверьте, что инициализация агента включает установление криптографической идентичности с использованием аппаратно-защищённых учетных данных и неизменяемые журналы аудита запуска, содержащие идентификатор агента, временную метку, хеш конфигурации и параметры инициализации.             |   1   | D/V  |
| 9.11.2 | Проверьте, что переходы состояний агента криптографически подписаны, имеют отметки времени и записаны с полным контекстом, включая вызывающие события, хэш предыдущего состояния, хэш нового состояния и выполненные проверки безопасности.                                                    |   2   | D/V  |
| 9.11.3 | Проверьте, что процедуры завершения работы агента включают безопасное стирание памяти с использованием криптографического удаления или многоразового перезаписывания, отзывание учетных данных с уведомлением центра сертификации и генерацию сертификатов завершения, защищенных от подделки. |   2   | D/V  |
| 9.11.4 | Проверьте, что механизмы восстановления агента проверяют целостность состояния с помощью криптографических контрольных сумм (минимум SHA-256) и откатываются к известным корректным состояниям при обнаружении повреждений с автоматическими оповещениями и требованиями ручного одобрения.    |   3   | D/V  |
| 9.11.5 | Проверьте, что механизмы сохранения состояния агента шифруют конфиденциальные данные с использованием уникальных для каждого агента ключей AES-256 и реализуют безопасную ротацию ключей по настраиваемому расписанию (максимум 90 дней) с развертыванием без простоев.                        |   3   | D/V  |

---

## 9.12 Рамки безопасности интеграции инструментов

Контроль безопасности для динамической загрузки инструментов, их выполнения и проверки результатов с определенными процессами оценки рисков и утверждения.

|   #    | Description                                                                                                                                                                                                                                                                                          | Level | Role |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.12.1 | Проверьте, что дескрипторы инструментов включают метаданные безопасности, указывающие требуемые привилегии (чтение/запись/выполнение), уровни риска (низкий/средний/высокий), ограничения ресурсов (ЦПУ, память, сеть) и требования к валидации, задокументированные в манифестах инструментов.      |   1   | D/V  |
| 9.12.2 | Проверьте, что результаты выполнения инструмента проверяются на соответствие ожидаемым схемам (JSON Schema, XML Schema) и политикам безопасности (очистка вывода, классификация данных) перед интеграцией с учетом ограничений по времени выполнения и процедур обработки ошибок.                    |   1   | D/V  |
| 9.12.3 | Проверить, что журналы взаимодействия инструментов включают подробный контекст безопасности, включая использование привилегий, шаблоны доступа к данным, время выполнения, потребление ресурсов и коды возврата с использованием структурированного логирования для интеграции с SIEM.               |   2   | D/V  |
| 9.12.4 | Проверьте, что механизмы динамической загрузки инструментов проверяют цифровые подписи с использованием инфраструктуры PKI и реализуют безопасные протоколы загрузки с изоляцией в песочнице и проверкой разрешений перед выполнением.                                                               |   2   | D/V  |
| 9.12.5 | Проверьте, что оценки безопасности инструмента автоматически запускаются для новых версий с обязательными контрольными точками утверждения, включая статический анализ, динамическое тестирование и проверку командой безопасности с документированными критериями утверждения и требованиями к SLA. |   3   | D/V  |

---

### Ссылки

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)

