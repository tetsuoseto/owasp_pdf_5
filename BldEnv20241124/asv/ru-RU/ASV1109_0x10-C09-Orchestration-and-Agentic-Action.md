# 9 Автономная оркестровка и агентное действие безопасности

## Целевой показатель контроля

Обеспечьте, чтобы автономные или многоагентные системы ИИ могли выполнять только те действия, которые явно предусмотрены, аутентифицированы, подлежат аудиту и находятся в пределах заданных ограничений по стоимости и рискам. Это защищает от угроз, таких как компрометация автономной системы, неправильное использование инструментов, обнаружение циклов агента, перехват коммуникаций, подделка идентичности, манипулирование роями и искажение намерений.

---

## 9.1 Планирование задач агента и бюджет рекурсии

Ограничьте рекурсивные планы и устанавливайте контрольные точки с участием человека для привилегированных действий.

|   #   | Description                                                                                                                                                                                                  | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 9.1.1 | Проверьте, что максимальная глубина рекурсии, ширина, время по часам, количество токенов и денежные затраты на выполнение агента централизованно настроены и контролируются версионно.                       |   1   | D/V  |
| 9.1.2 | Проверьте, что привилегированные или необратимые действия (например, коммиты кода, финансовые переводы) требуют явного одобрения человеком через контролируемый канал перед выполнением.                     |   1   | D/V  |
| 9.1.3 | Проверьте, что мониторы ресурсов в реальном времени вызывают прерывание сработки прерывания цепи (circuit-breaker), когда превышается любой из порогов бюджета, приостанавливая дальнейшее расширение задач. |   2   |  D   |
| 9.1.4 | Проверьте, что события срабатывания автоматического выключателя фиксируются с идентификатором агента, условием срабатывания и захваченным состоянием плана для проведения судебного анализа.                 |   2   | D/V  |
| 9.1.5 | Проверьте, что тесты безопасности охватывают сценарии исчерпания бюджета и бесконтрольного выполнения плана, подтверждая безопасную остановку без потери данных.                                             |   3   |  V   |
| 9.1.6 | Убедитесь, что бюджетные политики выражены в виде политики как кода (policy-as-code) и применяются в CI/CD для блокировки отклонений конфигурации.                                                           |   3   |  D   |

---

## 9.2 Изоляция плагинов инструментов

Изолируйте взаимодействия с инструментами, чтобы предотвратить несанкционированный доступ к системе или выполнение кода.

|   #   | Description                                                                                                                                                                                                             | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.2.1 | Проверьте, что каждый инструмент/плагин выполняется внутри операционной системы, контейнера или песочницы на уровне WASM с политиками минимально необходимых привилегий для файловой системы, сети и системных вызовов. |   1   | D/V  |
| 9.2.2 | Проверьте, что квоты ресурсов песочницы (ЦПУ, память, диск, исходящий сетевой трафик) и тайм-ауты выполнения соблюдаются и регистрируются.                                                                              |   1   | D/V  |
| 9.2.3 | Проверяйте, что бинарные файлы или дескрипторы инструментов имеют цифровую подпись; подписи проверяются перед загрузкой.                                                                                                |   2   | D/V  |
| 9.2.4 | Проверьте, что телеметрия песочницы передается в SIEM; аномалии (например, попытки исходящих подключений) вызывают оповещения.                                                                                          |   2   |  V   |
| 9.2.5 | Убедитесь, что плагины с высоким уровнем риска проходят проверку безопасности и тестирование на проникновение перед развертыванием в производство.                                                                      |   3   |  V   |
| 9.2.6 | Проверьте, что попытки выхода из песочницы автоматически блокируются, а нарушающий плагин помещается в карантин до проведения расследования.                                                                            |   3   | D/V  |

---

## 9.3 Автономная петля и ограничение стоимости

Обнаруживайте и останавливайте неконтролируемую рекурсию между агентами и взрыв роста затрат.

|   #   | Description                                                                                                                                                            | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.3.1 | Проверьте, что межагентные вызовы включают ограничение по количеству переходов (hop-limit) или время жизни (TTL), которое среда выполнения уменьшается и контролирует. |   1   | D/V  |
| 9.3.2 | Убедитесь, что агенты поддерживают уникальный идентификатор графа вызовов для обнаружения самовызовов или циклических шаблонов.                                        |   2   |  D   |
| 9.3.3 | Проверьте, что суммарные счетчики вычислительных единиц и расходов отслеживаются для каждой цепочки запросов; при превышении лимита цепочка прерывается.               |   2   | D/V  |
| 9.3.4 | Проверьте, что формальный анализ или проверка моделей демонстрируют отсутствие неограниченной рекурсии в протоколах агентов.                                           |   3   |  V   |
| 9.3.5 | Проверьте, что события прерывания цикла генерируют оповещения и обеспечивают метрики непрерывного улучшения.                                                           |   3   |  D   |

---

## 9.4 Защита от неправильного использования на уровне протокола

Обеспечение защищённых каналов связи между агентами и внешними системами для предотвращения перехвата или манипуляций.

|   #   | Description                                                                                                                                                                  | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.4.1 | Проверьте, что все сообщения между агентом и инструментом, а также между агентами, проходят аутентификацию (например, взаимная TLS или JWT) и защищены сквозным шифрованием. |   1   | D/V  |
| 9.4.2 | Проверьте, что схемы строго валидируются; неизвестные поля или неправильно сформированные сообщения отклоняются.                                                             |   1   |  D   |
| 9.4.3 | Проверьте, что проверки целостности (MAC или цифровые подписи) охватывают весь полезный нагрузку сообщения, включая параметры инструмента.                                   |   2   | D/V  |
| 9.4.4 | Убедитесь, что защита от повторного воспроизведения (использование nonce или временных окон) реализована на уровне протокола.                                                |   2   |  D   |
| 9.4.5 | Проверьте, что реализации протоколов проходят фуззинг и статический анализ на наличие уязвимостей инъекций или десериализации.                                               |   3   |  V   |

---

## 9.5 Идентификация агента и защита от подделки

Обеспечьте возможность идентификации действий и обнаружения изменений.

|   #   | Description                                                                                                                                     | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.5.1 | Проверьте, что каждый экземпляр агента имеет уникальную криптографическую идентичность (ключевую пару или аппаратно защищенный учетные данные). |   1   | D/V  |
| 9.5.2 | Проверьте, что все действия агента подписаны и имеют отметку времени; журналы содержат подпись для обеспечения неотказуемости.                  |   2   | D/V  |
| 9.5.3 | Проверьте, что журналы с защитой от подделки хранятся в среде с возможностью только добавления или однократной записи.                          |   2   |  V   |
| 9.5.4 | Проверьте, что ключи идентификации меняются по установленному графику и при обнаружении признаков компрометации.                                |   3   |  D   |
| 9.5.5 | Проверьте, что попытки спуфинга или конфликта ключей вызывают немедленную изоляцию подверженного агента.                                        |   3   | D/V  |

---

## 9.6 Снижение рисков с помощью роя многоагентных систем

Снизьте риски, связанные с коллективным поведением, посредством изоляции и формального моделирования безопасности.

|   #   | Description                                                                                                                                                               | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.6.1 | Проверьте, что агенты, работающие в разных доменах безопасности, выполняются в изолированных средах выполнения или сетевых сегментах.                                     |   1   | D/V  |
| 9.6.2 | Убедитесь, что поведения роя смоделированы и формально проверены на живучесть и безопасность перед развертыванием.                                                        |   3   |  V   |
| 9.6.3 | Проверьте, что мониторы времени выполнения обнаруживают возникающие небезопасные шаблоны (например, колебания, взаимные блокировки) и инициируют корректирующие действия. |   3   |  D   |

---

## 9.7 Аутентификация и авторизация пользователей и инструментов

Реализуйте надежные механизмы контроля доступа для каждого действия, инициируемого агентом.

|   #   | Description                                                                                                                                                               | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.7.1 | Проверяйте, что агенты проходят аутентификацию как первоклассные субъекты в системах нижнего уровня, никогда не повторно используя учетные данные конечных пользователей. |   1   | D/V  |
| 9.7.2 | Убедитесь, что политики тонкой настройки авторизации ограничивают, какие инструменты агент может вызывать и какие параметры он может использовать.                        |   2   |  D   |
| 9.7.3 | Проверьте, что проверки привилегий выполняются повторно при каждом вызове (непрерывная авторизация), а не только в начале сессии.                                         |   2   |  V   |
| 9.7.4 | Проверьте, что делегированные привилегии автоматически истекают и требуют повторного согласия после истечения времени или изменения области действия.                     |   3   |  D   |

---

## 9.8 Безопасность коммуникации между агентами

Зашифруйте и обеспечьте целостность всех сообщений между агентами, чтобы предотвратить подслушивание и подделку.

|   #   | Description                                                                                                                                                 | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.8.1 | Проверьте, что взаимная аутентификация и шифрование с защитой от раскрытия прошлых сессий (например, TLS 1.3) обязательны для агентных каналов.             |   1   | D/V  |
| 9.8.2 | Проверяйте целостность и подлинность сообщения перед обработкой; в случае ошибок генерируются предупреждения, и сообщение отбрасывается.                    |   1   |  D   |
| 9.8.3 | Проверьте, что метаданные коммуникации (отметки времени, номера последовательности) регистрируются для поддержки судебного восстановления.                  |   2   | D/V  |
| 9.8.4 | Проверьте, что формальная верификация или модельная проверка подтверждают, что машины состояний протокола не могут быть приведены в небезопасные состояния. |   3   |  V   |

---

## 9.9 Проверка намерений и обеспечение соблюдения ограничений

Проверьте, что действия агента соответствуют заявленному намерению пользователя и системным ограничениям.

|   #   | Description                                                                                                                                                                                  | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.9.1 | Проверьте, что решатели ограничений перед выполнением проверяют предлагаемые действия на соответствие жестко заданным правилам безопасности и политики.                                      |   1   |  D   |
| 9.9.2 | Проверьте, что действия с высоким воздействием (финансовые, разрушительные, затрагивающие конфиденциальность) требуют явного подтверждения намерения от инициирующего пользователя.          |   2   | D/V  |
| 9.9.3 | Проверьте, что проверки постусловий подтверждают, что выполненные действия достигли запланированных результатов без побочных эффектов; при расхождениях инициируется откат.                  |   2   |  V   |
| 9.9.4 | Проверьте, что формальные методы (например, проверка моделей, доказательство теорем) или тесты на основе свойств демонстрируют, что планы агента удовлетворяют всем заявленным ограничениям. |   3   |  V   |
| 9.9.5 | Убедитесь, что инциденты несоответствия намерений или нарушения ограничений используются для циклов непрерывного совершенствования и обмена разведданными об угрозах.                        |   3   |  D   |

---

## 9.10 Стратегия рассуждения агента и безопасность

Безопасный выбор и выполнение различных стратегий рассуждения, включая подходы ReAct, цепочку рассуждений (Chain-of-Thought) и дерево рассуждений (Tree-of-Thoughts).

|   #    | Description                                                                                                                                                                                                                                                                            | Level | Role |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.10.1 | Проверьте, что выбор стратегии рассуждения использует детерминированные критерии (сложность входных данных, тип задачи, контекст безопасности), и что при одинаковых входных данных в рамках одного и того же контекста безопасности выбираются идентичные стратегии.                  |   1   | D/V  |
| 9.10.2 | Убедитесь, что каждая стратегия рассуждения (ReAct, Цепочка размышлений, Древо размышлений) имеет специализированную проверку входных данных, очистку выходных данных и ограничения времени выполнения, соответствующие её когнитивному подходу.                                       |   1   | D/V  |
| 9.10.3 | Проверьте, что переходы стратегии рассуждения фиксируются с полным контекстом, включая характеристики входных данных, значения критериев выбора и метаданные выполнения для восстановления аудиторского следа.                                                                         |   2   | D/V  |
| 9.10.4 | Проверьте, что в рассуждениях Tree-of-Thoughts присутствуют механизмы отсечения ветвей, которые прекращают исследование при обнаружении нарушений политики, ограничения ресурсов или границ безопасности.                                                                              |   2   | D/V  |
| 9.10.5 | Проверьте, что циклы ReAct (Reason-Act-Observe) включают контрольные точки проверки на каждом этапе: верификацию шага рассуждения, авторизацию действия и очистку наблюдения перед продолжением.                                                                                       |   2   | D/V  |
| 9.10.6 | Проверьте, что показатели производительности стратегии рассуждений (время выполнения, использование ресурсов, качество вывода) контролируются с помощью автоматических оповещений при отклонении значений за пределы заданных порогов.                                                 |   3   | D/V  |
| 9.10.7 | Проверьте, что гибридные методы рассуждений, сочетающие несколько стратегий, сохраняют проверку входных данных и ограничения на выходные данные всех составляющих стратегий без обхода каких-либо средств обеспечения безопасности.                                                    |   3   | D/V  |
| 9.10.8 | Проверьте, что тестирование безопасности стратегий рассуждения включает фаззинг с некорректными входными данными, атаки с помощью враждебных запросов, направленных на принудительное переключение стратегии, а также тестирование граничных условий для каждого когнитивного подхода. |   3   | D/V  |

---

## 9.11 Управление состоянием жизненного цикла агента и безопасность

Безопасная инициализация агента, переходы состояний и завершение работы с криптографическими аудиториями и определёнными процедурами восстановления.

|   #    | Description                                                                                                                                                                                                                                                                                                   | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.11.1 | Проверьте, что инициализация агента включает установление криптографической идентичности с аппаратно защищёнными учётными данными и неизменяемыми журналами аудита запуска, содержащими идентификатор агента, временную метку, хеш конфигурации и параметры инициализации.                                    |   1   | D/V  |
| 9.11.2 | Проверьте, что переходы состояний агента криптографически подписаны, имеют временную метку и регистрируются с полным контекстом, включая вызывающие события, хэш предыдущего состояния, хэш нового состояния и выполненные проверки безопасности.                                                             |   2   | D/V  |
| 9.11.3 | Проверьте, что процедуры завершения работы агента включают безопасное стирание памяти с использованием криптографического удаления или многократного перезаписывания, отзыв учетных данных с уведомлением центра сертификации, а также генерацию защитных от подделки сертификатов о завершении работы.       |   2   | D/V  |
| 9.11.4 | Проверить, что механизмы восстановления агента подтверждают целостность состояния с использованием криптографических контрольных сумм (минимум SHA-256) и выполняют откат к состояниям с известной корректностью при обнаружении повреждений с автоматическими оповещениями и требованиями ручного одобрения. |   3   | D/V  |
| 9.11.5 | Проверьте, что механизмы сохранения состояния агента шифруют чувствительные данные состояния с использованием уникальных для каждого агента ключей AES-256 и реализуют безопасную ротацию ключей по настраиваемому графику (максимум 90 дней) с обеспечением развертывания без простоя.                       |   3   | D/V  |

---

## 9.12 Рамки безопасности интеграции инструментов

Управление безопасностью при динамической загрузке инструментов, их выполнении и проверке результатов с определённой оценкой рисков и процессами утверждения.

|   #    | Description                                                                                                                                                                                                                                                                                      | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 9.12.1 | Проверьте, что дескрипторы инструментов включают метаданные безопасности, указывающие необходимые привилегии (чтение/запись/выполнение), уровни риска (низкий/средний/высокий), ограничения ресурсов (ЦПУ, память, сеть) и требования к проверке, задокументированные в манифестах инструментов. |   1   | D/V  |
| 9.12.2 | Проверьте, что результаты выполнения инструментов проверяются на соответствие ожидаемым схемам (JSON Schema, XML Schema) и политикам безопасности (санитизация вывода, классификация данных) перед интеграцией с ограничениями по времени и процедурами обработки ошибок.                        |   1   | D/V  |
| 9.12.3 | Проверьте, что журналы взаимодействия с инструментом включают подробный контекст безопасности, включая использование привилегий, шаблоны доступа к данным, время выполнения, потребление ресурсов и коды возврата с структурированным ведением журналов для интеграции с SIEM.                   |   2   | D/V  |
| 9.12.4 | Проверьте, что механизмы динамической загрузки инструментов проходят проверку цифровых подписей с использованием инфраструктуры PKI и реализуют безопасные протоколы загрузки с изоляцией в песочнице и проверкой разрешений перед выполнением.                                                  |   2   | D/V  |
| 9.12.5 | Убедитесь, что проверки безопасности инструментов автоматически запускаются для новых версий с обязательными этапами одобрения, включая статический анализ, динамическое тестирование и обзор командой безопасности с задокументированными критериями одобрения и требованиями к SLA.            |   3   | D/V  |

---

### Ссылки

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)

