# C12 Мониторинг, Логирование и Обнаружение Аномалий

## Цель управления

Этот раздел содержит требования для обеспечения работы в режиме реального времени и проведения судебного анализа, позволяющие получить обзор того, что модель и другие компоненты ИИ видят, делают и возвращают, чтобы можно было обнаруживать, классифицировать и изучать угрозы.

## C12.1 Логирование запросов и ответов

|   #    | Description                                                                                                                                                                                                                                                        | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 12.1.1 | Убедитесь, что все запросы пользователей и ответы модели фиксируются с соответствующими метаданными (например, временная метка, идентификатор пользователя, идентификатор сессии, версия модели).                                                                  |   1   | D/V  |
| 12.1.2 | Убедитесь, что журналы хранятся в защищённых репозиториях с контролем доступа, соответствующими политиками хранения и процедурами резервного копирования.                                                                                                          |   1   | D/V  |
| 12.1.3 | Убедитесь, что системы хранения журналов реализуют шифрование данных в состоянии покоя и при передаче для защиты конфиденциальной информации, содержащейся в журналах.                                                                                             |   1   | D/V  |
| 12.1.4 | Убедитесь, что конфиденциальные данные в запросах и ответах автоматически скрываются или маскируются перед записью в журнал, с настраиваемыми правилами редактирования для личной идентифицируемой информации (PII), учетных данных и конфиденциальной информации. |   1   | D/V  |
| 12.1.5 | Убедитесь, что решения по политике и действия по фильтрации безопасности регистрируются с достаточной детализацией для обеспечения аудита и отладки систем модерации контента.                                                                                     |   2   | D/V  |
| 12.1.6 | Проверьте, что целостность журналов защищена, например, посредством криптографических подписей или хранилища с доступом только для записи.                                                                                                                         |   2   | D/V  |

---

## C12.2 Обнаружение злоупотреблений и оповещение

|   #    | Description                                                                                                                                                                                                                                               | Level | Role |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.2.1 | Проверьте, что система обнаруживает и оповещает о известных схемах обхода ограничений (jailbreak), попытках внедрения подсказок (prompt injection) и враждебных входных данных с использованием обнаружения на основе сигнатур.                           |   1   | D/V  |
| 12.2.2 | Проверьте, что система интегрируется с существующими платформами управления информацией о безопасности и управления событиями (SIEM) с использованием стандартных форматов журналов и протоколов.                                                         |   1   | D/V  |
| 12.2.3 | Проверьте, что обогащенные события безопасности включают специфический для ИИ контекст, такой как идентификаторы моделей, оценки уверенности и решения фильтров безопасности.                                                                             |   2   | D/V  |
| 12.2.4 | Проверьте, что обнаружение аномалий в поведении выявляет необычные модели общения, чрезмерные попытки повторов или систематические поисковые действия.                                                                                                    |   2   | D/V  |
| 12.2.5 | Проверьте, что механизмы оповещения в режиме реального времени уведомляют команды безопасности при обнаружении потенциальных нарушений политики или попыток атаки.                                                                                        |   2   | D/V  |
| 12.2.6 | Проверьте, что включены пользовательские правила для обнаружения специфических угроз, связанных с ИИ, включая скоординированные попытки обхода ограничений (jailbreak), кампании по внедрению подсказок (prompt injection) и атаки на извлечение моделей. |   2   | D/V  |
| 12.2.7 | Проверьте, что автоматизированные рабочие процессы реакций на инциденты могут изолировать скомпрометированные модели, блокировать злоумышленников и повышать уровень критических событий безопасности.                                                    |   3   | D/V  |

---

## C12.3 Обнаружение дрейфа модели

|   #    | Description                                                                                                                                                                                             | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.3.1 | Проверьте, что система отслеживает основные показатели производительности, такие как точность, уровни уверенности, задержка и частота ошибок для разных версий модели и периодов времени.               |   1   | D/V  |
| 12.3.2 | Проверьте, что автоматическое оповещение срабатывает, когда показатели производительности превышают заранее определённые пороговые значения деградации или значительно отклоняются от базовых значений. |   2   | D/V  |
| 12.3.3 | Проверьте, что системы обнаружения галлюцинаций выявляют и помечают случаи, когда выводы модели содержат фактически неверную, непоследовательную или вымышленную информацию.                            |   2   | D/V  |

---

## C12.4 Телеметрия производительности и поведения

|   #    | Description                                                                                                                                                                   | Level | Role |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.4.1 | Убедитесь, что операционные метрики, включая задержку запросов, потребление токенов, использование памяти и пропускную способность, непрерывно собираются и контролируются.   |   1   | D/V  |
| 12.4.2 | Проверьте, что уровни успеха и неудачи отслеживаются с категоризацией типов ошибок и их коренных причин.                                                                      |   1   | D/V  |
| 12.4.3 | Проверьте, что мониторинг использования ресурсов включает использование GPU/CPU, потребление памяти и требования к хранению с оповещениями при превышении пороговых значений. |   2   | D/V  |

---

## C12.5 Планирование и выполнение реагирования на инциденты с ИИ

|   #    | Description                                                                                                                                                                               | Level | Role |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.5.1 | Проверьте, что планы реагирования на инциденты специально охватывают события, связанные с безопасностью ИИ, включая компрометацию модели, отравление данных и атаки злоумышленников.      |   1   | D/V  |
| 12.5.2 | Убедитесь, что команды реагирования на инциденты имеют доступ к специализированным для ИИ судебным инструментам и экспертным знаниям для расследования поведения моделей и векторов атак. |   2   | D/V  |
| 12.5.3 | Убедитесь, что анализ после инцидента включает рассмотрение повторного обучения модели, обновления фильтров безопасности и интеграцию извлечённых уроков в контрольные меры безопасности. |   3   | D/V  |

---

## C12.5 Обнаружение ухудшения производительности ИИ

Отслеживать и обнаруживать ухудшение производительности и качества ИИ-модели с течением времени.

|   #    | Description                                                                                                                                                    | Level | Role |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.5.1 | Убедитесь, что точность модели, точность (precision), полнота (recall) и F1-метрики постоянно контролируются и сравниваются с базовыми пороговыми значениями.  |   1   | D/V  |
| 12.5.2 | Проверьте, что обнаружение дрейфа данных контролирует изменения распределения входных данных, которые могут повлиять на производительность модели.             |   1   | D/V  |
| 12.5.3 | Проверьте, что обнаружение дрейфа концепции выявляет изменения во взаимосвязи между входными данными и ожидаемыми результатами.                                |   2   | D/V  |
| 12.5.4 | Проверьте, что ухудшение производительности вызывает автоматические оповещения и запускает процессы повторного обучения или замены модели.                     |   2   | D/V  |
| 12.5.5 | Проверьте, что анализ основных причин деградации связывает снижение производительности с изменениями данных, проблемами инфраструктуры или внешними факторами. |   3   |  V   |

---

## C12.6 Визуализация DAG и безопасность рабочего процесса

Защитите системы визуализации рабочих процессов от утечки информации и атак на манипуляцию.

|   #    | Description                                                                                                                                                                                                      | Level | Role |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.6.1 | Проверьте, что данные визуализации DAG очищены от конфиденциальной информации перед сохранением или передачей.                                                                                                   |   1   | D/V  |
| 12.6.2 | Проверьте, что средства управления доступом к визуализации рабочих процессов обеспечивают просмотр путей принятия решений агентом и трассировок рассуждений только авторизованными пользователями.               |   1   | D/V  |
| 12.6.3 | Проверьте, что целостность данных в DAG защищена с помощью криптографических подписей и механизмов хранения с защитой от подделки.                                                                               |   2   | D/V  |
| 12.6.4 | Проверьте, что системы визуализации рабочих процессов реализуют проверку входных данных для предотвращения инъекционных атак через специально созданные данные узлов или ребер.                                  |   2   | D/V  |
| 12.6.5 | Проверьте, что обновления направленного ацикличного графа (DAG) в режиме реального времени ограничены по частоте и проходят валидацию для предотвращения атак типа отказ в обслуживании на системы визуализации. |   3   | D/V  |

---

## C12.7 Проактивный мониторинг поведения безопасности

Обнаружение и предотвращение угроз безопасности через проактивный анализ поведения агентов.

|   #    | Description                                                                                                                                            | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 12.7.1 | Проверяйте, что проактивное поведение агентов проходит проверку безопасности до выполнения с интеграцией оценки риска.                                 |   1   | D/V  |
| 12.7.2 | Проверьте, что триггеры автономной инициативы включают оценку контекста безопасности и анализ ландшафта угроз.                                         |   2   | D/V  |
| 12.7.3 | Проверьте, что проактивные модели поведения анализируются на предмет возможных последствий для безопасности и непреднамеренных эффектов.               |   2   | D/V  |
| 12.7.4 | Убедитесь, что проактивные действия, критичные для безопасности, требуют явного утверждения с цепочками одобрения и журналами аудита.                  |   3   | D/V  |
| 12.7.5 | Проверьте, что обнаружение поведенческих аномалий выявляет отклонения в шаблонах работы проактивного агента, которые могут указывать на компрометацию. |   3   | D/V  |

---

## Список литературы

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)

