# C12 Мониторинг, журналирование и обнаружение аномалий

## Цель контроля

В этом разделе изложены требования к обеспечению в реальном времени и судебной видимости того, что модель и другие компоненты ИИ видят, делают и возвращают, чтобы можно было обнаруживать, классифицировать и анализировать угрозы.

## C12.1 Логирование запросов и ответов

|   #    | Description                                                                                                                                                                                                                                      | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 12.1.1 | Убедитесь, что все запросы пользователей и ответы модели регистрируются с соответствующими метаданными (например, метка времени, идентификатор пользователя, идентификатор сессии, версия модели).                                               |   1   | D/V  |
| 12.1.2 | Убедитесь, что журналы хранятся в безопасных, контролируемых по доступу репозиториях с соответствующими политиками хранения и процедурами резервного копирования.                                                                                |   1   | D/V  |
| 12.1.3 | Убедитесь, что системы хранения журналов реализуют шифрование данных в состоянии покоя и при передаче, чтобы защитить содержащуюся в журналах конфиденциальную информацию.                                                                       |   1   | D/V  |
| 12.1.4 | Проверьте, что конфиденциальные данные в запросах и ответах автоматически редактируются или маскируются перед записью в журнал, с настраиваемыми правилами редактирования для персональных данных, учетных данных и конфиденциальной информации. |   1   | D/V  |
| 12.1.5 | Проверьте, что решения по политике и действия по фильтрации безопасности записываются с достаточной детализацией для обеспечения аудита и отладки систем модерации контента.                                                                     |   2   | D/V  |
| 12.1.6 | Проверьте, что целостность журналов защищена, например, с помощью криптографических подписей или хранилища с возможностью только записи.                                                                                                         |   2   | D/V  |

---

## C12.2 Обнаружение злоупотреблений и оповещение

|   #    | Description                                                                                                                                                                                                       | Level | Role |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.2.1 | Проверьте, что система обнаруживает и предупреждает о известных шаблонах взлома, попытках внедрения подсказок и враждебных вводах с использованием детекции на основе сигнатур.                                   |   1   | D/V  |
| 12.2.2 | Проверьте, что система интегрируется с существующими платформами управления информацией безопасности и событиями (SIEM) с использованием стандартных форматов журналов и протоколов.                              |   1   | D/V  |
| 12.2.3 | Проверьте, что обогащенные события безопасности включают ИИ-специфический контекст, такой как идентификаторы моделей, оценки уверенности и решения фильтра безопасности.                                          |   2   | D/V  |
| 12.2.4 | Проверьте, что обнаружение поведенческих аномалий выявляет необычные шаблоны общения, чрезмерное количество повторных попыток или систематическое исследование поведения.                                         |   2   | D/V  |
| 12.2.5 | Проверьте, что механизмы оповещения в реальном времени уведомляют команды безопасности при обнаружении потенциальных нарушений политики или попыток атаки.                                                        |   2   | D/V  |
| 12.2.6 | Проверьте, что включены пользовательские правила для обнаружения специфических для ИИ паттернов угроз, включая скоординированные попытки взлома, кампании по внедрению подсказок и атаки на извлечение модели.    |   2   | D/V  |
| 12.2.7 | Проверьте, что автоматизированные рабочие процессы реагирования на инциденты могут изолировать скомпрометированные модели, блокировать вредоносных пользователей и эскалировать критические события безопасности. |   3   | D/V  |

---

## C12.3 Обнаружение дрейфа модели

|   #    | Description                                                                                                                                                                             | Level | Role |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.3.1 | Проверьте, что система отслеживает базовые показатели производительности, такие как точность, оценки доверия, задержка и уровень ошибок, по версиям моделей и временным периодам.       |   1   | D/V  |
| 12.3.2 | Проверьте, что автоматические оповещения срабатывают, когда показатели производительности превышают заранее заданные пороги деградации или значительно отклоняются от базовых значений. |   2   | D/V  |
| 12.3.3 | Проверьте, что мониторы обнаружения галлюцинаций выявляют и отмечают случаи, когда выводы модели содержат фактически неверную, несогласованную или вымышленную информацию.              |   2   | D/V  |

---

## C12.4 Телеметрия производительности и поведения

|   #    | Description                                                                                                                                                                     | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.4.1 | Убедитесь, что операционные метрики, включая задержку запросов, потребление токенов, использование памяти и пропускную способность, непрерывно собираются и контролируются.     |   1   | D/V  |
| 12.4.2 | Проверьте, что показатели успеха и неудач отслеживаются с категоризацией типов ошибок и их коренных причин.                                                                     |   1   | D/V  |
| 12.4.3 | Проверьте, что мониторинг использования ресурсов включает использование GPU/CPU, потребление памяти и требования к хранилищу с уведомлениями при превышении пороговых значений. |   2   | D/V  |

---

## C12.5 Планирование и выполнение реагирования на инциденты с искусственным интеллектом

|   #    | Description                                                                                                                                                                                        | Level | Role |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.5.1 | Убедитесь, что планы реагирования на инциденты специально охватывают события безопасности, связанные с ИИ, включая компрометацию моделей, отравление данных и атаки противника.                    |   1   | D/V  |
| 12.5.2 | Убедитесь, что команды реагирования на инциденты имеют доступ к специализированным судебно-техническим инструментам и экспертизе в области ИИ для расследования поведения моделей и векторов атак. |   2   | D/V  |
| 12.5.3 | Убедитесь, что анализ после инцидента включает рассмотрение переобучения модели, обновления фильтров безопасности и интеграцию извлечённых уроков в меры безопасности.                             |   3   | D/V  |

---

## C12.5 Обнаружение снижения производительности ИИ

Отслеживать и обнаруживать снижение производительности и качества модели ИИ с течением времени.

|   #    | Description                                                                                                                                                   | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.5.1 | Убедитесь, что точность модели, точность (precision), полнота (recall) и F1-метрика постоянно контролируются и сравниваются с базовыми пороговыми значениями. |   1   | D/V  |
| 12.5.2 | Проверьте, что обнаружение смещения данных контролирует изменения распределения входных данных, которые могут повлиять на производительность модели.          |   1   | D/V  |
| 12.5.3 | Проверьте, что обнаружение дрейфа концепции выявляет изменения во взаимосвязи между входными данными и ожидаемыми результатами.                               |   2   | D/V  |
| 12.5.4 | Проверьте, что снижение производительности вызывает автоматические уведомления и запускает процессы повторного обучения или замены модели.                    |   2   | D/V  |
| 12.5.5 | Убедитесь, что анализ первопричин деградации связывает снижение производительности с изменениями данных, проблемами инфраструктуры или внешними факторами.    |   3   |  V   |

---

## C12.6 Визуализация DAG и безопасность рабочих процессов

Защищайте системы визуализации рабочих процессов от утечки информации и атак на манипулирование.

|   #    | Description                                                                                                                                                                                             | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.6.1 | Проверьте, что данные визуализации DAG очищены от конфиденциальной информации перед их хранением или передачей.                                                                                         |   1   | D/V  |
| 12.6.2 | Проверьте, что средства контроля доступа к визуализации рабочих процессов обеспечивают возможность просмотра путей принятия решений агентом и следов рассуждений только авторизованными пользователями. |   1   | D/V  |
| 12.6.3 | Проверьте, что целостность данных DAG защищена с помощью криптографических подписей и механизмов хранения с обнаружением изменений.                                                                     |   2   | D/V  |
| 12.6.4 | Проверьте, что системы визуализации рабочих процессов реализуют проверку входных данных для предотвращения атак внедрения через специально сформированные данные узлов или ребер.                       |   2   | D/V  |
| 12.6.5 | Убедитесь, что обновления DAG в реальном времени имеют ограничение частоты и проходят проверку для предотвращения атак типа отказ в обслуживании на системы визуализации.                               |   3   | D/V  |

---

## C12.7 Проактивный мониторинг поведения в области безопасности

Обнаружение и предотвращение угроз безопасности с помощью проактивного анализа поведения агента.

|   #    | Description                                                                                                                                      | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 12.7.1 | Проверяйте, чтобы проактивные поведения агентов были проверены с точки зрения безопасности перед выполнением с интеграцией оценки рисков.        |   1   | D/V  |
| 12.7.2 | Проверьте, что инициирующие события автономной инициативы включают оценку контекста безопасности и анализ угроз.                                 |   2   | D/V  |
| 12.7.3 | Проверять, что проактивные поведенческие модели анализируются на предмет потенциальных последствий для безопасности и непреднамеренных эффектов. |   2   | D/V  |
| 12.7.4 | Проверьте, что критически важные для безопасности упреждающие действия требуют явных цепочек одобрения с аудитом.                                |   3   | D/V  |
| 12.7.5 | Проверьте, что обнаружение поведенческих аномалий выявляет отклонения в паттернах проактивного агента, которые могут указывать на компрометацию. |   3   | D/V  |

---

## Ссылки

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)

