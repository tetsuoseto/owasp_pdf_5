# امنیت حافظه C8، تعبیه‌ها و پایگاه داده برداری

## هدف کنترل

تعبیه‌ها و پایگاه‌های داده برداری به‌عنوان "حافظه زنده" سیستم‌های هوش مصنوعی معاصر عمل می‌کنند، به‌طور مداوم داده‌های ارائه‌شده توسط کاربر را دریافت کرده و از طریق تولید تقویت‌شده با بازیابی (RAG) آن‌ها را به زمینه‌های مدل بازمی‌گردانند. اگر این حافظه به‌درستی مدیریت نشود، ممکن است اطلاعات شناسایی شخصی (PII) را فاش کند، حقوق موافقت را نقض نماید یا به‌طور معکوس متن اصلی را بازسازی کند. هدف این مجموعه کنترل‌ها سخت‌کردن خطوط لوله حافظه و پایگاه‌های داده برداری است تا دسترسی با حداقل امتیاز باشد، تعبیه‌ها حفظ حریم خصوصی را تضمین کنند، بردارهای ذخیره‌شده منقضی شده یا طبق درخواست لغو شوند، و حافظه هر کاربر هرگز ورودی‌ها یا خروجی‌های سایر کاربران را آلوده نکند.

---

## C8.1 کنترل‌های دسترسی بر حافظه و شاخص‌های RAG

اجرای کنترل‌های دسترسی دقیق روی هر مجموعه برداری.

|   #   | Description                                                                                                                                                                         | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.1.1 | تأیید کنید که قوانین کنترل دسترسی در سطح ردیف/فضا نام به عملیات درج، حذف و پرس‌وجو بر اساس مستأجر، مجموعه، یا برچسب سند محدودیت اعمال کند.                                          |   1   | D/V  |
| 8.1.2 | اطمینان حاصل کنید که کلیدهای API یا JWT شامل اعلامیه‌های محدوده‌دار (مثلاً شناسه‌های مجموعه، افعال عملیاتی) هستند و حداقل هر سه ماه یکبار تغییر می‌کنند.                            |   1   | D/V  |
| 8.1.3 | اطمینان حاصل کنید که تلاش‌های افزایش امتیاز (مانند کوئری‌های شباهت بین فضاهای نام مختلف) شناسایی شده و در عرض ۵ دقیقه به سیستم مدیریت اطلاعات و رویدادهای امنیتی (SIEM) گزارش شوند. |   2   | D/V  |
| 8.1.4 | تأیید کنید که پایگاه داده برداری سوابق ممیزی شامل شناسه موضوع، عملیات، شناسه بردار/فضای نام، آستانه شباهت و تعداد نتایج را ثبت می‌کند.                                              |   2   | D/V  |
| 8.1.5 | اطمینان حاصل کنید که تصمیمات دسترسی هرگاه موتور‌ها به‌روزرسانی می‌شوند یا قوانین تقسیم‌بندی ایندکس تغییر می‌کنند، برای نقص‌های دورزدن آزمایش شوند.                                  |   3   |  V   |

---

## C8.2 پاک‌سازی و اعتبارسنجی جاسازی‌ها

متن را برای اطلاعات شناسایی شخصی (PII) پیش‌بررسی کنید، قبل از بردارسازی سیاه یا تغییر نام آن، و به طور اختیاری پس از پردازش تعبیه‌ها برای حذف سیگنال‌های باقی‌مانده اقدام کنید.

|   #   | Description                                                                                                                                                                                  | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.2.1 | تأیید کنید که داده‌های PII و داده‌های تنظیم‌شده از طریق طبقه‌بندی‌کننده‌های خودکار شناسایی شده و قبل از تعبیه، ماسک‌گذاری، توکنیزه یا حذف شده‌اند.                                           |   1   | D/V  |
| 8.2.2 | تأیید کنید که خطوط لوله تعبیه، ورودی‌هایی که حاوی کد اجرایی یا آثار غیر UTF-8 هستند و ممکن است ایندکس را آلوده کنند، رد یا قرنطینه می‌کنند.                                                  |   1   |  D   |
| 8.2.3 | تأیید کنید که پاک‌سازی حریم خصوصی تفاضلی محلی یا متریکی روی جاسازی‌های جمله اعمال شده است که فاصله آن‌ها تا هر توکن شناسایی اطلاعات شخصی (PII) شناخته شده کمتر از آستانه قابل پیکربندی باشد. |   2   | D/V  |
| 8.2.4 | اطمینان حاصل کنید که اثربخشی پاک‌سازی (مثلاً بازیابی اطلاعات شناسایی شخصی حذف‌شده، تغییر معنایی) حداقل هر شش ماه یک‌بار با استفاده از مجموعه‌های مرجع معتبر تایید شود.                       |   2   |  V   |
| 8.2.5 | تأیید کنید که پیکربندی‌های پاکسازی کنترل نسخه شده‌اند و تغییرات تحت بازبینی همتایان قرار می‌گیرند.                                                                                           |   3   | D/V  |

---

## C8.3 منقضی شدن حافظه، لغو و حذف

قانون GDPR "حق فراموش شدن" و قوانین مشابه نیازمند پاک‌سازی به موقع هستند؛ بنابراین فروشگاه‌های برداری باید از TTL‌ها، حذف‌های سخت و تدفین‌سازی پشتیبانی کنند تا بردارهای لغو شده قابل بازیابی یا نمایه‌سازی مجدد نباشند.

|   #   | Description                                                                                                                                                        | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 8.3.1 | اطمینان حاصل کنید که هر بردار و رکورد متادیتا دارای یک TTL یا برچسب نگهداری صریح است که توسط کارهای پاک‌سازی خودکار رعایت می‌شود.                                  |   1   | D/V  |
| 8.3.2 | تأیید کنید که درخواست‌های حذف آغاز شده توسط کاربر، وکتورها، فراداده‌ها، نسخه‌های کش شده و شاخص‌های مشتق شده را ظرف 30 روز پاک می‌کنند.                             |   1   | D/V  |
| 8.3.3 | اطمینان حاصل کنید که حذف‌های منطقی با پاک‌سازی رمزنگاری شده بلاک‌های ذخیره‌سازی در صورت پشتیبانی سخت‌افزار دنبال می‌شوند، یا با نابودی کلیدهای موجود در مخزن کلید. |   2   |  D   |
| 8.3.4 | تأیید کنید که وکتورهای منقضی شده کمتر از 500 میلی‌ثانیه پس از انقضا از نتایج جستجوی نزدیک‌ترین همسایه حذف می‌شوند.                                                 |   3   | D/V  |

---

## C8.4 جلوگیری از معکوس‌سازی و نشت جاسازی

دفاع‌های اخیر—هم‌افزایی نویز، شبکه‌های پروجکشن، تغییرات نورون‌های حریم خصوصی، و رمزنگاری لایه برنامه—می‌توانند نرخ معکوس‌سازی در سطح توکن را به زیر ۵٪ کاهش دهند.

|   #   | Description                                                                                                                                         | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.4.1 | تأیید کنید که یک مدل تهدید رسمی که شامل حملات وارونگی، عضویت و استنتاج ویژگی‌ها باشد، وجود دارد و سالانه بازبینی می‌شود.                            |   1   |  V   |
| 8.4.2 | تأیید کنید که رمزنگاری در لایه برنامه یا رمزنگاری قابل جستجو، بردارها را از خوانش مستقیم توسط مدیران زیرساخت یا کارکنان ابر محافظت می‌کند.          |   2   | D/V  |
| 8.4.3 | تأیید کنید که پارامترهای دفاعی (ε برای DP، نویز σ، رتبه پروژه k) تعادل حفظ حریم خصوصی ≥ ۹۹٪ حفاظت از توکن و کارایی ≤ ۳٪ کاهش دقت را برقرار می‌کنند. |   3   |  V   |
| 8.4.4 | اطمینان حاصل کنید که معیارهای مقاومت در برابر معکوس شدن، بخشی از موانع انتشار برای به‌روزرسانی‌های مدل هستند و بودجه‌های رگرسیون مشخص شده‌اند.      |   3   | D/V  |

---

## اجرای حوزه C8.5 برای حافظه خاص کاربر

نشت اطلاعات میان مستاجران مختلف همچنان یکی از بزرگترین ریسک‌های RAG است: جستجوهای شباهتی که به درستی فیلتر نشده‌اند می‌توانند مدارک خصوصی مشتری دیگر را نمایان کنند.

|   #   | Description                                                                                                                                                                   | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.5.1 | تأیید کنید که هر پرس و جوی بازیابی قبل از ارسال به پرامپت LLM، توسط شناسه مستاجر/کاربر پس‌فیلتر می‌شود.                                                                       |   1   | D/V  |
| 8.5.2 | تأیید کنید که نام‌های مجموعه یا شناسه‌های نام‌گذاری شده بر اساس کاربر یا مستأجر به صورت salted باشند تا بردارها در حوزه‌های مختلف با هم تداخل نداشته باشند.                   |   1   |  D   |
| 8.5.3 | تأیید کنید که نتایج شباهت بالاتر از آستانه فاصله قابل تنظیم اما خارج از حوزه فراخواننده، رد شده و هشدارهای امنیتی را فعال می‌کنند.                                            |   2   | D/V  |
| 8.5.4 | اطمینان حاصل کنید که تست‌های فشار چند مستاجمی، پرس‌وجوهای خصمانه‌ای که تلاش دارند اسناد خارج از محدوده را بازیابی کنند، شبیه‌سازی می‌کنند و نشان‌دهنده عدم نشت اطلاعات هستند. |   2   |  V   |
| 8.5.5 | اطمینان حاصل کنید که کلیدهای رمزنگاری برای هر مستأجر جدا شده‌اند، به گونه‌ای که جداسازی رمزنگاری حتی در صورت اشتراک‌گذاری فضای ذخیره‌سازی فیزیکی حفظ شود.                     |   3   | D/V  |

---

## C8.6 امنیت پیشرفته سیستم حافظه

کنترل‌های امنیتی برای معماری‌های پیچیده حافظه شامل حافظه اپیزودیک، معنایی و حافظه کاری با نیازهای خاص جداسازی و اعتبارسنجی.

|   #   | Description                                                                                                                                                                                                                   | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.6.1 | تأیید کنید که انواع مختلف حافظه (اپیزودیک، معنایی، کاری) دارای زمینه‌های امنیتی جداگانه با کنترل‌های دسترسی مبتنی بر نقش، کلیدهای رمزنگاری جداگانه و الگوهای دسترسی مستندسازی شده برای هر نوع حافظه باشند.                    |   1   | D/V  |
| 8.6.2 | اطمینان حاصل کنید که فرآیندهای تثبیت حافظه شامل اعتبارسنجی امنیتی برای جلوگیری از تزریق حافظه‌های مخرب از طریق پاک‌سازی محتوا، تایید منبع و بررسی‌های یکپارچگی قبل از ذخیره‌سازی است.                                         |   2   | D/V  |
| 8.6.3 | تایید کنید که پرس‌وجوهای بازیابی حافظه بررسی و پاک‌سازی می‌شوند تا از استخراج اطلاعات غیرمجاز از طریق تحلیل الگوی پرس‌وجو، اعمال کنترل دسترسی و فیلترینگ نتایج جلوگیری شود.                                                   |   2   | D/V  |
| 8.6.4 | اطمینان حاصل کنید که مکانیزم‌های فراموشی حافظه، اطلاعات حساس را با تضمین‌های پاک‌سازی رمزنگاری شده به‌طور ایمن حذف می‌کنند، از جمله با حذف کلید، بازنویسی چندگانه، یا حذف ایمن مبتنی بر سخت‌افزار با گواهی‌های تأیید.         |   3   | D/V  |
| 8.6.5 | اطمینان حاصل شود که یکپارچگی سیستم حافظه به طور مداوم برای تغییرات یا خرابی‌های غیرمجاز از طریق مجموع‌های کنترلی (checksums)، گزارش‌های حسابرسی و هشدارهای خودکار هنگام تغییر محتوای حافظه خارج از عملیات عادی، نظارت می‌شود. |   3   | D/V  |

---

## مراجع

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)

