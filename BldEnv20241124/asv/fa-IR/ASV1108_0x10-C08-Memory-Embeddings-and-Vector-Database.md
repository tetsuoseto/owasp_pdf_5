# امنیت حافظه C8، جاسازی‌ها و پایگاه داده‌های برداری

## هدف کنترل

توکاربردهای تعبیه و فروشگاه‌های برداری به عنوان "حافظه زنده" سیستم‌های هوش مصنوعی معاصر عمل می‌کنند، به‌طور مداوم داده‌های ارائه‌شده توسط کاربر را دریافت کرده و از طریق تولید مرتبط با بازیابی (RAG) آن را به زمینه‌های مدل بازمی‌گردانند. اگر این حافظه بدون مدیریت باقی بماند، ممکن است اطلاعات شناسایی شخصی (PII) را نشت دهد، رضایت را نقض کند یا به‌صورت معکوس برای بازسازی متن اصلی استفاده شود. هدف این خانواده کنترل، سخت‌افزاری کردن خطوط لوله حافظه و پایگاه‌های داده برداری است تا دسترسی حداقل امتیازی باشد، تعبیه‌ها حفظ حریم خصوصی را تضمین کنند، بردارهای ذخیره‌شده منقضی شده یا بر حسب تقاضا لغو شوند و حافظه هر کاربر هرگز ورودی‌ها یا خروجی‌های کاربران دیگر را آلوده نکند.

---

## C8.1 کنترل‌های دسترسی بر حافظه و شاخص‌های RAG

اعمال کنترل دسترسی دقیق و جزئی بر روی هر مجموعه برداری.

|   #   | Description                                                                                                                                                                       | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.1.1 | بررسی کنید که قوانین کنترل دسترسی در سطح سطر/فضای نام، عملیات درج، حذف و پرس‌وجو را برای هر مستأجر، مجموعه یا برچسب سند محدود می‌کنند.                                            |   1   | D/V  |
| 8.1.2 | اطمینان حاصل کنید که کلیدهای API یا JWT‌ها دارای ادعاهای محدوده دار (مانند شناسه‌های مجموعه، افعال عملیاتی) هستند و حداقل هر سه ماه یکبار تعویض می‌شوند.                          |   1   | D/V  |
| 8.1.3 | اطمینان حاصل کنید که تلاش‌های افزایش امتیاز (مثلاً پرس و جوهای مشابهت بین نام‌فضاها) در کمتر از ۵ دقیقه به یک سامانه مدیریت اطلاعات و رویدادهای امنیتی (SIEM) شناسایی و ثبت شوند. |   2   | D/V  |
| 8.1.4 | اطمینان حاصل کنید که بانک اطلاعات برداری (vector DB) لاگ‌های ممیزی شامل شناسه موضوع، عملیات، شناسه بردار/نام‌فضا، آستانه تشابه و تعداد نتایج را ثبت می‌کند.                       |   2   | D/V  |
| 8.1.5 | اطمینان حاصل کنید که تصمیمات دسترسی برای نقص‌های عبور غیرمجاز هرگاه موتورهای جستجو به‌روزرسانی می‌شوند یا قوانین تقسیم‌بندی ایندکس تغییر می‌کنند، آزمایش می‌شوند.                 |   3   |  V   |

---

## C8.2 تصفیه و اعتبارسنجی جاسازی

متن را برای اطلاعات شناسایی شخصی (PII) پیش‌تصحیح کنید، قبل از بردار‌سازی آن را مخفی یا مستعار کنید، و به طور اختیاری پس‌پردازش‌هایی روی تعبیه‌ها انجام دهید تا سیگنال‌های باقی‌مانده حذف شوند.

|   #   | Description                                                                                                                                                                                                                   | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.2.1 | اطمینان حاصل کنید که داده‌های شناسایی شخصی (PII) و داده‌های تنظیم‌شده از طریق طبقه‌بندهای خودکار شناسایی شده و قبل از جاسازی، ماسک شده، توکنیزه شده یا حذف می‌شوند.                                                           |   1   | D/V  |
| 8.2.2 | تأیید کنید که خطوط لوله جایگذاری ورودی‌هایی را که حاوی کد اجرایی یا اثرات غیر UTF-8 هستند و می‌توانند ایندکس را مسموم کنند، رد یا قرنطینه می‌کنند.                                                                            |   1   |  D   |
| 8.2.3 | اعتبارسنجی شود که پاک‌سازی با حفظ حریم خصوصی تفاضلی محلی یا معیار به بردارهای جاسازی شده جملات اعمال شده باشد، مشروط بر اینکه فاصله آن‌ها با هر توکن شناخته‌شده اطلاعات شناسایی شخصی (PII) کمتر از یک آستانه قابل تنظیم باشد. |   2   | D/V  |
| 8.2.4 | اطمینان حاصل کنید که اثربخشی تصفیه (مانند بازخوانی حذف داده‌های شخصی، انحراف معنایی) حداقل هر شش ماه یکبار در مقابل مجموعه‌های معیار بررسی می‌شود.                                                                            |   2   |  V   |
| 8.2.5 | اطمینان حاصل کنید که تنظیمات پاک‌سازی تحت کنترل نسخه هستند و تغییرات تحت بررسی همتا قرار می‌گیرند.                                                                                                                            |   3   | D/V  |

---

## C8.3 انقضای حافظه، لغو و حذف

قانون GDPR "حق فراموش شدن" و قوانین مشابه نیازمند پاک‌سازی به موقع هستند؛ بنابراین فروشگاه‌های برداری باید از زمان‌زندگی محدود (TTL)، حذف سخت، و نشانه‌گذاری حذف (tomb-stoning) پشتیبانی کنند تا بردارهای لغو شده به هیچ‌وجه قابل بازیابی یا ایندکس مجدد نباشند.

|   #   | Description                                                                                                                                          | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.3.1 | اطمینان حاصل کنید که هر رکورد داده‌های برداری و متادیتا دارای یک TTL یا برچسب نگهداری صریح است که توسط کارهای پاک‌سازی خودکار رعایت می‌شود.          |   1   | D/V  |
| 8.3.2 | تأیید کنید که درخواست‌های حذف توسط کاربر، بردارها، فراداده‌ها، نسخه‌های کش و شاخص‌های مشتق شده را ظرف ۳۰ روز پاک‌سازی می‌کنند.                       |   1   | D/V  |
| 8.3.3 | تأیید کنید که حذف‌های منطقی توسط پاک‌سازی رمزنگاری شده بلوک‌های ذخیره‌سازی (در صورت پشتیبانی سخت‌افزار) یا با تخریب کلیدهای مخزن کلید دنبال می‌شوند. |   2   |  D   |
| 8.3.4 | تأیید کنید که بردارهای منقضی شده در کمتر از ۵۰۰ میلی‌ثانیه پس از انقضا از نتایج جستجوی نزدیک‌ترین همسایه حذف شده‌اند.                                |   3   | D/V  |

---

## C8.4 جلوگیری از معکوس‌سازی تعبیه و نشت اطلاعات

دفاع‌های اخیر—ترکیب نویز، شبکه‌های پروجکشن، اغتشاش نورون‌های حریم خصوصی، و رمزگذاری در لایه کاربرد—می‌توانند نرخ معکوس سازی در سطح توکن را به زیر ۵٪ کاهش دهند.

|   #   | Description                                                                                                                                                                 | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.4.1 | تأیید کنید که یک مدل تهدید رسمی شامل حملات وارونگی، عضویت و استنباط ویژگی وجود دارد و سالانه بازبینی می‌شود.                                                                |   1   |  V   |
| 8.4.2 | اطمینان حاصل کنید که رمزنگاری در لایه برنامه یا رمزنگاری جستجوپذیر، بردارها را از خوانش مستقیم توسط مدیران زیرساخت یا کارکنان ابر محافظت می‌کند.                            |   2   | D/V  |
| 8.4.3 | تأیید کنید که پارامترهای دفاعی (ε برای حریم خصوصی تفاضلی، نویز σ، رتبه پیش‌نگاره k) تعادل بین حفظ حریم خصوصی ≥ ۹۹٪ حفاظت از توکن و بهره‌وری ≤ ۳٪ افت در دقت را برقرار کنند. |   3   |  V   |
| 8.4.4 | تأیید کنید که معیارهای مقاومت در برابر وارونگی بخشی از دروازه‌های انتشار برای به‌روزرسانی مدل‌ها هستند و بودجه‌های رگرسیون تعریف شده‌اند.                                   |   3   | D/V  |

---

## اجرای محدوده C8.5 برای حافظه خاص کاربر

نشت داده در میان مستاجرها همچنان یکی از بزرگترین ریسک‌های RAG است: جستجوهای مشابهت به‌درستی فیلتر نشده می‌توانند اسناد خصوصی مشتری دیگری را آشکار کنند.

|   #   | Description                                                                                                                                                           | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.5.1 | اطمینان حاصل کنید که هر پرس‌وجوی بازیابی قبل از فرستاده شدن به پرامپت مدل زبان بزرگ (LLM)، بر اساس شناسه مستاجری/کاربر پس‌پردازش شود.                                 |   1   | D/V  |
| 8.5.2 | اطمینان حاصل کنید که نام‌های مجموعه یا شناسه‌های نام‌گذاری شده به‌صورت نمک‌دار شده برای هر کاربر یا مستأجر هستند تا بردارها نتوانند در دامنه‌ها با یکدیگر تداخل کنند. |   1   |  D   |
| 8.5.3 | اطمینان حاصل کنید که نتایج شباهت بالاتر از یک آستانه فاصله قابل تنظیم اما خارج از دامنه تماس‌گیرنده رد شده و هشدارهای امنیتی ایجاد کنند.                              |   2   | D/V  |
| 8.5.4 | اطمینان حاصل کنید که تست‌های فشار چند مستأجره شبیه‌سازی پرس‌وجوهای خصمانه‌ای هستند که سعی در بازیابی اسناد خارج از دامنه دارند و نشان‌دهنده نشت صفر باشند.            |   2   |  V   |
| 8.5.5 | اطمینان حاصل کنید که کلیدهای رمزگذاری به صورت جداگانه برای هر مستاجر نگهداری می‌شوند، به گونه‌ای که جداشدگی رمزنگاری حتی در صورت اشتراک گذاری حافظه فیزیکی حفظ شود.   |   3   | D/V  |

---

## C8.6 امنیت پیشرفته سیستم حافظه

کنترل‌های امنیتی برای معماری‌های حافظه پیشرفته شامل حافظه اپیزودیک، معنایی و کاری با نیازهای خاص جداسازی و اعتبارسنجی.

|   #   | Description                                                                                                                                                                                                                            | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.6.1 | اطمینان حاصل کنید که انواع مختلف حافظه (اپیزودیک، معنایی، کاری) دارای زمینه‌های امنیتی جداگانه با کنترل‌های دسترسی مبتنی بر نقش، کلیدهای رمزگذاری مجزا و الگوهای دسترسی مستند برای هر نوع حافظه هستند.                                 |   1   | D/V  |
| 8.6.2 | اطمینان حاصل کنید که فرایندهای تثبیت حافظه شامل اعتبارسنجی امنیتی برای جلوگیری از تزریق خاطرات مخرب از طریق پاکسازی محتوا، تأیید منبع و بررسی‌های صحت قبل از ذخیره‌سازی باشد.                                                          |   2   | D/V  |
| 8.6.3 | تأیید کنید که پرس‌وجوهای بازیابی حافظه اعتبارسنجی و پاک‌سازی شده‌اند تا از استخراج اطلاعات غیرمجاز از طریق تحلیل الگوی پرس‌وجو، اجرای کنترل دسترسی و فیلتر کردن نتایج جلوگیری شود.                                                     |   2   | D/V  |
| 8.6.4 | اطمینان حاصل کنید که مکانیزم‌های فراموشی حافظه اطلاعات حساس را با تضمین‌های پاک‌سازی رمزنگاری شده با استفاده از حذف کلید، بازنویسی چندباره، یا حذف ایمن مبتنی بر سخت‌افزار همراه با گواهی‌های تأیید پاک‌سازی، به صورت امن حذف می‌کنند. |   3   | D/V  |
| 8.6.5 | تأیید کنید که یکپارچگی سیستم حافظه به صورت مداوم برای تغییرات یا فساد غیرمجاز از طریق مجموع‌های کنترلی (checksum)، لاگ‌های حسابرسی و هشدارهای خودکار هنگام تغییر محتوای حافظه خارج از عملیات عادی، مورد پایش قرار می‌گیرد.             |   3   | D/V  |

---

## مراجع

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)

