# نظارت، ثبت وقایع و تشخیص ناهنجاری در C12

## هدف کنترل

این بخش الزامات ارائه دید بلادرنگ و جرم‌یابی را در مورد آنچه مدل و سایر اجزای هوش مصنوعی می‌بینند، انجام می‌دهند و بازمی‌گردانند، فراهم می‌کند تا تهدیدات بتوانند شناسایی، طبقه‌بندی و از آن‌ها درس گرفته شود.

## C12.1 ثبت درخواست و پاسخ

|   #    | Description                                                                                                                                                                                        | Level | Role |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.1.1 | تأیید کنید که تمامی درخواست‌های کاربر و پاسخ‌های مدل با فراداده‌های مناسب (مثلاً زمان‌ثبت، شناسه کاربر، شناسه جلسه، نسخه مدل) ثبت شده‌اند.                                                         |   1   | D/V  |
| 12.1.2 | اطمینان حاصل کنید که لاگ‌ها در مخازن امن با کنترل دسترسی مناسب همراه با سیاست‌های نگهداری و روش‌های پشتیبان‌گیری مناسب ذخیره می‌شوند.                                                              |   1   | D/V  |
| 12.1.3 | اطمینان حاصل کنید که سیستم‌های ذخیره‌سازی لاگ، رمزنگاری در حالت استراحت و در انتقال را برای محافظت از اطلاعات حساس موجود در لاگ‌ها پیاده‌سازی کرده‌اند.                                            |   1   | D/V  |
| 12.1.4 | اطمینان حاصل کنید که داده‌های حساس در درخواست‌ها و خروجی‌ها به‌طور خودکار قبل از ثبت گزارش حذف یا مخفی می‌شوند، با قوانین قابل تنظیم برای حذف اطلاعات شناسایی شخصی (PII)، مدارک و اطلاعات اختصاصی. |   1   | D/V  |
| 12.1.5 | اطمینان حاصل کنید که تصمیمات سیاستی و اقدامات فیلترینگ ایمنی با جزئیات کافی ثبت می‌شوند تا امکان بررسی و اشکال‌زدایی سیستم‌های نظارت بر محتوا فراهم شود.                                           |   2   | D/V  |
| 12.1.6 | اطمینان حاصل کنید که صحت لاگ‌ها از طریق امضاهای رمزنگاری شده یا ذخیره‌سازی فقط‌ برای نوشتن محافظت می‌شود.                                                                                          |   2   | D/V  |

---

## C12.2 تشخیص و هشدار سوءاستفاده

|   #    | Description                                                                                                                                                                                                                              | Level | Role |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.2.1 | تأیید کنید که سیستم الگوهای شناخته‌شدهٔ فرار از محدودیت، تلاش‌های تزریق فرمان و ورودی‌های خصمانه را با استفاده از شناسایی مبتنی بر امضا تشخیص داده و هشدار می‌دهد.                                                                       |   1   | D/V  |
| 12.2.2 | تأیید کنید که سیستم با استفاده از فرمت‌ها و پروتکل‌های استاندارد گزارش‌ها، با پلتفرم‌های مدیریت اطلاعات و رویدادهای امنیتی (SIEM) موجود ادغام شود.                                                                                       |   1   | D/V  |
| 12.2.3 | اطمینان حاصل کنید که رویدادهای امنیتی غنی شده شامل زمینه‌های خاص هوش مصنوعی مانند شناسه‌های مدل، امتیازهای اطمینان و تصمیمات فیلتر ایمنی هستند.                                                                                          |   2   | D/V  |
| 12.2.4 | تأیید کنید که تشخیص ناهنجاری رفتاری الگوهای غیرمعمول گفتگو، تلاش‌های مکرر بیش از حد، یا رفتارهای جستجوی سیستماتیک را شناسایی می‌کند.                                                                                                     |   2   | D/V  |
| 12.2.5 | اطمینان حاصل کنید که مکانیزم‌های هشداردهی در زمان واقعی تیم‌های امنیتی را هنگام شناسایی تخلفات احتمالی از سیاست‌ها یا تلاش‌های حمله مطلع می‌کنند.                                                                                        |   2   | D/V  |
| 12.2.6 | تأیید کنید که قوانین سفارشی برای شناسایی الگوهای تهدید خاص هوش مصنوعی شامل تلاش‌های هماهنگ شده برای دور زدن محدودیت‌ها (jailbreak)، کمپین‌های تزریق درخواست (prompt injection) و حملات استخراج مدل (model extraction) گنجانده شده باشند. |   2   | D/V  |
| 12.2.7 | اطمینان حاصل کنید که جریان‌های کاری پاسخ به حادثه خودکار قادر به ایزوله کردن مدل‌های به خطر افتاده، مسدود کردن کاربران مخرب و افزایش رویدادهای امنیتی حیاتی هستند.                                                                       |   3   | D/V  |

---

## C12.3 تشخیص رانش مدل

|   #    | Description                                                                                                                                         | Level | Role |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.3.1 | تأیید کنید که سیستم معیارهای عملکرد پایه مانند دقت، نمرات اطمینان، تاخیر و نرخ خطاها را در نسخه‌های مدل و بازه‌های زمانی مختلف ردیابی می‌کند.       |   1   | D/V  |
| 12.3.2 | اطمینان حاصل کنید که هشداردهی خودکار هنگام عبور معیارهای عملکرد از آستانه‌های کاهش از پیش تعیین شده یا انحراف قابل توجه از مبناها فعال شود.         |   2   | D/V  |
| 12.3.3 | اطمینان حاصل کنید که سیستم‌های تشخیص توهم، مواردی را که خروجی‌های مدل حاوی اطلاعات نادرست، ناسازگار یا ساختگی هستند، شناسایی و علامت‌گذاری می‌کنند. |   2   | D/V  |

---

## C12.4 تلماتری عملکرد و رفتار

|   #    | Description                                                                                                                                      | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 12.4.1 | اطمینان حاصل کنید که معیارهای عملیاتی شامل تأخیر درخواست، مصرف توکن، استفاده از حافظه و توان عملیاتی به طور مستمر جمع‌آوری و نظارت می‌شوند.      |   1   | D/V  |
| 12.4.2 | اطمینان حاصل کنید که نرخ‌های موفقیت و شکست با دسته‌بندی نوع خطاها و علل ریشه‌ای آن‌ها ردیابی می‌شوند.                                            |   1   | D/V  |
| 12.4.3 | تأیید کنید که مانیتورینگ استفاده از منابع شامل مصرف GPU/CPU، مصرف حافظه و نیازهای ذخیره‌سازی باشد و اعلان‌ها هنگام تجاوز از آستانه‌ها ارسال شود. |   2   | D/V  |

---

## C12.5 برنامه‌ریزی و اجرای پاسخ به حوادث هوش مصنوعی

|   #    | Description                                                                                                                                                        | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 12.5.1 | اطمینان حاصل کنید که برنامه‌های واکنش به حوادث به طور خاص به رویدادهای امنیتی مرتبط با هوش مصنوعی از جمله نفوذ به مدل، مسمومیت داده‌ها و حملات خصمانه پرداخته‌اند. |   1   | D/V  |
| 12.5.2 | تأیید کنید که تیم‌های پاسخ به حادثه به ابزارها و تخصص‌های قانونی دیجیتال خاص هوش مصنوعی دسترسی دارند تا رفتار مدل و مسیرهای حمله را بررسی کنند.                    |   2   | D/V  |
| 12.5.3 | اطمینان حاصل کنید که تحلیل پس از حادثه شامل ملاحظات بازآموزی مدل، به‌روزرسانی فیلترهای امنیتی و ادغام درس‌های آموخته شده در کنترل‌های امنیتی باشد.                 |   3   | D/V  |

---

## C12.5 شناسایی کاهش عملکرد هوش مصنوعی

نظارت و تشخیص افت در عملکرد و کیفیت مدل هوش مصنوعی در طول زمان.

|   #    | Description                                                                                                                            | Level | Role |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.5.1 | تأیید کنید که دقت مدل، صحت، بازخوانی و نمرات F1 به طور مداوم پایش شده و با آستانه‌های معیار مقایسه می‌شوند.                            |   1   | D/V  |
| 12.5.2 | اطمینان حاصل کنید که تشخیص تغییر داده، تغییرات توزیع ورودی را که ممکن است بر عملکرد مدل تأثیر بگذارد، نظارت می‌کند.                    |   1   | D/V  |
| 12.5.3 | تأیید کنید که شناسایی انحراف مفهوم تغییرات در رابطه بین ورودی‌ها و خروجی‌های مورد انتظار را شناسایی می‌کند.                            |   2   | D/V  |
| 12.5.4 | تأیید کنید که کاهش عملکرد منجر به فعال‌سازی هشدارهای خودکار شده و فرآیندهای آموزش مجدد مدل یا جایگزینی آن را آغاز می‌کند.              |   2   | D/V  |
| 12.5.5 | اطمینان حاصل کنید که تحلیل ریشه‌ای علت کاهش کیفیت، افت‌های عملکرد را با تغییرات داده‌ها، مشکلات زیرساخت یا عوامل خارجی همبستگی می‌دهد. |   3   |  V   |

---

## C12.6 تجسم گراف جهت‌دار بدون حلقه (DAG) و امنیت جریان کاری

سیستم‌های نمایش جریان کاری را در برابر نشت اطلاعات و حملات دستکاری محافظت کنید.

|   #    | Description                                                                                                                                                 | Level | Role |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.6.1 | اطمینان حاصل کنید که داده‌های تجسم DAG پیش از ذخیره‌سازی یا انتقال، پاک‌سازی شده و اطلاعات حساس از آنها حذف شده باشد.                                       |   1   | D/V  |
| 12.6.2 | تأیید کنید که کنترل‌های دسترسی به تجسم گردش کار فقط به کاربران مجاز اجازه می‌دهد مسیرهای تصمیم‌گیری عامل و ردپای استدلال‌ها را مشاهده کنند.                 |   1   | D/V  |
| 12.6.3 | اطمینان حاصل کنید که سلامت داده‌های DAG از طریق امضاهای رمزنگاری شده و مکانیزم‌های ذخیره‌سازی ضد دستکاری محافظت می‌شود.                                     |   2   | D/V  |
| 12.6.4 | تأیید کنید که سیستم‌های تجسم گردش کار اعتبارسنجی ورودی را پیاده‌سازی می‌کنند تا از حملات تزریق از طریق داده‌های ساخته شده‌ی گره یا یال جلوگیری شود.         |   2   | D/V  |
| 12.6.5 | اطمینان حاصل کنید که به‌روزرسانی‌های DAG در زمان واقعی محدودیت نرخ دارند و برای جلوگیری از حملات انکار خدمت بر روی سیستم‌های بصری‌سازی، اعتبارسنجی می‌شوند. |   3   | D/V  |

---

## C12.7 پایش رفتار امنیتی پیشگیرانه

شناسایی و پیشگیری از تهدیدات امنیتی از طریق تحلیل رفتاری پیش‌بینانه عامل‌ها.

|   #    | Description                                                                                                                         | Level | Role |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.7.1 | اطمینان حاصل کنید که رفتارهای فعال عامل پیش از اجرا با ادغام ارزیابی ریسک از نظر امنیتی تأیید شده‌اند.                              |   1   | D/V  |
| 12.7.2 | تأیید کنید که محرک‌های ابتکار خودکار شامل ارزیابی زمینه امنیتی و بررسی چشم‌انداز تهدیدات می‌شود.                                    |   2   | D/V  |
| 12.7.3 | اطمینان حاصل شود که الگوهای رفتار پیشگیرانه برای پیامدهای احتمالی امنیتی و عواقب ناخواسته تحلیل شده‌اند.                            |   2   | D/V  |
| 12.7.4 | اطمینان حاصل کنید که اقدامات پیشگیرانه حیاتی برای امنیت نیازمند زنجیره‌های تایید صریح با سوابق ممیزی هستند.                         |   3   | D/V  |
| 12.7.5 | اطمینان حاصل کنید که شناسایی ناهنجاری رفتاری انحرافات در الگوهای عامل پیشگیرانه که ممکن است نشان‌دهنده‌ی نفوذ باشد را تشخیص می‌دهد. |   3   | D/V  |

---

## مراجع

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)

