# C12 نظارت، ثبت وقایع و شناسایی ناهنجاری‌ها

## هدف کنترل

این بخش الزامات ارائه دید زمان واقعی و قانونی درباره آنچه مدل و سایر اجزای هوش مصنوعی مشاهده، انجام و بازگردانده‌اند را ارائه می‌دهد، تا تهدیدات قابل شناسایی، اولویت‌بندی و یادگیری باشند.

## C12.1 ثبت درخواست و پاسخ

|   #    | Description                                                                                                                                                                                                | Level | Role |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.1.1 | اطمینان حاصل کنید که همه درخواست‌های کاربر و پاسخ‌های مدل با متادیتای مناسب (مانند زمان، شناسه کاربر، شناسه جلسه، نسخه مدل) ثبت می‌شوند.                                                                   |   1   | D/V  |
| 12.1.2 | اطمینان حاصل کنید که لاگ‌ها در مخازن ایمن با کنترل دسترسی مناسب و سیاست‌های نگهداری و روش‌های پشتیبان‌گیری مناسب ذخیره می‌شوند.                                                                            |   1   | D/V  |
| 12.1.3 | تأیید کنید که سیستم‌های ذخیره‌سازی لاگ، رمزگذاری در حالت استراحت و در حال انتقال را برای محافظت از اطلاعات حساس موجود در لاگ‌ها پیاده‌سازی می‌کنند.                                                        |   1   | D/V  |
| 12.1.4 | تأیید کنید که داده‌های حساس در ورودی‌ها و خروجی‌ها قبل از ثبت به طور خودکار پاک‌سازی یا مخفی می‌شوند، با قوانین پاک‌سازی قابل تنظیم برای اطلاعات شناسایی شخصی (PII)، اطلاعات اعتبارسنجی و اطلاعات مالکیتی. |   1   | D/V  |
| 12.1.5 | اطمینان حاصل کنید که تصمیمات سیاستی و اقدامات فیلترینگ ایمنی با جزئیات کافی ثبت شده‌اند تا امکان بررسی و رفع اشکال سیستم‌های مدیریت محتوا فراهم شود.                                                       |   2   | D/V  |
| 12.1.6 | اطمینان حاصل کنید که یکپارچگی لاگ از طریق مثلا امضاهای رمزنگاری شده یا ذخیره‌سازی فقط‌نوشتنی محافظت می‌شود.                                                                                                |   2   | D/V  |

---

## C12.2 شناسایی سوءاستفاده و هشداردهی

|   #    | Description                                                                                                                                                                                                   | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.2.1 | اطمینان حاصل کنید که سیستم الگوهای شناخته شده فرار از محدودیت (jailbreak)، تلاش‌های تزریق پرامپت و ورودی‌های خصمانه را با استفاده از تشخیص مبتنی بر امضا شناسایی و هشدار می‌دهد.                              |   1   | D/V  |
| 12.2.2 | تأیید کنید که سیستم با استفاده از فرمت‌ها و پروتکل‌های استاندارد گزارش، با پلتفرم‌های موجود مدیریت اطلاعات و رویدادهای امنیتی (SIEM) یکپارچه می‌شود.                                                          |   1   | D/V  |
| 12.2.3 | تأیید کنید که رویدادهای امنیتی غنی‌شده شامل زمینه‌های خاص هوش مصنوعی مانند شناسه‌های مدل، امتیازهای اطمینان، و تصمیمات فیلتر ایمنی باشند.                                                                     |   2   | D/V  |
| 12.2.4 | اطمینان حاصل کنید که تشخیص ناهنجاری رفتاری الگوهای غیرمعمول مکالمه، تلاش‌های مکرر بیش از حد، یا رفتارهای کاوش سیستماتیک را شناسایی می‌کند.                                                                    |   2   | D/V  |
| 12.2.5 | اطمینان حاصل کنید که مکانیزم‌های هشدار دهی بلادرنگ، تیم‌های امنیتی را هنگام شناسایی نقض‌های احتمالی سیاست‌ها یا تلاش‌های حمله مطلع می‌کنند.                                                                   |   2   | D/V  |
| 12.2.6 | اطمینان حاصل کنید که قوانین سفارشی برای شناسایی الگوهای تهدید خاص هوش مصنوعی شامل تلاش‌های هماهنگ شده برای دور زدن (jailbreak)، کمپین‌های تزریق فرمان (prompt injection) و حملات استخراج مدل گنجانده شده‌اند. |   2   | D/V  |
| 12.2.7 | تأیید کنید که گردش کارهای پاسخ خودکار به حادثه قادر به جداسازی مدل‌های به خطر افتاده، مسدود کردن کاربران مخرب و تشدید رویدادهای حیاتی امنیتی هستند.                                                           |   3   | D/V  |

---

## C12.3 تشخیص تغییر مدل

|   #    | Description                                                                                                                                                         | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.3.1 | اطمینان حاصل کنید که سیستم معیارهای عملکرد پایه‌ای مانند دقت، نمرات اطمینان، تأخیر و نرخ خطا را در نسخه‌های مدل و دوره‌های زمانی مختلف پیگیری می‌کند.               |   1   | D/V  |
| 12.3.2 | اطمینان حاصل کنید که هشدارهای خودکار زمانی فعال می‌شوند که معیارهای عملکرد از آستانه‌های کاهش تعریف شده فراتر رفته یا به طور قابل توجهی از مبناها انحراف پیدا کنند. |   2   | D/V  |
| 12.3.3 | تأیید کنید که مانیتورهای شناسایی توهم، نمونه‌هایی را که خروجی‌های مدل حاوی اطلاعات نادرست، ناسازگار یا ساختگی هستند، شناسایی و علامت‌گذاری می‌کنند.                 |   2   | D/V  |

---

## C12.4 عملکرد و تله‌متری رفتار

|   #    | Description                                                                                                                                     | Level | Role |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.4.1 | تأیید کنید که معیارهای عملیاتی شامل تاخیر درخواست، مصرف توکن، استفاده از حافظه و توان عملیاتی به طور مداوم جمع‌آوری و نظارت می‌شوند.            |   1   | D/V  |
| 12.4.2 | اطمینان حاصل شود که نرخ‌های موفقیت و شکست با دسته‌بندی انواع خطاها و علل اصلی آنها پیگیری می‌شوند.                                              |   1   | D/V  |
| 12.4.3 | تأیید کنید که پایش استفاده از منابع شامل استفاده از GPU/CPU، مصرف حافظه و نیازهای ذخیره‌سازی باشد و هشدار در صورت تجاوز از آستانه‌ها ایجاد شود. |   2   | D/V  |

---

## برنامه‌ریزی و اجرای واکنش به حادثه هوش مصنوعی C12.5

|   #    | Description                                                                                                                                                          | Level | Role |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.5.1 | اطمینان حاصل کنید که برنامه‌های واکنش به حوادث به‌طور خاص به رویدادهای امنیتی مرتبط با هوش مصنوعی از جمله نفوذ به مدل، آلوده‌سازی داده‌ها و حملات خصمانه می‌پردازند. |   1   | D/V  |
| 12.5.2 | اطمینان حاصل کنید که تیم‌های پاسخ به حادثه به ابزارهای جنایی خاص هوش مصنوعی و تخصص لازم برای بررسی رفتار مدل و مسیرهای حمله دسترسی دارند.                            |   2   | D/V  |
| 12.5.3 | تأیید کنید که تحلیل پس از حادثه شامل ملاحظات بازآموزی مدل، به‌روزرسانی فیلترهای ایمنی و ادغام آموخته‌ها در کنترل‌های امنیتی می‌باشد.                                 |   3   | D/V  |

---

## C12.5 تشخیص کاهش عملکرد هوش مصنوعی

نظارت و شناسایی کاهش عملکرد و کیفیت مدل هوش مصنوعی در طول زمان.

|   #    | Description                                                                                                                            | Level | Role |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.5.1 | اطمینان حاصل کنید که دقت مدل، دقت (precision)، بازیابی (recall) و امتیاز F1 به طور مداوم پایش شده و با آستانه‌های پایه مقایسه می‌شوند. |   1   | D/V  |
| 12.5.2 | اطمینان حاصل کنید که تشخیص انحراف داده، تغییرات توزیع ورودی که ممکن است بر عملکرد مدل تاثیر بگذارد را نظارت می‌کند.                    |   1   | D/V  |
| 12.5.3 | تأیید کنید که تشخیص تغییر مفهوم، تغییرات در رابطه بین ورودی‌ها و خروجی‌های مورد انتظار را شناسایی می‌کند.                              |   2   | D/V  |
| 12.5.4 | تأیید کنید که کاهش عملکرد باعث فعال شدن هشدارهای خودکار شده و جریان‌های کاری بازآموزی مدل یا جایگزینی آن را آغاز می‌کند.               |   2   | D/V  |
| 12.5.5 | تأیید کنید که تحلیل ریشه‌ای علت کاهش عملکرد، کاهش‌های عملکرد را با تغییرات داده‌ها، مشکلات زیرساختی یا عوامل خارجی مرتبط می‌سازد.      |   3   |  V   |

---

## C12.6 تجسم DAG و امنیت گردش کار

محافظت از سیستم‌های تجسم جریان کاری در برابر نشت اطلاعات و حملات دستکاری.

|   #    | Description                                                                                                                                               | Level | Role |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.6.1 | اطمینان حاصل کنید که داده‌های تجسم DAG برای حذف اطلاعات حساس قبل از ذخیره‌سازی یا انتقال، پاک‌سازی شده‌اند.                                               |   1   | D/V  |
| 12.6.2 | اطمینان حاصل کنید که کنترل‌های دسترسی به تجسم گردش کار فقط به کاربران مجاز امکان می‌دهد مسیرهای تصمیم‌گیری عامل و ردیابی‌های استدلال را مشاهده کنند.      |   1   | D/V  |
| 12.6.3 | اطمینان حاصل کنید که صحت داده‌های DAG از طریق امضاهای رمزنگاری‌شده و مکانیزم‌های ذخیره‌سازی مقاوم در برابر دستکاری محافظت می‌شود.                         |   2   | D/V  |
| 12.6.4 | اطمینان حاصل کنید که سیستم‌های تجسم گردش کار، اعتبارسنجی ورودی را انجام می‌دهند تا از حملات تزریق از طریق داده‌های سفارشی شده در گره یا یال جلوگیری کنند. |   2   | D/V  |
| 12.6.5 | تأیید کنید که به‌روزرسانی‌های DAG در زمان واقعی به‌صورت محدود شده و اعتبارسنجی شده باشند تا از حملات انکار سرویس به سیستم‌های تجسم‌سازی جلوگیری شود.      |   3   | D/V  |

---

## C12.7 پایش رفتاری امنیتی پیشگیرانه

شناسایی و پیشگیری از تهدیدات امنیتی از طریق تحلیل رفتار پیشگیرانه عامل.

|   #    | Description                                                                                                                        | Level | Role |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.7.1 | اطمینان حاصل کنید که رفتارهای عامل پیشگیرانه قبل از اجرا با ادغام ارزیابی ریسک از نظر امنیتی معتبر شده باشند.                      |   1   | D/V  |
| 12.7.2 | تأیید کنید که محرک‌های ابتکار عمل خودگردان شامل ارزیابی زمینه امنیتی و ارزیابی چشم‌انداز تهدید هستند.                              |   2   | D/V  |
| 12.7.3 | تأیید کنید که الگوهای رفتار پیشگویانه برای پیامدهای احتمالی امنیتی و عواقب ناخواسته تحلیل شده‌اند.                                 |   2   | D/V  |
| 12.7.4 | اطمینان حاصل کنید که اقدامات پیشگیرانه حیاتی برای امنیت نیازمند زنجیره‌های تأیید صریح با ردپاهای حسابرسی هستند.                    |   3   | D/V  |
| 12.7.5 | اطمینان حاصل کنید که تشخیص ناهنجاری رفتاری، انحرافات در الگوهای عامل فعال را که ممکن است نشان‌دهنده خطر نفوذ باشد، شناسایی می‌کند. |   3   | D/V  |

---

## مراجع

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)

