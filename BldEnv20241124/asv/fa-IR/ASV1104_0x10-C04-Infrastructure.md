# امنیت زیرساخت، پیکربندی و استقرار C4

## هدف کنترل

زیرساخت‌های هوش مصنوعی باید از طریق پیکربندی ایمن، جداسازی در زمان اجرا، خط‌مشي‌های استقرار مورد اعتماد و نظارت جامع در برابر افزایش دسترسی غیرمجاز، دستکاری زنجیره تأمین و حرکت جانبی مقاوم‌سازی شوند. تنها اجزای زیرساختی مجاز و اعتبارسنجی شده و پیکربندی‌های مربوطه از طریق فرآیندهای کنترل‌شده که امنیت، صحت و قابلیت حسابرسی را حفظ می‌کنند، به تولید می‌رسند.

هدف اصلی امنیتی: تنها اجزای زیرساختی که به‌صورت رمزنگاری‌شده امضا شده و از نظر آسیب‌پذیری بررسی شده‌اند، از طریق خطوط لوله اعتبارسنجی خودکار که سیاست‌های امنیتی را اجرا می‌کنند و سوابق حسابرسی تغییرناپذیر را حفظ می‌کنند، به محیط تولید می‌رسند.

---

## محیط اجرای C4.1 ایزوله‌سازی

جلوگیری از فرار کانتینر و افزایش سطح امتیازات از طریق اصول جداسازی در سطح کرنل و کنترل‌های دسترسی اجباری.

|   #   | Description                                                                                                                                                                                                                           | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.1.1 | تأیید کنید که تمام کانتینرهای هوش مصنوعی تمامی قابلیت‌های لینوکس را به جز CAP_SETUID، CAP_SETGID و قابلیت‌های صریحاً مورد نیاز که در استانداردهای امنیتی مستند شده‌اند، حذف کرده‌اند.                                                 |   1   | D/V  |
| 4.1.2 | تأیید کنید که پروفایل‌های seccomp تمام فراخوانی‌های سیستم (syscalls) را مسدود می‌کنند، به جز آن‌هایی که در فهرست‌های سفید از پیش تایید شده قرار دارند؛ در صورت نقض این قوانین، کانتینر را متوقف کرده و هشدارهای امنیتی تولید می‌کنند. |   1   | D/V  |
| 4.1.3 | اطمینان حاصل کنید که بارهای کاری هوش مصنوعی با سیستم‌فایل‌های ریشه فقط‌خواندنی، tmpfs برای داده‌های موقت، و حجم‌های نام‌گذاری شده برای داده‌های پایدار با گزینه‌های mount noexec اجرا شوند.                                           |   2   | D/V  |
| 4.1.4 | تأیید کنید که نظارت زمان اجرای مبتنی بر eBPF (مانند Falco، Tetragon یا معادل آن) تلاش‌های افزایش امتیاز را شناسایی کرده و به طور خودکار فرآیندهای خاطی را در بازه زمانی پاسخگویی سازمانی خاتمه می‌دهد.                                |   2   | D/V  |
| 4.1.5 | تأیید کنید که بارهای کاری با ریسک بالا در محیط‌های ایزوله شده سخت‌افزاری (Intel TXT، AMD SVM، یا گره‌های اختصاصی بدون سیستم‌عامل) با تأیید صحت اعتبار اجرا شوند.                                                                      |   3   | D/V  |

---

## C4.2 خطوط لوله ساخت و استقرار امن

از طریق ساخت‌های قابل بازتولید و آثار امضاشده، صحت رمزنگاری و امنیت زنجیره تأمین را تضمین کنید.

|   #   | Description                                                                                                                                                                                                  | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 4.2.1 | اطمینان حاصل شود که زیرساخت به صورت کد با ابزارهایی مانند tfsec، Checkov یا Terrascan در هر کامیت اسکن می‌شود و ادغام‌ها در صورت وجود یافته‌های با شدت بحرانی یا بالا مسدود می‌گردند.                        |   1   | D/V  |
| 4.2.2 | اطمینان حاصل کنید که ساخت کانتینرها قابل بازتولید هستند و در تمامی ساخت‌ها، هش‌های SHA256 یکسانی تولید می‌کنند و سپس گواهی‌های اصالت سطح SLSA 3 را با امضای Sigstore ایجاد کنید.                             |   1   | D/V  |
| 4.2.3 | اطمینان حاصل کنید که تصاویر کانتینر شامل SBOM های CycloneDX یا SPDX باشند و قبل از ارسال به رجیستری با Cosign امضا شده باشند، به طوری که تصاویر بدون امضا در مرحله استقرار رد شوند.                          |   2   | D/V  |
| 4.2.4 | اطمینان حاصل کنید که خطوط لوله CI/CD از توکن‌های OIDC از HashiCorp Vault، نقش‌های IAM در AWS، یا Managed Identity در Azure استفاده می‌کنند که طول عمر آنها از محدودیت‌های سیاست امنیتی سازمان تجاوز نمی‌کند. |   2   | D/V  |
| 4.2.5 | تأیید کنید که امضاهای Cosign و منشأ SLSA در فرآیند استقرار پیش از اجرای کانتینر تأیید می‌شوند و خطاهای تأیید باعث شکست استقرار می‌شوند.                                                                      |   2   | D/V  |
| 4.2.6 | اطمینان حاصل کنید که محیط‌های ساخت در کانتینرها یا ماشین‌های مجازی گذرا اجرا می‌شوند که فاقد ذخیره‌سازی دائمی بوده و از شبکه‌های VPC تولید جدا شده‌اند.                                                      |   2   | D/V  |

---

## C4.3 امنیت شبکه و کنترل دسترسی

اجرای شبکه‌سازی با اعتماد صفر با سیاست‌های پیش‌فرض امتناع و ارتباطات رمزگذاری‌شده.

|   #   | Description                                                                                                                                                                                                      | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.3.1 | تأیید کنید که سیاست‌های شبکه Kubernetes یا معادل آن‌ها، اجرای پیش‌فرض ممنوعیت ورود/خروج (default-deny ingress/egress) را با قوانین اجازه‌دادن صریح برای پورت‌های مورد نیاز (۴۴۳، ۸۰۸۰ و غیره) برقرار کرده باشند. |   1   | D/V  |
| 4.3.2 | تأیید کنید که پورت‌های SSH (پورت ۲۲)، RDP (پورت ۳۳۸۹) و نقاط انتهایی متادیتای کلاود (169.254.169.254) مسدود شده‌اند یا نیاز به احراز هویت مبتنی بر گواهی‌نامه دارند.                                             |   1   | D/V  |
| 4.3.3 | تأیید کنید که ترافیک خروجی از طریق پروکسی‌های HTTP/HTTPS (Squid، Istio یا دروازه‌های NAT ابری) با فهرست‌های مجاز دامنه فیلتر شده و درخواست‌های مسدود شده ثبت می‌شوند.                                            |   2   | D/V  |
| 4.3.4 | اطمینان حاصل کنید که ارتباط بین سرویس‌ها از TLS متقابل با گواهی‌نامه‌هایی که مطابق با سیاست سازمانی چرخش داده می‌شوند استفاده می‌کند و اعتبارسنجی گواهی‌نامه اجرا می‌شود (بدون استفاده از پرچم‌های skip-verify). |   2   | D/V  |
| 4.3.5 | اطمینان حاصل کنید که زیرساخت هوش مصنوعی در VPC/VNetهای اختصاصی اجرا می‌شود که دسترسی مستقیم به اینترنت ندارند و تنها از طریق دروازه‌های NAT یا میزبان‌های بستیون ارتباط برقرار می‌کند.                           |   2   | D/V  |

---

## C4.4 مدیریت اسرار و کلیدهای رمزنگاری

حفاظت از اعتبارنامه‌ها از طریق ذخیره‌سازی مبتنی بر سخت‌افزار و چرخش خودکار با دسترسی مبتنی بر اطمینان صفر.

|   #   | Description                                                                                                                                                                                             | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.4.1 | اطمینان حاصل کنید که رازها در HashiCorp Vault، AWS Secrets Manager، Azure Key Vault یا Google Secret Manager با رمزنگاری در حالت ذخیره‌سازی با استفاده از AES-256 ذخیره شده‌اند.                        |   1   | D/V  |
| 4.4.2 | اطمینان حاصل کنید که کلیدهای رمزنگاری در HSMهای سطح 2 مطابق با استاندارد FIPS 140-2 (مانند AWS CloudHSM، Azure Dedicated HSM) تولید می‌شوند و چرخش کلیدها مطابق با سیاست رمزنگاری سازمانی انجام می‌شود. |   1   | D/V  |
| 4.4.3 | تأیید کنید که چرخش اسرار به‌صورت خودکار با استقرار بدون وقفه و چرخش فوری ناشی از تغییرات کارکنان یا حوادث امنیتی انجام می‌شود.                                                                          |   2   | D/V  |
| 4.4.4 | تأیید کنید که تصاویر کانتینر با استفاده از ابزارهایی مانند GitLeaks، TruffleHog یا detect-secrets اسکن شده‌اند و ساخت‌هایی که شامل کلیدهای API، گذرواژه‌ها یا گواهی‌ها هستند، مسدود می‌شوند.            |   2   | D/V  |
| 4.4.5 | تأیید کنید که دسترسی به رازهای محیط تولید نیازمند MFA با توکن‌های سخت‌افزاری (YubiKey، FIDO2) باشد و این دسترسی‌ها توسط گزارش‌های حسابرسی غیر قابل تغییر با هویت کاربران و زمان‌های ثبت شده ضبط شوند.   |   2   | D/V  |
| 4.4.6 | اطمینان حاصل کنید که رازها از طریق اسرار Kubernetes، حجم‌های نصب شده یا کانتینرهای اولیه تزریق می‌شوند و مطمئن شوید که رازها هرگز در متغیرهای محیطی یا ایمیج‌ها جاسازی نشده‌اند.                        |   2   | D/V  |

---

## ایزوله‌سازی و اعتبارسنجی بار کاری هوش مصنوعی C4.5

مدل‌های هوش مصنوعی غیرمطمئن را در محیط‌های ایزوله و امن همراه با تحلیل رفتاری جامع جدا کنید.

|   #   | Description                                                                                                                                                                                         | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.5.1 | اطمینان حاصل کنید که مدل‌های AI خارجی در محیط‌های اجرای gVisor، میکروVMها (مانند Firecracker، CrossVM) یا کانتینرهای داکر با گزینه‌های --security-opt=no-new-privileges و --read-only اجرا می‌شوند. |   1   | D/V  |
| 4.5.2 | اطمینان حاصل کنید که محیط‌های سندباکس هیچ اتصال شبکه‌ای ندارند (--network=none) یا فقط به localhost دسترسی دارند و تمامی درخواست‌های خارجی توسط قوانین iptables مسدود شده‌اند.                      |   1   | D/V  |
| 4.5.3 | اطمینان حاصل کنید که اعتبارسنجی مدل هوش مصنوعی شامل آزمایش خودکار تیم قرمز با پوشش آزمون تعریف شده سازمانی و تحلیل رفتاری برای شناسایی درب پشتی است.                                                |   2   | D/V  |
| 4.5.4 | اطمینان حاصل کنید که پیش از ارتقاء مدل هوش مصنوعی به مرحله تولید، نتایج محیط آزمایشی آن توسط پرسنل امنیتی مجاز به‌صورت رمزنگاری‌شده امضا شده و در گزارش‌های حسابرسی غیرقابل تغییر ذخیره می‌گردد.    |   2   | D/V  |
| 4.5.5 | اطمینان حاصل کنید که محیط‌های سندباکس بین ارزیابی‌ها از تصاویر طلایی نابود و مجدداً ایجاد شده‌اند و پاکسازی کامل سیستم فایل و حافظه انجام شده است.                                                  |   2   | D/V  |

---

## C4.6 نظارت بر امنیت زیرساخت

زیرساخت را به صورت مستمر اسکن و نظارت کنید، با اصلاح خودکار و هشدارهای بلادرنگ.

|   #   | Description                                                                                                                                                                              | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.6.1 | تأیید کنید که تصویرهای کانتینر بر اساس برنامه‌های سازمانی اسکن می‌شوند و آسیب‌پذیری‌های بحرانی (CRITICAL) مطابق با آستانه‌های ریسک سازمانی مانع از استقرار می‌شوند.                      |   1   | D/V  |
| 4.6.2 | تأیید کنید که زیرساخت با معیارهای CIS یا کنترل‌های NIST 800-53 که دارای آستانه‌های تطبیق تعریف شده سازمانی هستند، مطابقت دارد و همچنین برای بررسی‌های ناموفق، اصلاح خودکار انجام می‌شود. |   1   | D/V  |
| 4.6.3 | اطمینان حاصل کنید که آسیب‌پذیری‌های با شدت بالا مطابق با جدول زمانی مدیریت ریسک سازمانی اصلاح شده‌اند و برای CVEهای به‌طور فعال مورد سوءاستفاده قرار گرفته، رویه‌های اضطراری وجود دارد.  |   2   | D/V  |
| 4.6.4 | اطمینان حاصل کنید که هشدارهای امنیتی با پلتفرم‌های SIEM (اسپلانک، الستیک یا سنتینل) با استفاده از فرمت‌های CEF یا STIX/TAXII همراه با غنی‌سازی خودکار یکپارچه می‌شوند.                   |   2   |  V   |
| 4.6.5 | اطمینان حاصل کنید که معیارهای زیرساخت به سیستم‌های نظارتی (Prometheus، DataDog) با داشبوردهای SLA و گزارش‌دهی اجرایی صادر می‌شوند.                                                       |   3   |  V   |
| 4.6.6 | تأیید کنید که انحراف پیکربندی با استفاده از ابزارها (Chef InSpec، AWS Config) طبق الزامات نظارتی سازمان شناسایی می‌شود و به‌طور خودکار برای تغییرات غیرمجاز بازگشت انجام می‌گیرد.        |   2   | D/V  |

---

## مدیریت منابع زیرساخت هوش مصنوعی C4.7

جلوگیری از حملات خستگی منابع و اطمینان از تخصیص عادلانه منابع از طریق سهمیه‌ها و نظارت.

|   #   | Description                                                                                                                                                                            | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.7.1 | تأیید کنید که استفاده از GPU/TPU مانیتور می‌شود و هشدارها در سطوح تعریف شده سازمانی فعال می‌شوند و مقیاس‌پذیری خودکار یا تعادل بار بر اساس سیاست‌های مدیریت ظرفیت فعال می‌گردد.        |   1   | D/V  |
| 4.7.2 | تأیید کنید که معیارهای بار کاری هوش مصنوعی (زمان تأخیر استنتاج، توان عملیاتی، نرخ خطا) طبق الزامات نظارتی سازمان جمع‌آوری شده و با استفاده زیرساخت مطابقت داده شده‌اند.                |   1   | D/V  |
| 4.7.3 | تأیید کنید که ResourceQuotaهای Kubernetes یا معادل آن‌ها، بارهای کاری فردی را مطابق با سیاست‌های تخصیص منابع سازمانی محدود می‌کنند و محدودیت‌های سخت‌گیرانه اعمال می‌شود.              |   2   | D/V  |
| 4.7.4 | اطمینان حاصل کنید که پایش هزینه‌ها، هزینه‌ها را بر اساس هر بار کاری/مستأجر ردیابی می‌کند و هشدارهایی بر اساس آستانه بودجه سازمانی و کنترل‌های خودکار برای تجاوز از بودجه ارائه می‌دهد. |   2   |  V   |
| 4.7.5 | اطمینان حاصل کنید که برنامه‌ریزی ظرفیت از داده‌های تاریخی با دوره‌های پیش‌بینی تعریف شده سازمانی استفاده می‌کند و تأمین منابع خودکار بر اساس الگوهای تقاضا انجام می‌شود.               |   3   |  V   |
| 4.7.6 | تأیید کنید که خستگی منابع باعث فعال شدن مدارهای قطع‌کننده (circuit breakers) طبق الزامات پاسخ سازمانی می‌شود، از جمله محدودیت نرخ بر اساس سیاست‌های ظرفیت و ایزوله‌سازی بار کاری.      |   2   | D/V  |

---

## C4.8 کنترل‌های تفکیک محیط و ارتقاء

اجرای مرزهای محیطی سختگیرانه با دروازه‌های ترفیع خودکار و اعتبارسنجی امنیتی.

|   #   | Description                                                                                                                                                                                                        | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 4.8.1 | تأیید کنید که محیط‌های توسعه/تست/تولید در VPCها/VNetهای جداگانه اجرا می‌شوند و هیچ نقش IAM، گروه امنیتی یا اتصال شبکه مشترک ندارند.                                                                                |   1   | D/V  |
| 4.8.2 | تأیید کنید که ارتقاء محیط نیازمند تصویب از سوی افراد مجاز تعریف‌شده سازمانی با امضاهای رمزنگاری‌شده و ردپاهای حسابرسی غیرقابل تغییر است.                                                                           |   1   | D/V  |
| 4.8.3 | تأیید کنید که محیط‌های تولید دسترسی SSH را مسدود کرده‌اند، نقاط اشکال‌زدایی را غیرفعال کرده‌اند و درخواست تغییر با الزامات اطلاع قبلی سازمانی به جز در مواقع اضطراری را الزامی کرده‌اند.                           |   2   | D/V  |
| 4.8.4 | اطمینان حاصل کنید که تغییرات زیرساخت به‌عنوان‌کد قبل از ادغام به شاخه اصلی، نیازمند بازبینی توسط همتایان همراه با تست‌های خودکار و اسکن امنیتی باشد.                                                               |   2   | D/V  |
| 4.8.5 | اطمینان حاصل کنید که داده‌های غیرتولیدی بر اساس الزامات حفظ حریم خصوصی سازمانی ناشناس‌سازی شده‌اند، تولید داده‌های مصنوعی انجام شده است، یا پوشش کامل داده‌ها با حذف اطلاعات شخصی شناسایی‌شده (PII) تأیید شده است. |   2   | D/V  |
| 4.8.6 | تأیید کنید که در دروازه‌های ارتقا، آزمایش‌های امنیتی خودکار (SAST، DAST، اسکن کانتینر) با شرط عدم وجود هیچ‌گونه یافته بحرانی برای تایید گنجانده شده است.                                                           |   2   | D/V  |

---

## پشتیبان‌گیری و بازیابی زیرساخت C4.9

اطمینان از مقاومت زیرساخت از طریق پشتیبان‌گیری خودکار، آزمایش روش‌های بازیابی و قابلیت‌های بازیابی در مواقع بحران.

|   #   | Description                                                                                                                                                                           | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.9.1 | اطمینان حاصل شود که تنظیمات زیرساخت مطابق با برنامه‌های پشتیبان‌گیری سازمانی با اجرای استراتژی پشتیبان‌گیری ۳-۲-۱ به مناطق جغرافیایی جداگانه نسخه پشتیبان تهیه شده‌اند.               |   1   | D/V  |
| 4.9.2 | اطمینان حاصل کنید که سیستم‌های پشتیبان‌گیری در شبکه‌های ایزوله با مدارک جداگانه و ذخیره‌سازی ایزوله‌شده (air-gapped) برای محافظت در برابر باج‌افزار اجرا می‌شوند.                     |   2   | D/V  |
| 4.9.3 | اطمینان حاصل کنید که رویه‌های بازیابی از طریق آزمایش خودکار مطابق با برنامه‌های زمانی سازمانی و با اهداف RTO و RPO که نیازهای سازمان را برآورده می‌کنند، آزمایش و اعتبارسنجی شده‌اند. |   2   |  V   |
| 4.9.4 | تأیید کنید که بازیابی هنگام حادثه شامل راهنمای‌های مخصوص هوش مصنوعی با بازسازی وزن مدل، بازسازی خوشه GPU و نقشه‌برداری وابستگی سرویس‌ها باشد.                                         |   3   |  V   |

---

## انطباق و حاکمیت زیرساخت C4.10

رعایت انطباق با مقررات از طریق ارزیابی مداوم، مستندسازی و کنترل‌های خودکار را حفظ کنید.

|   #    | Description                                                                                                                                               | Level | Role |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.10.1 | اطمینان حاصل کنید که تطابق زیرساخت طبق برنامه‌های سازمانی و بر اساس کنترل‌های SOC 2، ISO 27001، یا FedRAMP با جمع‌آوری خودکار شواهد ارزیابی می‌شود.       |   2   | D/V  |
| 4.10.2 | اطمینان حاصل کنید که مستندات زیرساخت شامل نمودارهای شبکه، نقشه‌های جریان داده و مدل‌های تهدید به‌روزرسانی شده مطابق با الزامات مدیریت تغییر سازمانی باشد. |   2   |  V   |
| 4.10.3 | تأیید کنید که تغییرات زیرساختی تحت ارزیابی خودکار تأثیر تطبیق‌پذیری با جریان‌های کاری تأیید مقررات برای تغییرات پرخطر قرار می‌گیرند.                      |   3   | D/V  |

---

## C4.11 امنیت سخت‌افزار هوش مصنوعی

قطعات سخت‌افزاری مخصوص هوش مصنوعی از جمله GPUها، TPUها و شتاب‌دهنده‌های تخصصی هوش مصنوعی را امن کنید.

|   #    | Description                                                                                                                                                              | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 4.11.1 | تأیید کنید که فریمور شتاب‌دهنده هوش مصنوعی (BIOS کارت گرافیک، فریمور TPU) با امضاهای رمزنگاری شده تأیید و مطابق با زمان‌بندی مدیریت وصله‌های سازمانی به‌روزرسانی می‌شود. |   2   | D/V  |
| 4.11.2 | اطمینان حاصل کنید که قبل از اجرای بار کاری، صحت شتابدهنده هوش مصنوعی از طریق تایید هویت سخت‌افزاری با استفاده از TPM 2.0، Intel TXT یا AMD SVM بررسی می‌شود.             |   2   | D/V  |
| 4.11.3 | اطمینان حاصل کنید که حافظه GPU بین بارهای کاری با استفاده از SR-IOV، MIG (GPU چند نمونه‌ای) یا تفکیک سخت‌افزاری معادل با پاک‌سازی حافظه بین وظایف جدا شده باشد.          |   2   | D/V  |
| 4.11.4 | اطمینان حاصل کنید که زنجیره تامین سخت‌افزار هوش مصنوعی شامل تایید اصالت با گواهی‌های تولیدکننده و اعتبارسنجی بسته‌بندی ضد دستکاری باشد.                                  |   3   |  V   |
| 4.11.5 | اطمینان حاصل کنید که ماژول‌های امنیت سخت‌افزاری (HSM ها) وزن‌های مدل هوش مصنوعی و کلیدهای رمزنگاری را با گواهینامه FIPS 140-2 سطح 3 یا معیار مشترک EAL4+ محافظت می‌کنند. |   3   | D/V  |

---

## زیرساخت هوش مصنوعی لبه‌ای و توزیع‌شده C4.12

استقرارهای امن هوش مصنوعی توزیع‌شده شامل محاسبات لبه، یادگیری اشتراکی و معماری‌های چندمحلی.

|   #    | Description                                                                                                                                                                                     | Level | Role |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.12.1 | تأیید کنید که دستگاه‌های هوش لبه‌ای با استفاده از TLS متقابل و گواهی‌نامه‌های دستگاه که مطابق با سیاست مدیریت گواهی سازمانی به صورت دوره‌ای تعویض می‌شوند، به زیرساخت مرکزی احراز هویت می‌کنند. |   2   | D/V  |
| 4.12.2 | اطمینان حاصل کنید که دستگاه‌های لبه‌ای بوت امن با امضاهای تأیید شده و حفاظت از بازگشت را پیاده‌سازی می‌کنند تا از حملات کاهش نسخه سیستم‌افزار جلوگیری شود.                                      |   2   | D/V  |
| 4.12.3 | تأیید کنید که هماهنگی هوش مصنوعی توزیع‌شده از الگوریتم‌های توافق تحمل خطای بیزانتی استفاده می‌کند که شامل اعتبارسنجی مشارکت‌کنندگان و تشخیص گره‌های مخرب باشد.                                  |   3   | D/V  |
| 4.12.4 | اطمینان حاصل کنید که ارتباط لبه تا ابر شامل محدودیت پهنای باند، فشرده‌سازی داده‌ها و قابلیت‌های عملیات آفلاین با ذخیره‌سازی محلی امن است.                                                       |   3   | D/V  |

---

## C4.13 امنیت زیرساخت چندابری و ترکیبی

بارکاری‌های هوش مصنوعی را در میان چندین ارائه‌دهنده ابر و استقرارهای ترکیبی ابر-محلی به صورت امن محافظت کنید.

|   #    | Description                                                                                                                                                                                          | Level | Role |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.13.1 | تأیید کنید که استقرارهای هوش مصنوعی چندابری از فدراسیون هویت مستقل از ابر (OIDC، SAML) با مدیریت سیاست متمرکز در سراسر ارائه‌دهندگان استفاده می‌کنند.                                                |   2   | D/V  |
| 4.13.2 | اطمینان حاصل کنید که انتقال داده‌های میان ابرها از رمزگذاری انتها به انتها با کلیدهای مدیریت شده توسط مشتری و کنترل‌های محل اقامت داده‌ها طبق حوزه قضایی اعمال می‌شود.                               |   2   | D/V  |
| 4.13.3 | اطمینان حاصل کنید که بارهای کاری هوش مصنوعی ابری هیبریدی سیاست‌های امنیتی یکنواختی را در محیط‌های محلی و ابری اجرا می‌کنند و نظارت و هشداردهی یکپارچه دارند.                                         |   2   | D/V  |
| 4.13.4 | اطمینان حاصل کنید که جلوگیری از وابستگی به فروشنده‌ی خدمات ابری شامل زیرساخت قابل حمل به صورت کد (infrastructure-as-code)، APIهای استاندارد شده و قابلیت‌های صادرات داده با ابزارهای تبدیل فرمت است. |   3   |  V   |
| 4.13.5 | تأیید کنید که بهینه‌سازی هزینه چندابری شامل کنترل‌های امنیتی است که از پراکندگی منابع جلوگیری کرده و همچنین از هزینه‌های انتقال داده غیرمجاز بین ابرها جلوگیری می‌کند.                               |   3   |  V   |

---

## C4.14 امنیت اتوماسیون زیرساخت و GitOps

خطوط لوله اتوماسیون زیرساخت امن و گردش‌های کاری GitOps برای مدیریت زیرساخت هوش مصنوعی.

|   #    | Description                                                                                                                                                                | Level | Role |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.14.1 | اطمینان حاصل کنید که مخازن GitOps نیاز به کامیت‌های امضا شده با کلیدهای GPG دارند و قوانین محافظت شاخه که مانع از ارسال مستقیم به شاخه‌های اصلی می‌شوند را اعمال کرده‌اند. |   2   | D/V  |
| 4.14.2 | تأیید کنید که اتوماسیون زیرساخت شامل شناسایی انحراف با قابلیت‌های اصلاح خودکار و بازگرداندن تغییرات است که طبق الزامات پاسخ سازمانی برای تغییرات غیرمجاز فعال می‌شود.      |   2   | D/V  |
| 4.14.3 | اطمینان حاصل کنید که فراهم‌آوری خودکار زیرساخت شامل اعتبارسنجی سیاست امنیتی با مسدود کردن استقرار برای پیکربندی‌های غیرمنطبق باشد.                                         |   2   | D/V  |
| 4.14.4 | تأیید کنید که اسرار مربوط به اتوماسیون زیرساخت از طریق اپراتورهای اسرار خارجی (External Secrets Operator، Bank-Vaults) با چرخش خودکار مدیریت می‌شوند.                      |   2   | D/V  |
| 4.14.5 | تأیید کنید که زیرساخت خودتعمیر شامل همبستگی رویدادهای امنیتی با پاسخ خودکار به حادثه و گردش کار اطلاع‌رسانی به ذینفعان باشد.                                               |   3   |  V   |

---

## C4.15 امنیت زیرساخت مقاوم در برابر کوانتوم

زیرساخت هوش مصنوعی را برای تهدیدات محاسبات کوانتومی از طریق رمزنگاری پساکوانتمی و پروتکل‌های ایمن-کوانتمی آماده کنید.

|   #    | Description                                                                                                                                                                            | Level | Role |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.15.1 | تأیید کنید که زیرساخت هوش مصنوعی از الگوریتم‌های رمزنگاری پساکوانتومی مورد تأیید NIST (CRYSTALS-Kyber، CRYSTALS-Dilithium، SPHINCS+) برای تبادل کلید و امضاهای دیجیتال استفاده می‌کند. |   3   | D/V  |
| 4.15.2 | اطمینان حاصل کنید که سیستم‌های توزیع کلید کوانتومی (QKD) برای ارتباطات هوش مصنوعی با امنیت بالا با استفاده از پروتکل‌های مدیریت کلید کوانتومی امن پیاده‌سازی شده‌اند.                  |   3   | D/V  |
| 4.15.3 | اطمینان حاصل کنید که چارچوب‌های چابکی رمزنگاری اجازه مهاجرت سریع به الگوریتم‌های پساکوانتومی جدید را با گردش خودکار گواهی‌نامه و کلید فراهم می‌کنند.                                   |   3   | D/V  |
| 4.15.4 | تأیید کنید که مدل‌سازی تهدید کوانتومی، آسیب‌پذیری زیرساخت‌های هوش مصنوعی در برابر حملات کوانتومی را با زمان‌بندی مهاجرت مستند و ارزیابی‌های ریسک بررسی می‌کند.                         |   3   |  V   |
| 4.15.5 | اطمینان حاصل کنید که سیستم‌های رمزنگاری ترکیبی کلاسیک-کوانتومی در طول دوره انتقال کوانتومی با نظارت بر عملکرد، دفاع چندلایه فراهم می‌کنند.                                             |   3   | D/V  |

---

## C4.16 محاسبات محرمانه و محصورهای امن

بار کاری هوش مصنوعی و وزن‌های مدل را با استفاده از محیط‌های اجرای قابل اعتماد مبتنی بر سخت‌افزار و فناوری‌های محاسبات محرمانه محافظت کنید.

|   #    | Description                                                                                                                                                 | Level | Role |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.16.1 | تأیید کنید که مدل‌های حساس هوش مصنوعی در محیط‌های محافظت شده Intel SGX، AMD SEV-SNP، یا ARM TrustZone با حافظه رمزگذاری شده و تأیید اعتبار اجرا می‌شوند.    |   3   | D/V  |
| 4.16.2 | تأیید کنید که کانتینرهای محرمانه (Kata Containers، gVisor با محاسبات محرمانه) بارهای کاری هوش مصنوعی را با رمزگذاری حافظه اجباری سخت‌افزاری ایزوله می‌کنند. |   3   | D/V  |
| 4.16.3 | اطمینان حاصل کنید که تأیید از راه دور، اعتبار یکپارچگی انکلیو را پیش از بارگذاری مدل‌های هوش مصنوعی با اثبات رمزنگاری شده اصالت محیط اجرایی بررسی می‌کند.   |   3   | D/V  |
| 4.16.4 | تأیید کنید که خدمات استنتاج AI محرمانه، از استخراج مدل از طریق محاسبات رمزنگاری شده با وزن‌های مدل مهر و موم شده و اجرای محافظت شده جلوگیری می‌کنند.        |   3   | D/V  |
| 4.16.5 | تأیید کنید که ارکستراسیون محیط اجرای مورد اعتماد، چرخه عمر ناحیه امن را با تصدیق از راه دور و کانال‌های ارتباطی رمزنگاری شده مدیریت می‌کند.                 |   3   | D/V  |
| 4.16.6 | اطمینان حاصل کنید که محاسبات چندجانبه امن (SMPC) امکان آموزش همکاری هوش مصنوعی را بدون افشای داده‌های فردی یا پارامترهای مدل فراهم می‌کند.                  |   3   | D/V  |

---

## C4.17 زیرساخت دانش صفر

پیاده‌سازی سیستم‌های اثبات دانش صفر برای تأیید و احراز هویت هوش مصنوعی حفظ حریم خصوصی بدون فاش کردن اطلاعات حساس.

|   #    | Description                                                                                                                                                              | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 4.17.1 | تأیید کنید که اثبات‌های بدون دانش (ZK-SNARKها، ZK-STARKها) صحت مدل هوش مصنوعی و منشاء آموزش آن را بدون افشای وزن‌های مدل یا داده‌های آموزشی اعتبارسنجی می‌کنند.          |   3   | D/V  |
| 4.17.2 | تأیید کنید که سیستم‌های احراز هویت مبتنی بر ZK امکان تأیید هویت کاربران با حفظ حریم خصوصی برای خدمات هوش مصنوعی را بدون افشای اطلاعات مرتبط با هویت فراهم می‌کنند.       |   3   | D/V  |
| 4.17.3 | تأیید کنید که پروتکل‌های اشتراک‌گذاری مجموعه خصوصی (PSI) امکان تطبیق ایمن داده‌ها برای هوش مصنوعی فدرال را بدون افشای مجموعه‌های داده فردی فراهم می‌کنند.                |   3   | D/V  |
| 4.17.4 | اطمینان حاصل کنید که سیستم‌های یادگیری ماشین دانش-صفر (ZKML) امکان ارائه استنتاج‌های هوش مصنوعی قابل راستی‌آزمایی را با اثبات رمزنگاری شده از صحت محاسبات فراهم می‌کنند. |   3   | D/V  |
| 4.17.5 | تأیید کنید که زی‌کی‌رول‌آپ‌ها امکان پردازش تراکنش‌های هوش مصنوعی را با قابلیت مقیاس‌پذیری و حفظ حریم خصوصی، همراه با صحت‌سنجی دسته‌ای و کاهش بار محاسباتی فراهم می‌کنند. |   3   | D/V  |

---

## C4.18 پیشگیری از حملات کانال جانبی

محافظت از زیرساخت‌های هوش مصنوعی در برابر حملات کانال جانبی مبتنی بر زمان، توان، الکترومغناطیس و کش که ممکن است اطلاعات حساس را نشت دهند.

|   #    | Description                                                                                                                                                                            | Level | Role |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.18.1 | اطمینان حاصل کنید که زمان‌بندی استنتاج هوش مصنوعی با استفاده از الگوریتم‌های زمان ثابت و پرکردن اطلاعات (padding) نرمال شده است تا از حملات استخراج مدل بر اساس زمان‌بندی جلوگیری شود. |   3   | D/V  |
| 4.18.2 | اطمینان حاصل کنید که حفاظت در برابر تحلیل توان شامل تزریق نویز، فیلتر کردن خط توان و الگوهای اجرای تصادفی برای سخت‌افزار هوش مصنوعی باشد.                                              |   3   | D/V  |
| 4.18.3 | تأیید کنید که کاهش اثرات کانال جانبی مبتنی بر کش، از تقسیم‌بندی کش، تصادفی‌سازی و دستورهای پاک‌سازی برای جلوگیری از نشت اطلاعات استفاده می‌کند.                                        |   3   | D/V  |
| 4.18.4 | تایید کنید که حفاظت در برابر انتشار الکترومغناطیسی شامل جلوگیری با استفاده از پوشش‌های محافظ، فیلتر کردن سیگنال و پردازش تصادفی به منظور جلوگیری از حملات نوع TEMPEST است.             |   3   | D/V  |
| 4.18.5 | تأیید کنید که تدابیر دفاعی کانال جانبی ریزمعماری شامل کنترل‌های اجرای حدسی و پوشش‌دهی الگوهای دسترسی حافظه هستند.                                                                      |   3   | D/V  |

---

## C4.19 امنیت سخت‌افزار نورومورفیک و تخصصی هوش مصنوعی

امن‌سازی معماری‌های سخت‌افزاری نوظهور هوش مصنوعی شامل تراشه‌های نورومورفیک، FPGAها، ASICهای سفارشی و سیستم‌های محاسبات نوری.

|   #    | Description                                                                                                                                                                          | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 4.19.1 | اطمینان حاصل کنید که امنیت تراشه نورومورفیک شامل رمزگذاری الگوی پالس، حفاظت از وزن سیناپسی و اعتبارسنجی قوانین یادگیری مبتنی بر سخت‌افزار است.                                       |   3   | D/V  |
| 4.19.2 | تأیید کنید که تسریع‌کننده‌های هوش مصنوعی مبتنی بر FPGA، رمزنگاری بیت‌استریم، مکانیزم‌های ضد دستکاری و بارگذاری پیکربندی امن با به‌روزرسانی‌های احراز هویت شده را پیاده‌سازی می‌کنند. |   3   | D/V  |
| 4.19.3 | اطمینان حاصل کنید که امنیت ASIC سفارشی شامل پردازنده‌های امنیتی روی تراشه، ریشه اعتماد سخت‌افزاری و ذخیره‌سازی کلید ایمن با قابلیت تشخیص دستکاری است.                                |   3   | D/V  |
| 4.19.4 | تأیید کنید که سیستم‌های محاسبات نوری رمزنگاری نوری کوانتومی امن، سوئیچینگ فوتونیکی ایمن و پردازش سیگنال نوری محافظت‌شده را پیاده‌سازی می‌کنند.                                       |   3   | D/V  |
| 4.19.5 | اطمینان حاصل کنید که تراشه‌های هوش مصنوعی هیبریدی آنالوگ-دیجیتال شامل محاسبات امن آنالوگ، ذخیره‌سازی وزن محافظت‌شده، و تبدیل آنالوگ به دیجیتال احراز هویت شده هستند.                 |   3   | D/V  |

---

## C4.20 زیرساخت محاسباتی حفظ حریم خصوصی

اجرای کنترل‌های زیرساختی برای محاسبات حفظ حریم خصوصی به منظور محافظت از داده‌های حساس در طول پردازش و تحلیل هوش مصنوعی.

|   #    | Description                                                                                                                                                                 | Level | Role |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 4.20.1 | تأیید کنید که زیرساخت رمزنگاری همومورفیک امکان انجام محاسبات رمزگذاری شده روی بارهای کاری حساس هوش مصنوعی را با صحت‌سنجی رمزنگاری و نظارت بر عملکرد فراهم می‌کند.           |   3   | D/V  |
| 4.20.2 | اطمینان حاصل کنید که سیستم‌های بازیابی اطلاعات خصوصی امکان انجام پرس‌وجوی پایگاه داده را بدون افشای الگوهای پرس‌وجو با محافظت رمزنگاری شده از الگوهای دسترسی فراهم می‌کنند. |   3   | D/V  |
| 4.20.3 | تأیید کنید که پروتکل‌های محاسبات چندجانبه امن امکان استنتاج هوش مصنوعی حفظ حریم خصوصی را بدون افشای ورودی‌های فردی یا محاسبات میانی فراهم می‌کنند.                          |   3   | D/V  |
| 4.20.4 | تأیید کنید که مدیریت کلید حفظ حریم خصوصی شامل تولید کلید توزیع‌شده، رمزنگاری آستانه‌ای و چرخش امن کلید با حفاظت مبتنی بر سخت‌افزار است.                                     |   3   | D/V  |
| 4.20.5 | اطمینان حاصل کنید که عملکرد محاسبات حفظ حریم خصوصی از طریق دسته‌بندی، کشینگ و تسریع سخت‌افزاری بهینه شده است در حالی که تضمین‌های امنیت رمزنگاری حفظ می‌شود.                |   3   | D/V  |

---

## چارچوب عامل C4.15 امنیت یکپارچه‌سازی ابری و استقرار ترکیبی

کنترل‌های امنیتی برای چارچوب‌های عامل یکپارچه با ابر با معماری‌های ترکیبی محلی/ابری.

|   #    | Description                                                                                                        | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 4.15.1 | تأیید کنید که ادغام ذخیره‌سازی ابری از رمزگذاری انتها به انتها با مدیریت کلید تحت کنترل عامل استفاده می‌کند.       |   1   | D/V  |
| 4.15.2 | تأیید کنید که مرزهای امنیتی استقرار ترکیبی به وضوح تعریف شده و کانال‌های ارتباطی رمزگذاری شده باشند.               |   2   | D/V  |
| 4.15.3 | اطمینان حاصل کنید که دسترسی به منابع ابری شامل احراز هویت صفراعتمادی با تأیید مداوم است.                           |   2   | D/V  |
| 4.15.4 | تأیید کنید که الزامات اقامت داده‌ها با اعتبارسنجی رمزنگاری‌شده مکان‌های ذخیره‌سازی اعمال می‌شوند.                  |   3   | D/V  |
| 4.15.5 | اطمینان حاصل کنید که ارزیابی‌های امنیتی ارائه‌دهنده خدمات ابری شامل مدل‌سازی تهدیدات خاص عامل و ارزیابی ریسک باشد. |   3   | D/V  |

---

## مراجع

* [NIST Cybersecurity Framework 2.0](https://www.nist.gov/cyberframework)
* [CIS Controls v8](https://www.cisecurity.org/controls/v8)
* [OWASP Container Security Verification Standard](https://github.com/OWASP/Container-Security-Verification-Standard)
* [Kubernetes Security Best Practices](https://kubernetes.io/docs/concepts/security/)
* [SLSA Supply Chain Security Framework](https://slsa.dev/)
* [NIST SP 800-190: Application Container Security Guide](https://csrc.nist.gov/publications/detail/sp/800-190/final)
* [Cloud Security Alliance: Cloud Controls Matrix](https://cloudsecurityalliance.org/research/cloud-controls-matrix/)
* [ENISA: Secure Infrastructure Design](https://www.enisa.europa.eu/topics/critical-information-infrastructures-and-services)
* [NIST SP 800-53: Security Controls for Federal Information Systems](https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final)
* [ISO 27001:2022 Information Security Management](https://www.iso.org/standard/27001)
* [NIST AI Risk Management Framework](https://www.nist.gov/itl/ai-risk-management-framework)
* [CIS Kubernetes Benchmark](https://www.cisecurity.org/benchmark/kubernetes)
* [FIPS 140-2 Security Requirements](https://csrc.nist.gov/publications/detail/fips/140/2/final)
* [NIST SP 800-207: Zero Trust Architecture](https://csrc.nist.gov/publications/detail/sp/800-207/final)
* [IEEE 2857: Privacy Engineering for AI Systems](https://standards.ieee.org/ieee/2857/7273/)
* [NIST SP 800-161: Cybersecurity Supply Chain Risk Management](https://csrc.nist.gov/publications/detail/sp/800-161/rev-1/final)
* [NIST Post-Quantum Cryptography Standards](https://csrc.nist.gov/Projects/post-quantum-cryptography)
* [Intel SGX Developer Guide](https://www.intel.com/content/www/us/en/developer/tools/software-guard-extensions/overview.html)
* [AMD SEV-SNP White Paper](https://www.amd.com/system/files/TechDocs/SEV-SNP-strengthening-vm-isolation-with-integrity-protection-and-more.pdf)
* [ARM TrustZone Technology](https://developer.arm.com/ip-products/security-ip/trustzone)
* [ZK-SNARKs: A Gentle Introduction](https://blog.ethereum.org/2016/12/05/zksnarks-in-a-nutshell/)
* [NIST SP 800-57: Cryptographic Key Management](https://csrc.nist.gov/publications/detail/sp/800-57-part-1/rev-5/final)
* [Side-Channel Attack Countermeasures](https://link.springer.com/book/10.1007/978-3-319-75268-6)
* [Neuromorphic Computing Security Challenges](https://ieeexplore.ieee.org/document/9458103)
* [FPGA Security: Fundamentals, Evaluation, and Countermeasures](https://link.springer.com/book/10.1007/978-3-319-90385-9)
* [Microsoft SEAL: Homomorphic Encryption Library](https://github.com/Microsoft/SEAL)
* [HElib: Homomorphic Encryption Library](https://github.com/homenc/HElib)
* [PALISADE Lattice Cryptography Library](https://palisade-crypto.org/)
* [Differential Privacy: A Survey of Results](https://link.springer.com/chapter/10.1007/978-3-540-79228-4_1)
* [Secure Aggregation for Federated Learning](https://eprint.iacr.org/2017/281.pdf)
* [Private Information Retrieval: Concepts and Constructions](https://link.springer.com/book/10.1007/978-3-030-16234-8)

