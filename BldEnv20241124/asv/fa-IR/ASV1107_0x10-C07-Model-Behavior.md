# رفتار مدل C7، کنترل خروجی و تضمین ایمنی

## هدف کنترل

خروجی‌های مدل باید ساختاریافته، قابل اعتماد، ایمن، قابل توضیح و به‌طور مداوم در محیط تولید نظارت‌شده باشند. انجام این موارد باعث کاهش توهمات (hallucinations)، نشت اطلاعات خصوصی، محتوای مضر و اقدامات خارج از کنترل، و در عین حال افزایش اعتماد کاربران و رعایت مقررات می‌شود.

---

## C7.1 اجرای قالب خروجی

اسکیماهای سخت‌گیرانه، رمزگشایی محدود شده و اعتبارسنجی‌های پس‌از-فرآیند مسیر محتوای نادرست یا مخرب را قبل از انتشار متوقف می‌کنند.

|   #   | Description                                                                                                                                                                                | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 7.1.1 | اطمینان حاصل کنید که طرح‌بندی‌های پاسخ (مانند JSON Schema) در پرامپت سیستم ارائه شده‌اند و هر خروجی به‌طور خودکار اعتبارسنجی می‌شود؛ خروجی‌های ناسازگار موجب اصلاح یا رد خودکار شوند.      |   1   | D/V  |
| 7.1.2 | اطمینان حاصل کنید که رمزگشایی محدود شده (توکن‌های توقف، عبارات منظم، حداکثر توکن‌ها) فعال است تا از سرریز یا کانال‌های جانبی تزریق پرامپت جلوگیری شود.                                     |   1   | D/V  |
| 7.1.3 | اطمینان حاصل کنید که اجزای پایین‌دست خروجی‌ها را به عنوان داده‌های غیرقابل اعتماد در نظر می‌گیرند و آن‌ها را بر اساس طرح‌واره‌ها یا دسیریالایزرهای امن در برابر تزریق، اعتبارسنجی می‌کنند. |   2   | D/V  |
| 7.1.4 | اطمینان حاصل کنید که رویدادهای خروجی نادرست ثبت، محدودیت نرخ و به سیستم نظارت ارائه می‌شوند.                                                                                               |   3   |  V   |

---

## C7.2 شناسایی و کاهش هالوسیناسیون

برآورد عدم قطعیت و استراتژی‌های جایگزین پاسخ‌های ساختگی را محدود می‌کنند.

|   #   | Description                                                                                                                                                                  | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 7.2.1 | اطمینان حاصل کنید که احتمال‌های لگاریتمی در سطح توکن، انسجام خودکار مجموعه‌ای یا آشکارسازهای هالوسیناسیون تنظیم‌شده، به هر پاسخ یک نمره اطمینان اختصاص می‌دهند.              |   1   | D/V  |
| 7.2.2 | اطمینان حاصل کنید که پاسخ‌هایی با سطح اطمینان پایین‌تر از آستانه قابل تنظیم، روندهای پشتیبان (مانند تولید با بازیابی اطلاعات، مدل ثانویه یا بازبینی انسانی) را فعال می‌کنند. |   1   | D/V  |
| 7.2.3 | اطمینان حاصل کنید که حوادث توهم‌زایی با متادیتای علت ریشه‌ای برچسب‌گذاری شده و به خطوط لوله پست‌مورتوم و تنظیم دقیق داده می‌شوند.                                            |   2   | D/V  |
| 7.2.4 | اطمینان حاصل کنید که آستانه‌ها و آشکارسازها پس از به‌روزرسانی‌های مهم مدل یا پایگاه دانش دوباره کالیبره می‌شوند.                                                             |   3   | D/V  |
| 7.2.5 | تأیید کنید که تصویری‌سازی‌های داشبورد نرخ‌های هذیان‌زدایی را دنبال می‌کنند.                                                                                                  |   3   |  V   |

---

## C7.3 فیلترینگ ایمنی و حفظ حریم خصوصی خروجی

فیلترهای سیاستی و پوشش تیم قرمز از کاربران و داده‌های محرمانه محافظت می‌کنند.

|   #   | Description                                                                                                                                                            | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 7.3.1 | تأیید کنید که طبقه‌بندی‌کننده‌های قبل و بعد از تولید، محتوای نفرت‌انگیز، آزاردهنده، خودآسیب‌رسان، افراط‌گرایانه و صریح جنسی که منطبق با سیاست‌ها است را مسدود می‌کنند. |   1   | D/V  |
| 7.3.2 | اطمینان حاصل کنید که تشخیص اطلاعات شناسایی شخصی (PII) و کارت اعتباری (PCI) و حذف خودکار آن‌ها در هر پاسخ اجرا شود؛ تخلفات منجر به بروز حادثه محرمانگی خواهند شد.       |   1   | D/V  |
| 7.3.3 | اطمینان حاصل کنید که برچسب‌های محرمانگی (مانند اسرار تجاری) در تمام حوزه‌ها منتقل شده و از نشت اطلاعات در متن، تصاویر یا کد جلوگیری می‌کنند.                           |   2   |  D   |
| 7.3.4 | تأیید کنید که تلاش‌های عبور از فیلتر یا دسته‌بندی‌های پرخطر نیازمند تأیید ثانویه یا احراز هویت مجدد کاربر باشند.                                                       |   3   | D/V  |
| 7.3.5 | تأیید کنید که آستانه‌های فیلترینگ بازتاب‌دهنده حوزه‌های قضایی قانونی و زمینه سنی/نقشی کاربر باشند.                                                                     |   3   | D/V  |

---

## C7.4 محدودسازی خروجی و اقدامات

محدودیت‌های نرخ و دروازه‌های تایید از سوءاستفاده و خودمختاری بیش از حد جلوگیری می‌کنند.

|   #   | Description                                                                                                                                                                | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 7.4.1 | تأیید کنید که سهمیه‌های هر کاربر و هر کلید API درخواست‌ها، توکن‌ها و هزینه‌ها را محدود می‌کنند و در صورت دریافت خطای 429 از مکانیزم توقف تصاعدی استفاده می‌شود.            |   1   |  D   |
| 7.4.2 | تأیید کنید که اقدامات ممتاز (نوشتن فایل، اجرای کد، تماس‌های شبکه) نیازمند تأیید مبتنی بر سیاست یا دخالت انسانی هستند.                                                      |   1   | D/V  |
| 7.4.3 | اطمینان حاصل کنید که بررسی‌های سازگاری چندرسانه‌ای تضمین می‌کنند تصاویر، کد و متنی که برای یک درخواست یکسان تولید می‌شوند، نمی‌توانند برای قاچاق محتوای مخرب استفاده شوند. |   2   | D/V  |
| 7.4.4 | بررسی کنید که عمق واگذاری عامل، محدودیت‌های بازگشت (رکورس) و فهرست‌های ابزارهای مجاز به طور صریح پیکربندی شده باشند.                                                       |   2   |  D   |
| 7.4.5 | تأیید کنید که نقض محدودیت‌ها رویدادهای امنیتی ساختاریافته برای دریافت توسط سیستم مدیریت اطلاعات و رویدادهای امنیتی (SIEM) ایجاد می‌کند.                                    |   3   |  V   |

---

## قابلیت توضیح‌پذیری خروجی C7.5

سیگنال‌های شفاف اعتماد کاربران و اشکال‌زدایی داخلی را بهبود می‌بخشند.

|   #   | Description                                                                                                                               | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 7.5.1 | اطمینان حاصل کنید که امتیازهای اطمینان نمایش داده شده به کاربر یا خلاصه‌های مختصر دلایل زمانی که ارزیابی ریسک مناسب بداند، ارائه می‌شوند. |   2   | D/V  |
| 7.5.2 | اطمینان حاصل کنید که توضیحات تولید شده از افشای دستورات حساس سیستم یا داده های اختصاصی جلوگیری می‌کنند.                                   |   2   | D/V  |
| 7.5.3 | اطمینان حاصل کنید که سیستم احتمال‌های لاگ سطح توکن یا نقشه‌های توجه را ضبط کرده و آن‌ها را برای بررسی‌های مجاز ذخیره می‌کند.              |   3   |  D   |
| 7.5.4 | اطمینان حاصل کنید که مصنوعات قابلیت توضیح‌دهی به همراه نسخه‌های مدل برای قابلیت حسابرسی تحت کنترل نسخه قرار دارند.                        |   3   |  V   |

---

## C7.6 یکپارچه‌سازی نظارت

مشاهده‌پذیری در زمان واقعی حلقه بین توسعه و تولید را می‌بندد.

|   #   | Description                                                                                                                                         | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 7.6.1 | اطمینان حاصل کنید که معیارها (نقض‌های طرح‌واره، نرخ توهم، سمی بودن، نشت اطلاعات شناسایی شخصی، تأخیر، هزینه) به یک پلتفرم نظارت مرکزی ارسال می‌شوند. |   1   |  D   |
| 7.6.2 | تأیید کنید که آستانه‌های هشدار برای هر معیار ایمنی تعریف شده باشد و مسیرهای ارتقاء در دسترس در حالت تماس اضطراری نیز مشخص شده باشند.                |   1   |  V   |
| 7.6.3 | اطمینان حاصل کنید که داشبوردها ناهنجاری‌های خروجی را با مدل/نسخه، پرچم ویژگی و تغییرات داده‌های بالادستی همبسته می‌کنند.                            |   2   |  V   |
| 7.6.4 | تأیید کنید که داده‌های نظارتی به آموزش مجدد، تنظیم دقیق یا به‌روزرسانی قوانین در چارچوب مستند شده MLOps بازخورد داده می‌شوند.                       |   2   | D/V  |
| 7.6.5 | اطمینان حاصل کنید که خطوط انتقال نظارتی تحت آزمایش نفوذ قرار گرفته و کنترل‌های دسترسی برای جلوگیری از نشت لاگ‌های حساس اعمال شده‌اند.               |   3   |  V   |

---

## 7.7 تدابیر حفاظتی رسانه‌های مولد

اطمینان حاصل کنید که سیستم‌های هوش مصنوعی محتوای رسانه‌ای غیرقانونی، مضر یا غیرمجاز تولید نکنند با اعمال محدودیت‌های سیاستی، اعتبارسنجی خروجی و قابلیت رهگیری.

|   #   | Description                                                                                                                                                                                        | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 7.7.1 | اطمینان حاصل کنید که دستورات سیستم و دستورالعمل‌های کاربر به‌طور صریح تولید محتوای دیپ‌فیک غیرقانونی، مضر یا بدون رضایت (مثلاً تصویر، ویدئو، صوت) را ممنوع می‌کنند.                                |   1   | D/V  |
| 7.7.2 | تأیید کنید که درخواست‌ها برای تلاش‌های ایجاد جعل هویت، فیلم‌های عمیق جنسی صریح، یا رسانه‌هایی که افراد واقعی را بدون رضایت نشان می‌دهند بررسی و فیلتر می‌شوند.                                     |   2   | D/V  |
| 7.7.3 | تأیید کنید که سیستم از هشینگ ادراکی، تشخیص واترمارک، یا اثرانگشت‌گیری برای جلوگیری از تولید غیرمجاز رسانه‌های دارای حق نشر استفاده می‌کند.                                                         |   2   |  V   |
| 7.7.4 | اطمینان حاصل کنید که تمام رسانه‌های تولید شده به‌صورت رمزنگاری شده امضا شده، علامت‌گذاری شده با واترمارک، یا مجهز به متادیتای منشاء مقاوم در برابر دستکاری برای قابلیت پیگیری در مراحل بعدی باشند. |   3   | D/V  |
| 7.7.5 | تأیید کنید که تلاش‌های دورزدن (مانند پوشاندن درخواست، استفاده از زبان عامیانه، جملات خصمانه) شناسایی، ثبت و نرخ محدود می‌شوند؛ سوء استفاده مکرر به سیستم‌های نظارتی گزارش داده می‌شود.             |   3   |  V   |

## مراجع

* [NIST AI Risk Management Framework](https://www.nist.gov/itl/ai-risk-management-framework)
* [ISO/IEC 42001:2023 – AI Management System](https://www.iso.org/obp/ui/en/)
* [OWASP Top-10 for Large Language Model Applications (2025)](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Improper Output Handling – OWASP LLM05:2025](https://genai.owasp.org/llmrisk/llm052025-improper-output-handling/)
* [Practical Techniques to Constrain LLM Output](https://mychen76.medium.com/practical-techniques-to-constraint-llm-output-in-json-format-e3e72396c670)
* [Dataiku – Structured Text Generation Guide](https://blog.dataiku.com/your-guide-to-structured-text-generation)
* [VL-Uncertainty: Detecting Hallucinations](https://arxiv.org/abs/2411.11919)
* [HaDeMiF: Hallucination Detection & Mitigation](https://openreview.net/forum?id=VwOYxPScxB)
* [Building Confidence in LLM Outputs](https://www.alkymi.io/data-science-room/building-confidence-in-llm-outputs)
* [Explainable AI & LLMs](https://duncsand.medium.com/explainable-ai-140912d31b3b)
* [LLM Red-Teaming Guide](https://www.confident-ai.com/blog/red-teaming-llms-a-step-by-step-guide)
* [Sensitive Information Disclosure in LLMs](https://virtualcyberlabs.com/llm-sensitive-information-disclosure/)
* [LangChain – Chat Model Rate Limiting](https://python.langchain.com/docs/how_to/chat_model_rate_limiting/)
* [OpenAI Rate-Limit & Exponential Back-off](https://hackernoon.com/openais-rate-limit-a-guide-to-exponential-backoff-for-llm-evaluation)
* [Arize AI – LLM Observability Platform](https://arize.com/)

