# امنیت زنجیره تأمین C6 برای مدل‌ها، چارچوب‌ها و داده‌ها

## هدف کنترل

حملات زنجیره تامین هوش مصنوعی از مدل‌ها، چارچوب‌ها یا مجموعه‌داده‌های شخص ثالث سوءاستفاده می‌کنند تا درهای پشتی، تعصب یا کدهای آسیب‌پذیر را جاسازی کنند. این کنترل‌ها حفاظت کامل از منشا داده‌ها، مدیریت آسیب‌پذیری‌ها و نظارت را برای محافظت از کل چرخه عمر مدل فراهم می‌کنند.

---

## C6.1 بررسی مدل آموزش‌دیده پیشین و منشأ آن

پیش از هرگونه تنظیم دقیق یا استقرار، مبدا مدل‌های شخص ثالث، مجوزها و رفتارهای پنهان آن‌ها را ارزیابی و تأیید کنید.

|   #   | Description                                                                                                                                                   | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.1.1 | اطمینان حاصل کنید که هر اثر مدلی از طرف سوم شامل یک رکورد منشأ امضا شده است که مخزن منبع و هش تعهد را شناسایی می‌کند.                                         |   1   | D/V  |
| 6.1.2 | اطمینان حاصل شود که مدل‌ها قبل از واردات با استفاده از ابزارهای خودکار برای لایه‌های مخرب یا محرک‌های تروجان اسکن شده‌اند.                                    |   1   | D/V  |
| 6.1.3 | اطمینان حاصل کنید که آموزش دقیق مبتنی بر انتقال یادگیری، آزمایشات ضد جعل را برای شناسایی رفتارهای پنهان با موفقیت پشت سر می‌گذارد.                            |   2   |  D   |
| 6.1.4 | تأیید کنید که مجوزهای مدل، برچسب‌های کنترل صادرات و اظهارات منبع داده در یک ورودی ML-BOM ثبت شده‌اند.                                                         |   2   |  V   |
| 6.1.5 | اطمینان حاصل کنید که مدل‌های پرخطر (وزن‌های بارگذاری شده به صورت عمومی، سازندگان تأیید نشده) تا زمان بررسی و تأیید نهایی توسط انسان در قرنطینه باقی می‌مانند. |   3   | D/V  |

---

## C6.2 اسکن چارچوب و کتابخانه

به طور مداوم فریمورک‌ها و کتابخانه‌های یادگیری ماشین را برای آسیب‌پذیری‌های امنیتی (CVE) و کدهای مخرب اسکن کنید تا پشته اجرای برنامه ایمن باقی بماند.

|   #   | Description                                                                                                                    | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 6.2.1 | اطمینان حاصل کنید که خطوط لوله CI اسکنرهای وابستگی را بر روی چارچوب‌های هوش مصنوعی و کتابخانه‌های حیاتی اجرا می‌کنند.          |   1   | D/V  |
| 6.2.2 | تأیید کنید که آسیب‌پذیری‌های بحرانی (CVSS ≥ 7.0) مانع ارتقاء به تصاویر تولید می‌شوند.                                          |   1   | D/V  |
| 6.2.3 | اطمینان حاصل کنید که تحلیل استاتیک کد روی کتابخانه‌های یادگیری ماشین تفکیک‌شده (forked) یا وارد شده (vendored) اجرا می‌شود.    |   2   |  D   |
| 6.2.4 | اطمینان حاصل کنید که پیشنهادهای ارتقاء چارچوب شامل ارزیابی تأثیر امنیتی هستند که به خوراک‌های عمومی CVE ارجاع می‌دهد.          |   2   |  V   |
| 6.2.5 | تأیید کنید که حسگرهای زمان اجرا در صورت بارگذاری‌های غیرمنتظره کتابخانه‌های پویا که از SBOM امضا شده انحراف دارند، هشدار دهند. |   3   |  V   |

---

## C6.3 پین کردن و تأیید وابستگی‌ها

هر وابستگی را به شناسه‌های قطعی غیرقابل تغییر پین کنید و بازسازی‌های بیلد را انجام دهید تا تضمین شود که آثار تولید شده یکسان و دست‌نخورده هستند.

|   #   | Description                                                                                                                         | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.3.1 | اطمینان حاصل کنید که همه مدیران بسته نسخه‌ها را از طریق فایل‌های قفل شده اسیر می‌کنند.                                              |   1   | D/V  |
| 6.3.2 | بررسی کنید که در ارجاعات کانتینر، به جای برچسب‌های قابل تغییر، از خلاصه‌های غیرقابل تغییر استفاده شده باشد.                         |   1   | D/V  |
| 6.3.3 | اطمینان حاصل کنید که بررسی‌های ساخت قابل تولید، هش‌ها را در بین اجراهای CI مقایسه می‌کنند تا خروجی‌های یکسان تضمین شود.             |   2   |  D   |
| 6.3.4 | اطمینان حاصل کنید که تصدیق‌های ساخت به مدت ۱۸ ماه برای ردیابی حسابرسی ذخیره می‌شوند.                                                |   2   |  V   |
| 6.3.5 | تأیید کنید که وابستگی‌های منقضی شده، درخواست‌های بازبینی خودکار (PR) برای به‌روزرسانی یا انشعاب نسخه‌های تثبیت شده را فعال می‌کنند. |   3   |  D   |

---

## C6.4 اجرای منبع قابل اعتماد

اجازه دانلود آثار فقط از منابع رمزنگاری‌شده و مورد تایید سازمان را بدهید و همه منابع دیگر را مسدود کنید.

|   #   | Description                                                                                                         | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.4.1 | اطمینان حاصل کنید که وزن‌های مدل، داده‌ها و کانتینرها فقط از دامنه‌های تأیید شده یا مخازن داخلی دانلود شوند.        |   1   | D/V  |
| 6.4.2 | اطمینان حاصل کنید که امضاهای Sigstore/Cosign هویت ناشر را قبل از ذخیره محلی مصنوعات تأیید می‌کنند.                  |   1   | D/V  |
| 6.4.3 | تأیید کنید که پراکسی‌های خروجی دانلودهای بدون احراز هویت آثار را مسدود می‌کنند تا سیاست منبع قابل اعتماد اعمال شود. |   2   |  D   |
| 6.4.4 | اطمینان حاصل کنید که فهرست‌های مجاز مخزن به صورت فصلی بازبینی می‌شوند و هر مورد دارای دلیل تجاری مستند باشد.        |   2   |  V   |
| 6.4.5 | اطمینان حاصل کنید که نقض‌های سیاست باعث قرنطینه شدن مصنوعات و بازگردانی اجرای خط لوله‌های وابسته می‌شود.            |   3   |  V   |

---

## C6.5 ارزیابی ریسک داده‌های شخص ثالث

داده‌های خارجی را از نظر تزریق داده‌های مخرب، سوگیری و تطابق قانونی ارزیابی کرده و در طول چرخه عمر آن‌ها را پایش کنید.

|   #   | Description                                                                                                                         | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.5.1 | اطمینان حاصل کنید که داده‌های خارجی تحت ارزیابی ریسک مسمومیت قرار می‌گیرند (به‌عنوان مثال، اثرانگشت داده‌ها، تشخیص نقطه دورافتاده). |   1   | D/V  |
| 6.5.2 | اطمینان حاصل کنید که معیارهای تبعیض (برابری جمعیتی، فرصت برابر) قبل از تأیید مجموعه داده‌ها محاسبه شده‌اند.                         |   1   |  D   |
| 6.5.3 | اطمینان حاصل کنید که مبدأ و شرایط مجوز برای مجموعه داده‌ها در ورودی‌های ML‑BOM ثبت شده‌اند.                                         |   2   |  V   |
| 6.5.4 | اطمینان حاصل شود که پایش دوره‌ای، انحراف یا فساد در مجموعه داده‌های میزبانی شده را شناسایی می‌کند.                                  |   2   |  V   |
| 6.5.5 | اطمینان حاصل کنید که محتوای غیرمجاز (حق نشر، اطلاعات شناسایی شخصی) قبل از آموزش از طریق پاک‌سازی خودکار حذف شده است.                |   3   |  D   |

---

## C6.6 نظارت بر حملات زنجیره تامین

تهدیدهای زنجیره تامین را از طریق خوراک‌های CVE، تحلیل‌های گزارش‌های حسابرسی و شبیه‌سازی‌های تیم قرمز به موقع تشخیص دهید.

|   #   | Description                                                                                                                                               | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.6.1 | تأیید کنید که لاگ‌های حسابرسی CI/CD به طور مستقیم به تشخیص‌های SIEM برای کشیدن بسته‌های غیرعادی یا مراحل ساخت دستکاری شده ارسال می‌شوند.                  |   1   |  V   |
| 6.6.2 | اطمینان حاصل کنید که دستورالعمل‌های پاسخ به حادثه شامل روش‌های بازگرداندن برای مدل‌ها یا کتابخانه‌های آسیب‌دیده باشد.                                     |   2   |  D   |
| 6.6.3 | تأیید کنید که برچسب‌های غنی‌سازی اطلاعات تهدید شاخص‌های خاص یادگیری ماشین (مانند شاخص‌های مرتبط با مسموم‌سازی مدل) را در بررسی هشدار علامت‌گذاری می‌کنند. |   3   |  V   |

---

## C6.7 ML‑BOM برای آثار مدل

نسخه‌های مفصل و مخصوص ماشین لرنینگ از SBOM (ML-BOM) تولید و امضا کنید تا مصرف‌کنندگان سپس قادر باشند در زمان استقرار صحت اجزاء را تأیید کنند.

|   #   | Description                                                                                                                                                             | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 6.7.1 | اطمینان حاصل کنید که هر آرتیفکت مدل یک ML-BOM منتشر می‌کند که مجموعه داده‌ها، وزن‌ها، فرابرنامه‌ها و مجوزها را فهرست می‌کند.                                            |   1   | D/V  |
| 6.7.2 | بررسی کنید که تولید ML-BOM و امضای Cosign به صورت خودکار در CI انجام می‌شود و برای ادغام الزامی است.                                                                    |   1   | D/V  |
| 6.7.3 | اطمینان حاصل کنید که بررسی‌های کامل بودن ML-BOM در صورت فقدان هرگونه فراداده کامپوننت (هش، مجوز) ساخت را متوقف می‌کنند.                                                 |   2   |  D   |
| 6.7.4 | اطمینان حاصل کنید که مصرف‌کنندگان پایین‌دست می‌توانند از طریق API، لیست مواد ماشین یادگیری (ML-BOMs) را برای اعتبارسنجی مدل‌های وارد شده در زمان استقرار، پرس‌وجو کنند. |   2   |  V   |
| 6.7.5 | اطمینان حاصل کنید که ML-BOMها نسخه‌بندی شده و با استفاده از مقایسه تغییرات (diff) کنترل می‌شوند تا تغییرات غیرمجاز شناسایی شوند.                                        |   3   |  V   |

---

## مراجع

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)

