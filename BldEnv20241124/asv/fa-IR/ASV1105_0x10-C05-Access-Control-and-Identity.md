# کنترل دسترسی C5 و هویت برای اجزاء و کاربران هوش مصنوعی

## هدف کنترل

کنترل دسترسی موثر برای سیستم‌های هوش مصنوعی نیازمند مدیریت هویت قوی، مجوزدهی آگاه به زمینه و اجرای زمان اجرا بر اساس اصول اعتماد صفر است. این کنترل‌ها تضمین می‌کنند که انسان‌ها، خدمات و عوامل خودکار تنها در محدوده‌های صریحاً مجاز، با مدل‌ها، داده‌ها و منابع محاسباتی تعامل داشته باشند، با قابلیت‌های تأیید و حسابرسی مستمر.

---

## C5.1 مدیریت هویت و احراز هویت

شناسایی‌های مبتنی بر رمزنگاری را برای تمام موجودیت‌ها با استفاده از احراز هویت چندعاملی برای عملیات دارای امتیاز ویژه برقرار کنید.

|   #   | Description                                                                                                                                                                                                                                        | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.1.1 | اطمینان حاصل کنید که تمامی کاربران انسانی و سرویس پرینسیپل‌ها از طریق یک ارائه‌دهنده هویت سازمانی مرکزی (IdP) با استفاده از پروتکل‌های OIDC/SAML احراز هویت می‌کنند، با نگاشت‌های منحصربه‌فرد هویت به توکن (بدون حساب‌ها یا اعتبارنامه‌های مشترک). |   1   | D/V  |
| 5.1.2 | تأیید کنید که عملیات‌های پرخطر (مانند استقرار مدل، صادرات وزن، دسترسی به داده‌های آموزش، تغییرات پیکربندی در محیط تولید) نیازمند احراز هویت چندعاملی یا احراز هویت مرحله‌ای با تأیید مجدد نشست باشند.                                              |   1   | D/V  |
| 5.1.3 | تأیید کنید که مدیران جدید پیش از دریافت دسترسی به سیستم‌های تولید، هویت خود را با استاندارد NIST 800-63-3 IAL-2 یا استانداردهای معادل آن احراز هویت کنند.                                                                                          |   2   |  D   |
| 5.1.4 | اطمینان حاصل کنید که بررسی‌های دسترسی به صورت فصلی انجام می‌شوند و شناسایی خودکار حساب‌های غیرفعال، اعمال گردش اعتبارنامه و فرایندهای لغو دسترسی نیز انجام می‌گیرد.                                                                                |   2   |  V   |
| 5.1.5 | تأیید کنید که عوامل هوش مصنوعی فدرال از طریق اظهارات JWT امضا شده احراز هویت می‌کنند که حداکثر طول عمر آن‌ها ۲۴ ساعت است و شامل اثبات رمزنگاری شده مبدا می‌باشد.                                                                                   |   3   | D/V  |

---

## C5.2 مجوز دسترسی منابع و حداقل امتیاز

پیاده‌سازی کنترل‌های دسترسی دقیق برای تمام منابع هوش مصنوعی با استفاده از مدل‌های اجازه‌نامه صریح و ردگیری‌های حسابرسی.

|   #   | Description                                                                                                                                                                                                                                                               | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.2.1 | تأیید کنید که هر منبع هوش مصنوعی (مجموعه داده‌ها، مدل‌ها، نقاط پایانی، مجموعه‌های برداری، شاخص‌های تعبیه، نمونه‌های محاسباتی) کنترل دسترسی مبتنی بر نقش را با فهرست‌های مجاز صریح و سیاست‌های پیش‌فرض ممنوع اجرا می‌کند.                                                  |   1   | D/V  |
| 5.2.2 | اطمینان حاصل کنید که اصول حداقل امتیاز به طور پیش‌فرض برای حساب‌های سرویس اعمال شده‌اند، به طوری که دسترسی‌ها از مجوزهای فقط‌خواندنی آغاز شده و برای دسترسی نوشتن توجیه تجاری مستند شده مورد نیاز باشد.                                                                   |   1   | D/V  |
| 5.2.3 | اطمینان حاصل کنید که تمام تغییرات کنترل دسترسی به درخواست‌های تغییر تأیید شده مرتبط هستند و به صورت غیرقابل تغییر با زمان‌سنجی، هویت بازیگران، شناسه‌های منابع و اختلافات مجوزی ثبت شده‌اند.                                                                              |   1   |  V   |
| 5.2.4 | اطمینان حاصل کنید که برچسب‌های طبقه‌بندی داده‌ها (اطلاعات شخصی قابل شناسایی، اطلاعات سلامت محافظت‌شده، کنترل شده برای صادرات، مالکیتی) به‌طور خودکار به منابع مشتق‌شده (برداشت‌ها، حافظه‌های نهان پرس‌وجو، خروجی مدل) منتقل شده و اجرای سیاست به‌صورت یکسان اعمال می‌شود. |   2   |  D   |
| 5.2.5 | تأیید کنید که تلاش‌های دسترسی غیرمجاز و رویدادهای افزایش امتیاز دسترسی، هشدارهای زمان واقعی با متاداده‌های متنی به سیستم‌های SIEM ظرف ۵ دقیقه ارسال می‌کنند.                                                                                                              |   2   | D/V  |

---

## C5.3 ارزیابی پویا سیاست

پیاده‌سازی موتورهای کنترل دسترسی مبتنی بر ویژگی (ABAC) برای تصمیم‌گیری‌های مجوزدهی مبتنی بر زمینه همراه با قابلیت‌های حسابرسی.

|   #   | Description                                                                                                                                                                             | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.3.1 | تأیید کنید که تصمیم‌های مجوزدهی به یک موتور سیاست اختصاصی (مثل OPA، Cedar یا معادل آن) که از طریق APIهای احراز هویت شده و با حفاظت از صحت رمزنگاری شده قابل دسترسی است، واگذار شده‌اند. |   1   | D/V  |
| 5.3.2 | تأیید کنید که سیاست‌ها صفات پویا را در زمان اجرا ارزیابی می‌کنند، از جمله سطح صلاحیت کاربر، طبقه‌بندی حساسیت منبع، زمینه درخواست، جداسازی مستأجر و محدودیت‌های زمانی.                   |   1   | D/V  |
| 5.3.3 | اطمینان حاصل کنید که تعریف‌های سیاست‌ها کنترل نسخه شده، بررسی همتا انجام شده و از طریق تست‌های خودکار در خطوط لوله CI/CD قبل از استقرار در محیط تولید اعتبارسنجی شده‌اند.               |   2   |  D   |
| 5.3.4 | اطمینان حاصل کنید که نتایج ارزیابی سیاست شامل توجیهات ساختاریافته تصمیم‌گیری بوده و برای تحلیل همبستگی و گزارش‌دهی انطباق به سیستم‌های SIEM ارسال می‌شوند.                              |   2   |  V   |
| 5.3.5 | اطمینان حاصل کنید که مقادیر زمان زندگی (TTL) کش سیاست برای منابع با حساسیت بالا از ۵ دقیقه و برای منابع استاندارد با قابلیت ابطال کش از ۱ ساعت تجاوز نکند.                              |   3   | D/V  |

---

## اجرای امنیت در زمان پرس‌وجو C5.4

پیاده‌سازی کنترل‌های امنیتی در لایه بانک اطلاعاتی با فیلترینگ اجباری و سیاست‌های امنیتی در سطح سطر.

|   #   | Description                                                                                                                                                                                                     | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.4.1 | اطمینان حاصل کنید که همه‌ی پرس‌وجوهای پایگاه داده‌های برداری و SQL شامل فیلترهای امنیتی اجباری (شناسه مستاجر، برچسب‌های حساسیت، دامنه کاربری) هستند که در سطح موتور پایگاه داده اعمال می‌شوند، نه در کد برنامه. |   1   | D/V  |
| 5.4.2 | تأیید کنید که سیاست‌های امنیت در سطح سطر (RLS) و ماسک‌گذاری در سطح فیلد با ارث‌بری سیاست برای همه پایگاه‌های داده برداری، شاخص‌های جستجو، و مجموعه داده‌های آموزشی فعال شده‌اند.                                |   1   | D/V  |
| 5.4.3 | تأیید کنید که ارزیابی‌های ناموفق مجوز، با بلافاصله متوقف کردن پرس‌وجوها و بازگرداندن کدهای خطای مجوز صریح به‌جای بازگرداندن مجموعه نتایج خالی، از حملات «نماینده گیج شده» جلوگیری می‌کنند.                      |   2   |  D   |
| 5.4.4 | تأیید کنید که تأخیر در ارزیابی سیاست به طور مداوم با هشدارهای خودکار برای شرایط تایم‌اوت که ممکن است منجر به دورزدن مجوز شود، نظارت می‌شود.                                                                     |   2   |  V   |
| 5.4.5 | تأیید کنید که مکانیزم‌های تلاش مجدد کوئری سیاست‌های مجوز را مجدداً ارزیابی می‌کنند تا تغییرات دینامیکی مجوزها را در طول جلسات فعال کاربران در نظر بگیرند.                                                       |   3   | D/V  |

---

## فیلتر خروجی C5.5 و جلوگیری از از دست رفتن داده‌ها

پیاده‌سازی کنترل‌های پس‌پردازش برای جلوگیری از افشای غیرمجاز داده‌ها در محتوای تولید شده توسط هوش مصنوعی.

|   #   | Description                                                                                                                                                                                           | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.5.1 | اطمینان حاصل کنید که مکانیزم‌های فیلتر کردن پس از استنتاج، اطلاعات شناسایی شخصی (PII) غیرمجاز، اطلاعات طبقه‌بندی شده و داده‌های مالکیتی را پیش از ارائه محتوا به درخواست‌کنندگان، اسکن و حذف می‌کنند. |   1   | D/V  |
| 5.5.2 | اطمینان حاصل کنید که استنادها، مراجع و نسبت‌های منبع در خروجی‌های مدل بر اساس مجوزهای فراخواننده بررسی شده و در صورت شناسایی دسترسی غیرمجاز حذف شوند.                                                 |   1   | D/V  |
| 5.5.3 | اطمینان حاصل کنید که محدودیت‌های قالب خروجی (PDFهای پاک‌سازی‌شده، تصاویر بدون متادیتا، انواع فایل‌های تأیید شده) بر اساس سطوح دسترسی کاربران و طبقه‌بندی داده‌ها اعمال می‌شوند.                       |   2   |  D   |
| 5.5.4 | اطمینان حاصل کنید که الگوریتم‌های سانسور قطعی، کنترل نسخه شده و دارای ثبت گزارش‌های حسابرسی برای پشتیبانی از تحقیقات تطبیقی و تحلیل‌های جرم‌شناسی هستند.                                              |   2   |  V   |
| 5.5.5 | تأیید کنید که رویدادهای حذف اطلاعات با ریسک بالا، گزارش‌های تطبیقی تولید می‌کنند که شامل هش‌های رمزنگاری‌شده از محتوای اصلی برای بازیابی قضایی بدون افشای داده‌ها هستند.                              |   3   |  V   |

---

## C5.6 جداسازی چند مستاجری

اطمینان از جداسازی رمزنگاری و منطقی بین مستأجران در زیرساخت مشترک هوش مصنوعی.

|   #   | Description                                                                                                                                                                                                             | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.6.1 | تأیید کنید که فضای حافظه، مخازن جاسازی، ورودی‌های کش و فایل‌های موقت به‌صورت جداگانه براساس فضای نام (namespace) برای هر مستأجر (tenant) نگهداری می‌شوند و پاک‌سازی امن در هنگام حذف مستأجر یا پایان جلسه انجام می‌شود. |   1   | D/V  |
| 5.6.2 | تأیید کنید که هر درخواست API شامل یک شناسه مستأجر احراز هویت شده باشد که به صورت رمزنگاری شده در برابر زمینه جلسه و مجوزهای کاربر اعتبارسنجی شده است.                                                                   |   1   | D/V  |
| 5.6.3 | اطمینان حاصل کنید که سیاست‌های شبکه قوانین پیش‌فرض-رد برای ارتباطات بین مستأجران در شبکه‌های خدمات و پلتفرم‌های ارکستراسیون کانتینر را پیاده‌سازی می‌کنند.                                                              |   2   |  D   |
| 5.6.4 | تأیید کنید که کلیدهای رمزنگاری برای هر مستأجر منحصر به فرد هستند با پشتیبانی از کلید مدیریت شده توسط مشتری (CMK) و جداسازی رمزنگاری شده بین مخازن داده‌های مستأجر.                                                      |   3   |  D   |

---

## C5.7 مجوز عامل خودمختار

کنترل دسترسی‌ها برای عامل‌های هوش مصنوعی و سیستم‌های خودران از طریق نشانه‌های قابلیت با حوزه محدود و مجوزدهی مداوم.

|   #   | Description                                                                                                                                                                                                               | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.7.1 | اطمینان حاصل کنید که عامل‌های خودران توکن‌های قابلیت محدود شده‌ای دریافت می‌کنند که به‌صراحت اقدامات مجاز، منابع قابل دسترسی، محدوده‌های زمانی و محدودیت‌های عملیاتی را فهرست می‌کند.                                     |   1   | D/V  |
| 5.7.2 | تأیید کنید که امکانات با ریسک بالا (دسترسی به سیستم فایل، اجرای کد، فراخوانی APIهای خارجی، تراکنش‌های مالی) به‌صورت پیش‌فرض غیرفعال هستند و برای فعال‌سازی آن‌ها نیاز به مجوزهای صریح همراه با توجیهات کسب‌وکاری می‌باشد. |   1   | D/V  |
| 5.7.3 | اطمینان حاصل کنید که توکن‌های قابلیت به جلسات کاربری متصل شده‌اند، حفاظت از صحت رمزنگاری را شامل می‌شوند و تضمین کنید که در سناریوهای آفلاین نمی‌توان آنها را ذخیره یا مجدداً استفاده کرد.                                |   2   |  D   |
| 5.7.4 | اطمینان حاصل کنید که اقدامات آغازشده توسط نماینده از طریق موتور سیاست ABAC با ارزیابی کامل زمینه و ضبط گزارش‌های حسابرسی، مجوز ثانویه دریافت می‌کنند.                                                                     |   2   |  V   |
| 5.7.5 | تأیید کنید که شرایط خطای عامل و مدیریت استثناها شامل اطلاعات محدوده قابلیت برای پشتیبانی از تحلیل حادثه و بررسی‌های جنایی می‌باشد.                                                                                        |   3   |  V   |

---

## مراجع

### استانداردها و چارچوب‌ها

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### راهنمای پیاده‌سازی

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### امنیت مخصوص هوش مصنوعی

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)

