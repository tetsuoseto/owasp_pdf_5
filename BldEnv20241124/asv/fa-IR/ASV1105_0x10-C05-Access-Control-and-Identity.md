# کنترل دسترسی C5 و هویت برای اجزا و کاربران هوش مصنوعی

## هدف کنترل

کنترل دسترسی مؤثر برای سیستم‌های هوش مصنوعی نیازمند مدیریت هویت قوی، احراز هویت مبتنی بر زمینه و اجرای زمان واقعی مطابق با اصول اعتماد صفر است. این کنترل‌ها تضمین می‌کنند که انسان‌ها، سرویس‌ها و عامل‌های خودمختار تنها در محدوده‌های صریحاً اعطا شده با مدل‌ها، داده‌ها و منابع محاسباتی تعامل داشته باشند، همراه با توانایی‌های تأیید و حسابرسی مستمر.

---

## C5.1 مدیریت هویت و احراز هویت

ایجاد هویت‌های رمزنگاری‌شده برای تمام موجودیت‌ها با احراز هویت چندعاملی برای عملیات‌های دارای امتیاز ویژه.

|   #   | Description                                                                                                                                                                                                                                    | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.1.1 | اطمینان حاصل کنید که همه کاربران انسانی و اصول خدمات از طریق یک ارائه‌دهنده هویت سازمانی متمرکز (IdP) با استفاده از پروتکل‌های OIDC/SAML احراز هویت می‌کنند و نگاشت‌های منحصر به فرد هویت به توکن دارند (حساب‌ها یا مدارک اشتراکی وجود ندارد). |   1   | D/V  |
| 5.1.2 | اطمینان حاصل کنید که عملیات‌های پرخطر (استقرار مدل، صادرات وزن، دسترسی به داده‌های آموزشی، تغییرات تنظیمات تولید) نیازمند احراز هویت چندعاملی یا احراز هویت مرحله‌ای با اعتبارسنجی مجدد جلسه باشند.                                            |   1   | D/V  |
| 5.1.3 | تأیید کنید که مدیران جدید قبل از دریافت دسترسی به سیستم تولید، فرآیند احراز هویت هویتی را مطابق با استاندارد NIST 800-63-3 IAL-2 یا استانداردهای معادل آن گذرانده باشند.                                                                       |   2   |  D   |
| 5.1.4 | اطمینان حاصل کنید که بررسی‌های دسترسی به صورت فصلی انجام می‌شوند و شامل شناسایی خودکار حساب‌های غیرفعال، اعمال چرخش مدارک احراز هویت، و گردش‌های کاری حذف دسترسی هستند.                                                                        |   2   |  V   |
| 5.1.5 | اطمینان حاصل کنید که عوامل فدرال AI از طریق ادعاهای JWT امضا شده که حداکثر عمر آنها 24 ساعت است و شامل اثبات رمزنگاری مبدا می‌باشند، احراز هویت می‌کنند.                                                                                       |   3   | D/V  |

---

## C5.2 مجوز دسترسی به منابع و حداقل امتیاز

پیاده‌سازی کنترل‌های دسترسی دقیق برای تمام منابع هوش مصنوعی با مدل‌های اجازه صریح و رد پای حسابرسی.

|   #   | Description                                                                                                                                                                                                                 | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.2.1 | تأیید کنید که هر منبع هوش مصنوعی (مجموعه داده‌ها، مدل‌ها، نقاط پایان، مجموعه‌های برداری، شاخص‌های جاسازی، نمونه‌های محاسباتی) کنترل‌های دسترسی مبتنی بر نقش را با فهرست‌های اجازه صریح و سیاست‌های پیش‌فرض رد اعمال می‌کند. |   1   | D/V  |
| 5.2.2 | تأیید کنید که اصول حداقل امتیاز به طور پیش‌فرض در حساب‌های خدماتی اعمال می‌شود، به طوری که مجوزها از دسترسی فقط خواندنی شروع شده و برای دسترسی نوشتنی دلیل کسب‌وکار مستند شده لازم است.                                     |   1   | D/V  |
| 5.2.3 | تأیید کنید که تمام تغییرات کنترل دسترسی به درخواست‌های تغییر تأییدشده مرتبط شده و به‌طور غیرقابل تغییر با زمان‌سنجی‌ها، هویت بازیگران، شناسه‌های منابع، و تغییرات مجوز ثبت شده‌اند.                                         |   1   |  V   |
| 5.2.4 | تأیید کنید که برچسب‌های طبقه‌بندی داده‌ها (PII، PHI، کنترل‌شده برای صادرات، مالکیتی) به‌طور خودکار به منابع مشتق شده (نمایه‌ها، کش‌های پرسش، خروجی‌های مدل) با اعمال سیاست منسجم منتقل می‌شوند.                             |   2   |  D   |
| 5.2.5 | تأیید کنید که تلاش‌های دسترسی غیرمجاز و رویدادهای افزایش امتیازات، هشدارهای بلادرنگ با متاداده‌های زمینه‌ای را ظرف ۵ دقیقه به سیستم‌های SIEM ارسال می‌کنند.                                                                 |   2   | D/V  |

---

## C5.3 ارزیابی دینامیک سیاست

استفاده از موتورهای کنترل دسترسی مبتنی بر ویژگی (ABAC) برای تصمیم‌گیری‌های مجوزدهی مبتنی بر زمینه با قابلیت‌های حسابرسی را پیاده‌سازی کنید.

|   #   | Description                                                                                                                                                                                      | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 5.3.1 | تأیید کنید که تصمیمات مجوزدهی به یک موتور سیاست اختصاصی (مانند OPA، Cedar یا معادل آن) که از طریق APIهای احراز هویت شده و با حفاظت از یکپارچگی رمزنگاری‌شده قابل دسترسی است، برون‌سپاری شده‌اند. |   1   | D/V  |
| 5.3.2 | اطمینان حاصل کنید که سیاست‌ها صفات پویا را در زمان اجرا ارزیابی می‌کنند، از جمله سطح مجوز کاربر، طبقه‌بندی حساسیت منبع، زمینه درخواست، جداسازی مستاجر و محدودیت‌های زمانی.                       |   1   | D/V  |
| 5.3.3 | تأیید کنید که تعاریف سیاست‌ها کنترل نسخه شده، بازبینی همتا شده و از طریق آزمایش خودکار در خطوط لوله CI/CD قبل از استقرار در محیط تولید اعتبارسنجی شده‌اند.                                       |   2   |  D   |
| 5.3.4 | اطمینان حاصل کنید که نتایج ارزیابی سیاست شامل دلایل ساختاریافته تصمیم‌گیری هستند و به سیستم‌های SIEM برای تحلیل همبستگی و گزارش‌دهی انطباق منتقل می‌شوند.                                        |   2   |  V   |
| 5.3.5 | اطمینان حاصل کنید که مقادیر زمان حیات (TTL) کش سیاست‌ها برای منابع با حساسیت بالا بیش از ۵ دقیقه و برای منابع استاندارد با قابلیت ابطال کش بیش از ۱ ساعت نباشد.                                  |   3   | D/V  |

---

## اجرای امنیت در زمان پرس‌وجو C5.4

اجرای کنترل‌های امنیتی در لایه پایگاه داده با فیلتر اجباری و سیاست‌های امنیت سطح سطر.

|   #   | Description                                                                                                                                                                                       | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.4.1 | بررسی کنید که تمام پرس‌وجوهای پایگاه داده برداری و SQL شامل فیلترهای امنیتی اجباری (شناسه مستأجر، برچسب‌های حساسیت، حوزه کاربر) باشند که در سطح موتور پایگاه داده اعمال شده‌اند، نه در کد برنامه. |   1   | D/V  |
| 5.4.2 | تأیید کنید که سیاست‌های امنیت در سطح ردیف (RLS) و ماسک‌گذاری در سطح فیلد با وراثت سیاست برای تمامی پایگاه‌های داده برداری، شاخص‌های جستجو و مجموعه داده‌های آموزشی فعال شده‌اند.                  |   1   | D/V  |
| 5.4.3 | تأیید کنید که ارزیابی‌های ناموفق مجوز با متوقف کردن فوری درخواست‌ها و بازگرداندن کدهای خطای مجوز صریح، به جای بازگرداندن مجموعه نتایج خالی، از حملات "نماینده گیج‌شده" جلوگیری می‌کنند.           |   2   |  D   |
| 5.4.4 | تأیید کنید که تأخیر در ارزیابی سیاست به طور مداوم با هشدارهای خودکار برای شرایط تایم‌اوت که می‌تواند امکان دورزدن مجوز را فراهم کند، نظارت می‌شود.                                                |   2   |  V   |
| 5.4.5 | تأیید کنید که مکانیزم‌های تکرار پرس‌وجو سیاست‌های مجوزدهی را مجدداً ارزیابی می‌کنند تا تغییرات پویا در مجوزها را در طول جلسات فعال کاربر در نظر بگیرند.                                           |   3   | D/V  |

---

## فیلتر کردن خروجی C5.5 و جلوگیری از از دست رفتن داده‌ها

استقرار کنترل‌های پس‌پردازش برای جلوگیری از افشای غیرمجاز داده‌ها در محتوای تولید شده توسط هوش مصنوعی.

|   #   | Description                                                                                                                                                                                  | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.5.1 | تأیید کنید که مکانیسم‌های فیلترینگ پس از استنتاج، اطلاعات شناسایی شخصی غیرمجاز (PII)، اطلاعات طبقه‌بندی شده و داده‌های اختصاصی را قبل از ارائه محتوا به درخواست‌کنندگان، اسکن و حذف می‌کنند. |   1   | D/V  |
| 5.5.2 | اطمینان حاصل کنید که استنادها، منابع و نسبت‌دهی‌های منبع در خروجی‌های مدل بر اساس مجوزهای فراخواننده معتبرسازی شده و در صورت شناسایی دسترسی غیرمجاز، حذف شوند.                               |   1   | D/V  |
| 5.5.3 | تأیید کنید که محدودیت‌های فرمت خروجی (فایل‌های PDF پاک‌سازی شده، تصاویر بدون متادیتا، انواع فایل‌های تأیید شده) بر اساس سطوح دسترسی کاربران و طبقه‌بندی داده‌ها اعمال می‌شود.                |   2   |  D   |
| 5.5.4 | تأیید کنید که الگوریتم‌های سانسور (رداکشن) معین، نسخه‌بندی شده و دارای ثبت گزارش‌های ممیزی هستند تا از تحقیقات انطباقی و تحلیل‌های جنایی پشتیبانی کنند.                                      |   2   |  V   |
| 5.5.5 | تأیید کنید که رویدادهای سانسور پرخطر، لاگ‌های تطبیقی ایجاد می‌کنند که شامل هش‌های رمزنگاری شده از محتوای اصلی برای بازیابی قانونی بدون افشای داده‌ها باشد.                                   |   3   |  V   |

---

## C5.6 جداسازی چند مستاجری

اطمینان از جداسازی رمزنگاری و منطقی بین مستأجران در زیرساخت مشترک هوش مصنوعی.

|   #   | Description                                                                                                                                                                                          | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.6.1 | اطمینان حاصل کنید که فضای حافظه، مخازن جاسازی، ورودی‌های کش و فایل‌های موقتی به‌صورت جدا شده بر اساس فضای نام هر مستأجر نگهداری می‌شوند و پاک‌سازی امن هنگام حذف مستأجر یا خاتمه جلسه انجام می‌گیرد. |   1   | D/V  |
| 5.6.2 | تأیید کنید که هر درخواست API شامل شناسه مستأجر احراز هویت‌شده‌ای باشد که به‌صورت رمزنگاری شده در مقابل زمینه جلسه و مجوزهای کاربر اعتبارسنجی شده است.                                                |   1   | D/V  |
| 5.6.3 | تأیید کنید که سیاست‌های شبکه قوانین پیش‌فرض انکار را برای ارتباطات بین مستأجران درون سرویس مش‌ها و پلتفرم‌های ارکستراسیون کانتینر اعمال کرده‌اند.                                                    |   2   |  D   |
| 5.6.4 | اطمینان حاصل کنید که کلیدهای رمزنگاری برای هر مستأجر منحصر به فرد باشند و از کلیدهای مدیریت شده توسط مشتری (CMK) پشتیبانی شود و جداسازی رمزنگاری بین ذخیره‌سازی داده‌های مستأجران برقرار باشد.       |   3   |  D   |

---

## C5.7 مجوز عامل خودران

کنترل مجوزها برای عامل‌های هوش مصنوعی و سیستم‌های خودکار از طریق توکن‌های قابلیت محدوده‌دار و تأیید مداوم.

|   #   | Description                                                                                                                                                                                       | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.7.1 | اطمینان حاصل کنید که عوامل خودکار توکن‌های قابلیت محدوده‌دار دریافت می‌کنند که به‌طور صریح اقدامات مجاز، منابع قابل دسترس، محدودیت‌های زمانی و محدودیت‌های عملیاتی را فهرست می‌کند.               |   1   | D/V  |
| 5.7.2 | اطمینان حاصل کنید که قابلیت‌های پرخطر (دسترسی به سیستم فایل، اجرای کد، تماس با API خارجی، معاملات مالی) به طور پیش‌فرض غیرفعال بوده و برای فعال‌سازی نیاز به مجوزهای صریح با توجیهات تجاری دارند. |   1   | D/V  |
| 5.7.3 | تأیید کنید که توکن‌های قابلیت به نشست‌های کاربری متصل شده‌اند، شامل حفاظت از صحت رمزنگاری شده باشند، و اطمینان حاصل کنید که نتوان آن‌ها را در سناریوهای آفلاین ذخیره یا مجدداً استفاده کرد.       |   2   |  D   |
| 5.7.4 | تأیید کنید که اقدامات شروع‌شده توسط عامل، از طریق موتور سیاست ABAC با ارزیابی کامل زمینه و ثبت گزارش‌های حسابرسی، مورد تأیید ثانویه قرار می‌گیرند.                                                |   2   |  V   |
| 5.7.5 | اطمینان حاصل کنید که شرایط خطاهای عامل و مدیریت استثنا شامل اطلاعات دامنه قابلیت‌ها برای پشتیبانی از تحلیل حادثه و تحقیقات جنایی باشد.                                                            |   3   |  V   |

---

## مراجع

### استانداردها و چهارچوب‌ها

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### راهنمای پیاده‌سازی

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### امنیت ویژه هوش مصنوعی

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)

