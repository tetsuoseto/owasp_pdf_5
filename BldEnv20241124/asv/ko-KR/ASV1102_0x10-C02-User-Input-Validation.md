# C2 사용자 입력 검증

## 제어 목표

사용자 입력에 대한 견고한 검증은 AI 시스템에 대한 가장 치명적인 공격들에 대한 일차 방어선입니다. 프롬프트 인젝션 공격은 시스템 지침을 무력화하거나 민감한 데이터를 유출시키며, 모델을 허용되지 않은 행동으로 유도할 수 있습니다. 전용 필터와 지침 계층이 마련되어 있지 않으면, 연구에 따르면 매우 긴 컨텍스트 창을 악용하는 "멀티샷" 탈옥 공격이 효과적일 것임이 밝혀졌습니다. 또한, 호몰글리프 교체나 리트스픽(leetspeak)과 같은 미묘한 적대적 교란 공격은 모델의 결정을 조용히 변경할 수 있습니다.

---

## C2.1 프롬프트 인젝션 방어

프롬프트 인젝션은 AI 시스템에서 가장 큰 위험 중 하나입니다. 이에 대한 방어는 정적 패턴 필터, 동적 분류기 및 명령 계층 구조 적용의 조합을 사용합니다.

|   #   | Description                                                                                               | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.1.1 | 사용자 입력이 지속적으로 업데이트되는 알려진 프롬프트 인젝션 패턴(탈옥 키워드, "이전 무시", 역할 수행 체인, 간접 HTML/URL 공격) 라이브러리를 통해 검증되는지 확인하십시오.   |   1   | D/V  |
| 2.1.2 | 시스템이 컨텍스트 창 확장 후에도 시스템 또는 개발자 메시지가 사용자 지침을 무시하고 명령 계층을 강제하는지 확인하십시오.                                      |   1   | D/V  |
| 2.1.3 | 적대적 평가 테스트(예: 레드팀 "다수 샷" 프롬프트)가 모든 모델 또는 프롬프트 템플릿 출시 전에 실행되며, 성공률 임계값과 회귀 방지를 위한 자동 차단기가 설정되어 있는지 확인하십시오. |   2   | D/V  |
| 2.1.4 | 타사 콘텐츠(웹 페이지, PDF, 이메일)에서 생성된 프롬프트가 메인 프롬프트에 병합되기 전에 격리된 구문 분석 컨텍스트에서 정제되는지 확인하십시오.                       |   2   |  D   |
| 2.1.5 | 모든 프롬프트 필터 규칙 업데이트, 분류기 모델 버전 및 차단 목록 변경이 버전 관리되고 감사 가능하도록 확인하십시오.                                        |   3   | D/V  |

---

## C2.2 적대적 예제 저항성

자연어 처리(NLP) 모델은 인간이 종종 놓치는 미묘한 문자 또는 단어 수준의 변형에 대해 여전히 취약하며, 이러한 변형을 모델은 잘못 분류하는 경향이 있다.

|   #   | Description                                                                           | Level | Role |
| :---: | ------------------------------------------------------------------------------------- | :---: | :--: |
| 2.2.1 | 기본 입력 정규화 단계(유니코드 NFC, 동형문자 매핑, 공백 제거)가 토크나이제이션 전에 실행되는지 확인하십시오.                      |   1   |  D   |
| 2.2.2 | 통계적 이상 탐지가 언어 규범과 현저히 높은 편집 거리, 과도한 반복 토큰, 또는 비정상적인 임베딩 거리와 같은 입력을 감지하는지 확인하십시오.      |   2   | D/V  |
| 2.2.3 | 추론 파이프라인이 고위험 엔드포인트에 대해 선택적 적대적 훈련 강화 모델 변형 또는 방어 레이어(예: 무작위화, 방어적 증류)를 지원하는지 확인하십시오. |   2   |  D   |
| 2.2.4 | 의심되는 적대적 입력이 격리되고, 전체 페이로드(개인 식별 정보(PII) 삭제 후)와 함께 기록되었는지 확인하십시오.                     |   2   |  V   |
| 2.2.5 | 견고성 지표(알려진 공격 도구 모음의 성공률)가 시간 경과에 따라 추적되며, 회귀가 발생할 경우 릴리스 차단 요인이 되는지 확인하십시오.          |   3   | D/V  |

---

## C2.3 스키마, 타입 및 길이 검증

잘못 형성되었거나 크기가 큰 입력을 포함하는 AI 공격은 구문 분석 오류, 필드 간 프롬프트 누출, 자원 고갈을 일으킬 수 있습니다. 엄격한 스키마 적용은 결정론적 도구 호출을 수행할 때도 필수 조건입니다.

|   #   | Description                                                                                                 | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.3.1 | 모든 API 또는 함수 호출 엔드포인트가 명시적인 입력 스키마(JSON 스키마, Protobuf 또는 다중 모달 동등체)를 정의하고 있으며, 프롬프트 조립 전에 입력이 검증되는지 확인하십시오. |   1   |  D   |
| 2.3.2 | 입력이 최대 토큰 또는 바이트 한도를 초과하는 경우 안전한 오류 메시지로 거부되고 결코 조용히 잘리지 않는지 확인하십시오.                                        |   1   | D/V  |
| 2.3.3 | 유형 검사(예: 숫자 범위, 열거형 값, 이미지/오디오 MIME 유형)가 클라이언트 코드뿐만 아니라 서버 측에서도 반드시 적용되는지 확인하십시오.                           |   2   | D/V  |
| 2.3.4 | 시멘틱 검증기(예: JSON 스키마)가 알고리즘적 서비스 거부(DoS)를 방지하기 위해 상수 시간에 실행되는지 확인하십시오.                                       |   2   |  D   |
| 2.3.5 | 검증 실패가 보안 분류를 지원할 수 있도록 편집된 페이로드 스니펫과 명확한 오류 코드와 함께 기록되는지 확인하십시오.                                           |   3   |  V   |

---

## C2.4 콘텐츠 및 정책 심사

개발자는 허용되지 않은 내용(예: 불법 명령, 혐오 발언, 저작권 있는 텍스트)을 요청하는 구문적으로 유효한 프롬프트를 감지하고, 해당 프롬프트가 확산되는 것을 방지할 수 있어야 합니다.

|   #   | Description                                                                                     | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.4.1 | 모든 입력에 대해 폭력, 자해, 증오, 성적 내용 및 불법 요청을 평가하는 콘텐츠 분류기(제로샷 또는 미세 조정됨)가 있으며, 구성 가능한 임계값을 사용하는지 확인합니다. |   1   |  D   |
| 2.4.2 | 정책을 위반하는 입력은 하류 LLM 호출로 전파되지 않도록 표준화된 거부 또는 안전한 완료를 받는지 확인하십시오.                                 |   1   | D/V  |
| 2.4.3 | 선별 모델 또는 규칙 세트가 최소 분기별로 재학습/업데이트되어 새로 관찰된 탈옥(jailbreak) 또는 정책 우회 패턴을 통합하는지 확인하십시오.              |   2   |  D   |
| 2.4.4 | 요청 시에 해석되는 속성 기반 규칙을 통해 사용자별 정책(나이, 지역 법적 제약 등)이 준수되는지 확인합니다.                                   |   2   |  D   |
| 2.4.5 | 스크리닝 로그에 SOC 상관관계 및 향후 레드팀 재생을 위해 분류기 신뢰도 점수와 정책 카테고리 태그가 포함되어 있는지 확인하십시오.                      |   3   |  V   |

---

## C2.5 입력 속도 제한 및 악용 방지

개발자는 입력 속도를 제한하고 비정상적인 사용 패턴을 감지하여 AI 시스템에 대한 오용, 자원 고갈 및 자동화된 공격을 방지해야 합니다.

|   #   | Description                                                   | Level | Role |
| :---: | ------------------------------------------------------------- | :---: | :--: |
| 2.5.1 | 모든 입력 엔드포인트에 대해 사용자별, IP별, API 키별 속도 제한이 적용되고 있는지 확인하세요.      |   1   | D/V  |
| 2.5.2 | 버스트 및 지속 속도 제한이 DoS 및 무차별 대입 공격을 방지하도록 조정되었는지 확인하십시오.         |   2   | D/V  |
| 2.5.3 | 이상 징후 사용 패턴(예: 급속 요청, 입력 과부하)이 자동 차단 또는 에스컬레이션을 유발하는지 확인하십시오. |   2   | D/V  |
| 2.5.4 | 남용 방지 로그가 보존되고 새로운 공격 패턴에 대해 검토되는지 확인하십시오.                    |   3   |  V   |

---

## C2.6 다중 모드 입력 검증

AI 시스템은 주입, 회피 또는 자원 남용을 방지하기 위해 비텍스트 입력(이미지, 오디오, 파일)에 대한 강력한 검증을 포함해야 합니다.

|   #   | Description                                                    | Level | Role |
| :---: | -------------------------------------------------------------- | :---: | :--: |
| 2.6.1 | 처리 전에 모든 비텍스트 입력(이미지, 오디오, 파일)이 유형, 크기 및 형식에 대해 검증되었는지 확인하십시오. |   1   |  D   |
| 2.6.2 | 파일이 수집되기 전에 악성 코드 및 스테가노그래픽 페이로드에 대해 스캔되었는지 확인하십시오.            |   2   | D/V  |
| 2.6.3 | 이미지/오디오 입력이 적대적 교란 또는 알려진 공격 패턴에 대해 점검되었는지 확인하십시오.             |   2   | D/V  |
| 2.6.4 | 다중 모달 입력 검증 실패가 기록되고 조사 경보를 유발하는지 확인하십시오.                      |   3   |  V   |

---

## C2.7 입력 출처 및 귀속

AI 시스템은 모든 사용자 입력의 출처를 모니터링하고 태그하여 감사, 남용 추적 및 규정 준수를 지원해야 합니다.

|   #   | Description                                                              | Level | Role |
| :---: | ------------------------------------------------------------------------ | :---: | :--: |
| 2.7.1 | 모든 사용자 입력이 수집 시 메타데이터(사용자 ID, 세션, 출처, 타임스탬프, IP 주소)와 함께 태그되어 있는지 확인하십시오. |   1   | D/V  |
| 2.7.2 | 모든 처리된 입력에 대해 출처 메타데이터가 보존되고 감사 가능함을 확인하십시오.                             |   2   | D/V  |
| 2.7.3 | 이상하거나 신뢰할 수 없는 입력 소스가 표시되고 강화된 검사 또는 차단 대상이 되는지 확인하십시오.                  |   2   | D/V  |

---

## C2.8 실시간 적응형 위협 탐지

개발자는 새로운 공격 패턴에 적응하고 컴파일된 패턴 매칭을 통해 실시간 보호를 제공하는 고급 AI 위협 탐지 시스템을 사용해야 합니다.

|   #   | Description                                                                                | Level | Role |
| :---: | ------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.8.1 | 위협 탐지 패턴이 최소한의 지연 영향으로 고성능 실시간 필터링을 위해 최적화된 정규식 엔진으로 컴파일되었는지 확인합니다.                        |   1   | D/V  |
| 2.8.2 | 위협 탐지 시스템이 서로 다른 위협 범주(프롬프트 인젝션, 유해 콘텐츠, 민감한 데이터, 시스템 명령어)에 대해 별도의 패턴 라이브러리를 유지하는지 확인하십시오. |   1   | D/V  |
| 2.8.3 | 적응형 위협 탐지가 공격 빈도와 성공률에 따라 위협 민감도를 업데이트하는 머신러닝 모델을 포함하는지 확인하십시오.                            |   2   | D/V  |
| 2.8.4 | 실시간 위협 인텔리전스 피드가 새로운 공격 서명 및 침해 지표(IOC)로 패턴 라이브러리를 자동으로 업데이트하는지 확인하십시오.                    |   2   | D/V  |
| 2.8.5 | 위협 탐지 오탐률이 지속적으로 모니터링되고, 합법적인 사용 사례 간섭을 최소화하기 위해 패턴 특이성이 자동으로 조정되는지 확인하십시오.                |   3   | D/V  |
| 2.8.6 | 컨텍스트 기반 위협 분석이 입력 소스, 사용자 행동 패턴 및 세션 기록을 고려하여 탐지 정확도를 향상시키는지 검증하십시오.                       |   3   | D/V  |
| 2.8.7 | 위협 탐지 성능 지표(탐지율, 처리 지연 시간, 자원 활용도)가 실시간으로 모니터링되고 최적화되는지 확인하십시오.                            |   3   | D/V  |

---

## C2.9 다중 모드 보안 검증 파이프라인

개발자는 특정 유형의 위협 탐지 및 자원 격리를 통해 텍스트, 이미지, 오디오 및 기타 AI 입력 형태에 대한 보안 검증을 제공해야 합니다.

|   #   | Description                                                                                                      | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.9.1 | 각 입력 모달리티마다 문서화된 위협 패턴(텍스트: 프롬프트 인젝션, 이미지: 스테가노그래피, 오디오: 스펙트로그램 공격)과 탐지 임계값을 갖춘 전용 보안 검증기가 있는지 확인하십시오.           |   1   | D/V  |
| 2.9.2 | 다중 모달 입력이 각 모달리티 유형에 특정된 메모리, CPU, 처리 시간과 같은 정의된 리소스 제한 내에서 격리된 샌드박스에서 처리되며, 이러한 사항이 보안 정책에 문서화되어 있는지 확인하십시오.    |   2   | D/V  |
| 2.9.3 | 크로스 모달 공격 탐지가 상관관계 규칙 및 경고 생성을 통해 여러 입력 유형(예: 이미지 내 스테가노그래픽 페이로드와 텍스트 내 프롬프트 주입이 결합된)에서 발생하는 협력 공격을 식별하는지 검증합니다. |   2   | D/V  |
| 2.9.4 | 다중 모달 검증 실패가 모든 입력 모달리티, 검증 결과, 위협 점수 및 상관 분석을 포함한 상세 로그 생성을 트리거하며 SIEM 통합을 위한 구조화된 로그 형식을 사용하는지 확인하십시오.         |   3   | D/V  |
| 2.9.5 | 형태별 콘텐츠 분류기가 문서화된 일정(최소 분기별)에 따라 새로운 위협 패턴, 적대적 예제 및 기준선 임계값 이상의 성능 벤치마크로 업데이트되는지 확인하십시오.                        |   3   | D/V  |

---

## 참고 문헌

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)

