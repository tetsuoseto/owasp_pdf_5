# C8メモリ、埋め込みベクトルおよびベクトルデータベースのセキュリティ

## 管理目標

埋め込み（エンベディング）とベクトルストアは、現代のAIシステムの「ライブメモリ」として機能し、ユーザーから提供されたデータを継続的に受け入れ、Retrieval-Augmented Generation（RAG）を通じてモデルのコンテキストに再提示します。これらのメモリが管理されていない場合、個人識別情報（PII）が漏洩したり、同意違反が発生したり、元のテキストを再構築されるリスクがあります。この制御ファミリーの目的は、メモリパイプラインとベクトルデータベースを強化し、アクセス権を最小特権に限定し、埋め込み情報のプライバシーを保護し、保存されたベクトルが期限切れとなったり、要求に応じて取り消し可能であり、ユーザーごとのメモリが他のユーザーのプロンプトや生成結果に影響を及ぼさないようにすることです。

---

## C8.1 メモリおよびRAGインデックスに対するアクセス制御

すべてのベクターコレクションに対して細粒度のアクセス制御を強制します。

|   #   | Description                                                                         | Level | Role |
| :---: | ----------------------------------------------------------------------------------- | :---: | :--: |
| 8.1.1 | テナント、コレクション、またはドキュメントタグごとに、行レベル/名前空間レベルのアクセス制御ルールが挿入、削除、およびクエリ操作を制限していることを確認してください。 |   1   | D/V  |
| 8.1.2 | APIキーやJWTがスコープ付きクレーム（例：コレクションID、アクション動詞）を持ち、少なくとも四半期ごとにローテーションされていることを確認してください。     |   1   | D/V  |
| 8.1.3 | 特権昇格試行（例：クロスネームスペース類似性クエリ）が検出され、5分以内にSIEMに記録されることを確認してください。                         |   2   | D/V  |
| 8.1.4 | ベクターデータベースの監査ログが、サブジェクト識別子、操作、ベクターID/名前空間、類似度閾値、および結果数を記録していることを確認してください。           |   2   | D/V  |
| 8.1.5 | エンジンがアップグレードされるか、インデックスシャーディングルールが変更されるたびに、アクセス決定がバイパスの欠陥についてテストされていることを確認してください。   |   3   |  V   |

---

## C8.2 埋め込みのサニタイズと検証

ベクトル化の前にテキストを事前スクリーニングして個人識別情報（PII）を検出し、削除または仮名化し、必要に応じて埋め込みの後処理を行い残存信号を除去します。

|   #   | Description                                                                         | Level | Role |
| :---: | ----------------------------------------------------------------------------------- | :---: | :--: |
| 8.2.1 | PIIおよび規制対象データが自動分類器によって検出され、埋め込み前にマスク処理、トークナイズ、または削除されていることを確認してください。               |   1   | D/V  |
| 8.2.2 | 埋め込みパイプラインが、インデックスを汚染する可能性のある実行可能コードや非UTF-8アーティファクトを含む入力を拒否または隔離することを確認してください。      |   1   |  D   |
| 8.2.3 | 既知のPIIトークンとの距離が設定可能な閾値を下回る文埋め込みに対して、局所的または計量的差分プライバシーのサニタイズ処理が適用されていることを検証してください。   |   2   | D/V  |
| 8.2.4 | サニタイズの有効性（例：個人識別情報（PII）削除の再現率、意味的ドリフト）が、ベンチマークコーパスに対して少なくとも半期ごとに検証されていることを確認してください。 |   2   |  V   |
| 8.2.5 | サニタイズ設定がバージョン管理されており、変更がピアレビューを経ていることを確認してください。                                     |   3   | D/V  |

---

## C8.3 メモリの有効期限切れ、取り消し、および削除

GDPRの「忘れられる権利」および類似の法律は迅速な消去を要求するため、ベクターストアはTTL（有効期間）、ハードデリート、およびトーンストーニングに対応し、取り消されたベクターが回復または再インデックスされないようにする必要があります。

|   #   | Description                                                                             | Level | Role |
| :---: | --------------------------------------------------------------------------------------- | :---: | :--: |
| 8.3.1 | すべてのベクトルおよびメタデータレコードが、TTL（Time To Live）または自動クリーンアップジョブで尊重される明示的な保持ラベルを持っていることを確認してください。 |   1   | D/V  |
| 8.3.2 | ユーザーが開始した削除リクエストが、30日以内にベクトル、メタデータ、キャッシュコピー、および派生インデックスを完全に削除することを検証してください。             |   1   | D/V  |
| 8.3.3 | ハードウェアが対応している場合はストレージブロックの暗号的消去、またはキーボールトの鍵破棄を伴う論理削除が実施されていることを検証してください。                |   2   |  D   |
| 8.3.4 | 期限切れのベクトルが、期限切れ後500ミリ秒以内に最近傍検索結果から除外されることを検証してください。                                     |   3   | D/V  |

---

## C8.4 埋め込みの逆転および漏洩の防止

最近の防御策であるノイズ重畳、射影ネットワーク、プライバシーニューロン摂動、およびアプリケーション層暗号化により、トークンレベルの逆変換率を5%未満に低減できます。

|   #   | Description                                                                                   | Level | Role |
| :---: | --------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.4.1 | 反転攻撃、メンバーシップ推論攻撃、および属性推論攻撃を網羅した正式な脅威モデルが存在し、毎年レビューされていることを確認する。                               |   1   |  V   |
| 8.4.2 | アプリケーション層の暗号化または検索可能な暗号化が、インフラ管理者やクラウドスタッフによるベクトルの直接読み取りから保護していることを検証してください。                  |   2   | D/V  |
| 8.4.3 | 防御パラメータ（差分プライバシーのε、ノイズのσ、射影ランクk）がプライバシー ≥ 99%のトークン保護とユーティリティ ≤ 3%の精度損失のバランスを保っていることを検証してください。 |   3   |  V   |
| 8.4.4 | モデル更新のリリースゲートに反転耐性メトリクスが含まれていることを確認し、回帰予算が定義されていることを確認する。                                     |   3   | D/V  |

---

## C8.5 ユーザー固有メモリに対するスコープ強制

テナント間の情報漏えいは依然として主要なRAGリスクであり、不適切にフィルタリングされた類似性検索が他の顧客の機密ドキュメントを露出させる可能性があります。

|   #   | Description                                                                  | Level | Role |
| :---: | ---------------------------------------------------------------------------- | :---: | :--: |
| 8.5.1 | すべての検索クエリが、LLMプロンプトに渡される前にテナント/ユーザーIDによってポストフィルタリングされていることを確認してください。         |   1   | D/V  |
| 8.5.2 | コレクション名または名前空間付きIDがユーザーまたはテナントごとにソルト処理されていることを確認し、スコープ間でベクトルが衝突しないようにしてください。 |   1   |  D   |
| 8.5.3 | 類似度結果が設定可能な距離閾値を上回り、かつ呼び出し元の範囲外である場合、それらは破棄されセキュリティアラートが発生することを確認してください。     |   2   | D/V  |
| 8.5.4 | マルチテナントのストレステストが、アクセス権外のドキュメントを取得しようとする敵対的クエリをシミュレートし、情報漏洩が全くないことを検証してください。  |   2   |  V   |
| 8.5.5 | 暗号鍵がテナントごとに分離されていることを確認し、物理的なストレージが共有されている場合でも暗号的な分離が確保されていることを保証してください。     |   3   | D/V  |

---

## C8.6 高度なメモリシステムセキュリティ

エピソード記憶、意味記憶、作業記憶を含む高度なメモリアーキテクチャに対する、特定の分離および検証要件を備えたセキュリティ制御。

|   #   | Description                                                                                                         | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.6.1 | 異なるメモリタイプ（エピソード記憶、意味記憶、作業記憶）が、ロールベースのアクセス制御、個別の暗号化キー、および各メモリタイプのアクセスパターンの文書化により、分離されたセキュリティコンテキストを持っていることを検証してください。 |   1   | D/V  |
| 8.6.2 | メモリ統合プロセスには、コンテンツのサニタイズ、情報源の検証、そして保存前の整合性チェックを通じて悪意のあるメモリの注入を防ぐためのセキュリティ検証が含まれていることを確認してください。                       |   2   | D/V  |
| 8.6.3 | メモリ検索クエリが検証およびサニタイズされ、不正な情報の抽出を防ぐために、クエリパターンの分析、アクセス制御の実施、および結果のフィルタリングが行われていることを確認してください。                          |   2   | D/V  |
| 8.6.4 | キー削除、多重上書き、または検証証明書付きのハードウェアベースの安全な削除を用いて、暗号消去の保証を伴う機密情報がメモリ忘却メカニズムによって安全に削除されることを検証してください。                         |   3   | D/V  |
| 8.6.5 | メモリシステムの整合性が、チェックサム、監査ログ、および正常な操作外でメモリ内容が変更された際の自動アラートを通じて、不正な変更や破損が継続的に監視されていることを検証してください。                         |   3   | D/V  |

---

## 参考文献

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)

