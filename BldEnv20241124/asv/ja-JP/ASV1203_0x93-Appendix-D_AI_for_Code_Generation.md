# 付録D：AI支援によるセキュアコーディング管理と検証

## 目的

この章は、ソフトウェア開発中にAI支援コーディングツールを安全かつ効果的に使用するための基準となる組織的管理策を定義し、ソフトウェア開発ライフサイクル（SDLC）全体でのセキュリティと追跡可能性を確保します。

---

## AD.1 AI支援セキュアコーディングワークフロー

既存のセキュリティゲートを弱体化させることなく、組織のセキュアソフトウェア開発ライフサイクル（SSDLC）にAIツールを統合する。

|   #    | Description                                                              | Level | Role |
| :----: | ------------------------------------------------------------------------ | :---: | :--: |
| AD.1.1 | 文書化されたワークフローが、AIツールがコードを生成、リファクタリング、またはレビューするタイミングと方法を説明していることを確認してください。 |   1   | D/V  |
| AD.1.2 | ワークフローが各SSDLCフェーズ（設計、実装、コードレビュー、テスト、展開）に対応していることを確認してください。               |   2   |  D   |
| AD.1.3 | AI生成コードに対しても指標（例：脆弱性密度、検出までの平均時間）が収集され、人間のみのベースラインと比較されていることを確認してください。   |   3   | D/V  |

---

## AD.2 AIツールの適格性評価と脅威モデリング

AIコーディングツールは、採用前にセキュリティ機能、リスク、およびサプライチェーンへの影響を評価することを確実にしてください。

|   #    | Description                                                                    | Level | Role |
| :----: | ------------------------------------------------------------------------------ | :---: | :--: |
| AD.2.1 | 各AIツールの脅威モデルが、誤用、モデル反転、データ漏洩、および依存チェーンのリスクを特定していることを確認してください。                  |   1   | D/V  |
| AD.2.2 | ツール評価に、ローカルコンポーネントの静的/動的解析およびSaaSエンドポイント（TLS、認証/認可、ログ記録）の評価が含まれていることを確認してください。 |   2   |  D   |
| AD.2.3 | 評価が認識されたフレームワークに従っていることを確認し、主要なバージョン変更後に再実施されることを確認してください。                     |   3   | D/V  |

---

## AD.3 セキュアなプロンプトおよびコンテキスト管理

AIモデルのプロンプトやコンテキストを構築する際に、秘密情報、専有コード、個人データの漏洩を防止してください。

|   #    | Description                                                                | Level | Role |
| :----: | -------------------------------------------------------------------------- | :---: | :--: |
| AD.3.1 | 書面によるガイダンスで、プロンプトに秘密情報、認証情報、または機密データを送信することを禁止していることを確認してください。             |   1   | D/V  |
| AD.3.2 | 技術的な制御（クライアント側の編集、承認されたコンテキストフィルター）が自動的に機密情報を除去することを確認してください。              |   2   |  D   |
| AD.3.3 | プロンプトと応答がトークン化され、転送中および保存時に暗号化されていること、および保持期間がデータ分類ポリシーに準拠していることを確認してください。 |   3   | D/V  |

---

## AD.4 AI生成コードの検証

コードがマージまたはデプロイされる前に、AI出力によって導入された脆弱性を検出し修正します。

|   #    | Description                                                                                | Level | Role |
| :----: | ------------------------------------------------------------------------------------------ | :---: | :--: |
| AD.4.1 | AI生成コードは常に人間のコードレビューを受けることを確認してください。                                                       |   1   | D/V  |
| AD.4.2 | AI生成コードを含むすべてのプルリクエストに対して自動スキャナー（SAST/IAST/DAST）が実行され、重要な問題が検出された場合はマージをブロックすることを確認してください。 |   2   |  D   |
| AD.4.3 | 差分ファズテストまたはプロパティベースのテストが、セキュリティに重要な動作（例：入力検証、認可ロジック）を証明していることを確認してください。                    |   3   | D/V  |

---

## AD.5 コード提案の説明性と追跡可能性

監査人や開発者に対して、提案がなされた理由とその進化過程に関する洞察を提供する。

|   #    | Description                                                                              | Level | Role |
| :----: | ---------------------------------------------------------------------------------------- | :---: | :--: |
| AD.5.1 | プロンプト／レスポンスのペアがコミットIDと共に記録されていることを確認してください。                                              |   1   | D/V  |
| AD.5.2 | 開発者が提案を裏付けるモデルの引用（トレーニングスニペット、ドキュメント）を表示できることを確認してください。                                  |   2   |  D   |
| AD.5.3 | 説明可能性レポートが設計成果物と共に保存され、セキュリティレビューで参照されていることを確認し、ISO/IEC 42001のトレーサビリティ原則を満たしていることを確認します。 |   3   | D/V  |

---

## AD.6 継続的フィードバックとモデルの微調整

負のドリフトを防ぎながら、時間の経過とともにモデルのセキュリティ性能を向上させる。

|   #    | Description                                                                                        | Level | Role |
| :----: | -------------------------------------------------------------------------------------------------- | :---: | :--: |
| AD.6.1 | 開発者が安全でないまたは非準拠の提案にフラグを立てることができ、そのフラグが追跡されることを確認してください。                                            |   1   | D/V  |
| AD.6.2 | 集約されたフィードバックが、定期的なファインチューニングや、検証済みのセキュアコーディングコーパス（例：OWASPチートシート）を用いたリトリーバル強化生成に反映されていることを確認してください。 |   2   |  D   |
| AD.6.3 | 閉ループ評価ハーネスがファインチューニング後に回帰テストを実行することを確認してください。セキュリティ指標は、展開前に前回の基準を満たすかそれを上回る必要があります。                |   3   | D/V  |

---

### 参考文献

* [NIST AI Risk Management Framework 1.0](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements](https://www.iso.org/standard/81230.html)
* [OWASP Secure Coding Practices — Quick Reference Guide](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/)

