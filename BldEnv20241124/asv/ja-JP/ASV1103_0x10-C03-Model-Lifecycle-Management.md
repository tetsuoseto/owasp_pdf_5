# C3モデルライフサイクル管理と変更管理

## 管理目標

AIシステムは、承認されていないまたは安全でないモデルの変更が本番環境に反映されることを防ぐ変更管理プロセスを実装しなければなりません。この管理は、開発から展開、廃止に至るライフサイクル全体を通じてモデルの完全性を確保し、迅速なインシデント対応を可能にし、すべての変更に対する責任を維持します。

コアセキュリティ目標：整合性、追跡可能性、および回復可能性を維持する管理されたプロセスを採用することにより、認可され検証されたモデルのみが本番環境に到達するようにすること。

---

## C3.1 モデル認証と完全性

認証された完全性が検証されたモデルのみが本番環境に到達します。

|   #   | Description                                                                                    | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------- | :---: | :--: |
| 3.1.1 | 展開前に、すべてのモデルアーティファクト（重み、設定、トークナイザー）が認可されたエンティティによって暗号的に署名されていることを検証してください。                     |   1   | D/V  |
| 3.1.2 | モデルの整合性が展開時に検証され、署名検証の失敗がモデルの読み込みを防止することを確認してください。                                             |   1   | D/V  |
| 3.1.3 | モデルの出所記録に、認証機関の身元、トレーニングデータのチェックサム、合否判定付きの検証テスト結果、および作成タイムスタンプが含まれていることを確認してください。              |   2   | D/V  |
| 3.1.4 | すべてのモデルアーティファクトがセマンティックバージョニング（MAJOR.MINOR.PATCH）を使用しており、各バージョン要素が増分される条件が文書化されていることを確認してください。 |   2   | D/V  |
| 3.1.5 | 依存関係の追跡が、すべての消費システムを迅速に特定できるリアルタイムのインベントリを維持していることを確認してください。                                   |   2   |  V   |

---

## C3.2 モデルの検証とテスト

モデルは展開前に定義されたセキュリティおよび安全性の検証を通過しなければなりません。

|   #   | Description                                                                                 | Level | Role |
| :---: | ------------------------------------------------------------------------------------------- | :---: | :--: |
| 3.2.1 | モデルが展開前に、事前に合意された組織の合否基準に基づき、入力検証、出力のサニタイズ、安全性評価を含む自動セキュリティテストを受けることを確認してください。              |   1   | D/V  |
| 3.2.2 | 検証失敗が、事前に指定された権限を持つ担当者による明示的なオーバーライド承認と文書化された事業上の正当な理由がある場合を除き、自動的にモデル展開をブロックすることを確認してください。 |   1   | D/V  |
| 3.2.3 | テスト結果が暗号的に署名され、検証対象の特定モデルバージョンのハッシュに不変的にリンクされていることを確認してください。                                |   2   |  V   |
| 3.2.4 | 緊急展開には、予め合意された期間内に、事前に指定されたセキュリティ権限者からの文書化されたセキュリティリスク評価および承認が必要であることを確認してください。             |   2   | D/V  |

---

## C3.3 管理された展開とロールバック

モデルの展開は制御され、監視され、かつ元に戻せるものでなければなりません。

|   #   | Description                                                                                                                    | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 3.3.1 | 本番環境へのデプロイメントが、事前に合意されたエラー率、遅延閾値、またはセキュリティアラート基準に基づく自動ロールバックトリガーを備えた段階的な展開メカニズム（カナリアデプロイメント、ブルーグリーンデプロイメント）を実装していることを確認してください。 |   1   |  D   |
| 3.3.2 | ロールバック機能が、あらかじめ定められた組織の時間枠内でモデルの完全な状態（重み、構成、依存関係）を原子性を保って復元することを確認してください。                                                      |   1   | D/V  |
| 3.3.3 | 展開プロセスが暗号署名を検証し、モデルの有効化前に整合性チェックサムを計算することを確認し、不一致がある場合は展開を失敗させてください。                                                           |   2   | D/V  |
| 3.3.4 | 緊急モデルシャットダウン機能が、あらかじめ定義された応答時間内に自動回路遮断器または手動停止スイッチを介してモデルエンドポイントを無効にできることを確認してください。                                            |   2   | D/V  |
| 3.3.5 | インシデント対応のために、不変ストレージを用いて、ロールバックアーティファクト（以前のモデルバージョン、構成、依存関係）が組織のポリシーに従って保持されていることを確認する。                                        |   2   |  V   |

---

## C3.4 変更の説明責任と監査

すべてのモデルのライフサイクル変更は追跡可能で監査可能でなければなりません。

|   #   | Description                                                                                         | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------- | :---: | :--: |
| 3.4.1 | すべてのモデル変更（展開、構成、廃止）が、タイムスタンプ、認証された実行者の身元、変更タイプ、および変更前後の状態を含む不変の監査記録を生成することを検証してください。                |   1   |  V   |
| 3.4.2 | 監査ログへのアクセスには適切な認可が必要であり、すべてのアクセス試行はユーザーの識別情報とタイムスタンプとともに記録されていることを確認してください。                         |   2   | D/V  |
| 3.4.3 | プロンプトテンプレートおよびシステムメッセージが、必須のコードレビューおよび指定されたレビュアーによる承認を経てデプロイされる前に、gitリポジトリでバージョン管理されていることを確認してください。 |   2   | D/V  |
| 3.4.4 | 監査記録に、保持期間内の任意のタイムスタンプにおけるモデル状態を完全に再構築できるように、十分な詳細（モデルハッシュ、設定スナップショット、依存関係のバージョン）を含んでいることを確認する。     |   2   |  V   |

---

## C3.5 セキュア開発プラクティス

モデルの開発およびトレーニングプロセスは、侵害を防ぐために安全な手法に従う必要があります。

|   #   | Description                                                                                   | Level | Role |
| :---: | --------------------------------------------------------------------------------------------- | :---: | :--: |
| 3.5.1 | モデルの開発、テスト、および本番環境が物理的または論理的に分離されていることを確認します。これらは共有インフラストラクチャを持たず、アクセス制御が異なり、データストアも分離されています。 |   1   |  D   |
| 3.5.2 | モデルのトレーニングおよびファインチューニングが、制御されたネットワークアクセスを持つ分離環境で行われていることを確認してください。                            |   1   |  D   |
| 3.5.3 | モデル開発に使用する前に、トレーニングデータソースが完全性チェックを通じて検証され、信頼されたソースによる認証が行われ、文書化された供給連鎖が確認されていることを検証してください。    |   1   | D/V  |
| 3.5.4 | モデル開発の成果物（ハイパーパラメータ、トレーニングスクリプト、設定ファイル）がバージョン管理に保存され、トレーニングで使用する前にピアレビューの承認が必要であることを確認してください。 |   2   |  D   |

---

## C3.6 モデルの廃止および退役

モデルは、もはや不要になった場合やセキュリティ上の問題が発見された場合に、安全に廃棄されなければなりません。

|   #   | Description                                                                                  | Level | Role |
| :---: | -------------------------------------------------------------------------------------------- | :---: | :--: |
| 3.6.1 | モデルリタイアメントプロセスが依存関係グラフを自動的にスキャンし、すべての依存システムを特定し、廃止前に事前に合意された通知期間を提供することを確認してください。            |   1   |  D   |
| 3.6.2 | 退役したモデルアーティファクトが、文書化されたデータ保持ポリシーに従って、検証済みの破棄証明書を用いて暗号消去または多重上書きによって安全に消去されていることを確認してください。    |   1   | D/V  |
| 3.6.3 | モデルの廃止イベントがタイムスタンプと実行者の識別情報とともに記録され、モデルの署名が再利用を防ぐために取り消されていることを確認してください。                     |   2   |  V   |
| 3.6.4 | 緊急モデル退役が、重大なセキュリティ脆弱性が発見された場合に、自動化されたキルスイッチを通じて、事前に設定された緊急対応時間内にモデルへのアクセスを無効化できることを検証してください。 |   2   | D/V  |

---

## 参考文献

* [MLOps Principles](https://ml-ops.org/content/mlops-principles)
* [Securing AI/ML Ops – Cisco.com](https://sec.cloudapps.cisco.com/security/center/resources/SecuringAIMLOps)
* [Audit logs security: cryptographically signed tamper-proof logs](https://www.cossacklabs.com/blog/audit-logs-security/)
* [Machine Learning Model Versioning: Top Tools & Best Practices](https://lakefs.io/blog/model-versioning/)
* [AI Hygiene Starts with Models and Data Loaders – SEI Blog](https://insights.sei.cmu.edu/documents/6190/AI-Hygiene-Starts-with-Models-and-Data-Loaders_1G0KTRh.pdf)
* [How to handle versioning and rollback of a deployed ML model?](https://learn.microsoft.com/en-au/answers/questions/1845378/how-to-handle-versioning-and-rollback-of-a-deploye)
* [Reinforcement fine-tuning – OpenAI API](https://platform.openai.com/docs/guides/reinforcement-fine-tuning)
* [Auditing Machine Learning models: Governance, Data Security and …](https://www.linkedin.com/pulse/auditing-machine-learning-models-governance-data-security-negrete-yn81f)
* [Adversarial Training to Improve Model Robustness](https://medium.com/%40amit25173/adversarial-training-to-improve-model-robustness-5e285b516713)
* [What is AI adversarial robustness? – IBM Research](https://research.ibm.com/blog/securing-ai-workflows-with-adversarial-robustness)
* [Exploring Data Provenance: Ensuring Data Integrity and Authenticity](https://www.astera.com/type/blog/data-provenance/)
* [MITRE ATLAS](https://atlas.mitre.org/)
* [AWS Prescriptive Guidance – Best practices for retiring applications …](https://docs.aws.amazon.com/pdfs/prescriptive-guidance/latest/migration-app-retirement-best-practices/migration-app-retirement-best-practices.pdf)

