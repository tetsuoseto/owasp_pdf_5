# C12 監視、ログ記録、および異常検知

## 管理目標

このセクションでは、モデルやその他のAIコンポーネントが何を見て、何を行い、何を返すかについてのリアルタイムおよびフォレンジックの可視性を提供するための要件を示しており、これにより脅威を検出、分類、学習できるようにします。

## C12.1 リクエストおよびレスポンスのログ記録

|   #    | Description                                                                              | Level | Role |
| :----: | ---------------------------------------------------------------------------------------- | :---: | :--: |
| 12.1.1 | すべてのユーザープロンプトとモデルの応答が、適切なメタデータ（例：タイムスタンプ、ユーザーID、セッションID、モデルバージョン）とともに記録されていることを確認してください。 |   1   | D/V  |
| 12.1.2 | ログが適切な保存期間ポリシーとバックアップ手順を備えた、安全でアクセス制御されたリポジトリに保存されていることを確認してください。                        |   1   | D/V  |
| 12.1.3 | ログストレージシステムが、ログに含まれる機密情報を保護するために、保存時および転送時の暗号化を実装していることを確認してください。                        |   1   | D/V  |
| 12.1.4 | プロンプトおよび出力内の機密データがログ記録前に自動的に検閲またはマスクされることを確認し、PII、認証情報、および機密情報に対する設定可能な検閲ルールを適用してください。   |   1   | D/V  |
| 12.1.5 | ポリシー決定および安全フィルタリングの操作が、コンテンツモデレーションシステムの監査およびデバッグを可能にする十分な詳細で記録されていることを確認してください。         |   2   | D/V  |
| 12.1.6 | ログの完全性が暗号署名や書き込み専用ストレージなどを通じて保護されていることを確認してください。                                         |   2   | D/V  |

---

## C12.2 悪用検出とアラート通知

|   #    | Description                                                                                      | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------ | :---: | :--: |
| 12.2.1 | 既知の脱獄パターン、プロンプトインジェクションの試み、および敵対的入力に対して、シグネチャベースの検出を用いてシステムが検出および警告を行うことを確認してください。               |   1   | D/V  |
| 12.2.2 | システムが標準的なログフォーマットおよびプロトコルを使用して、既存のセキュリティ情報およびイベント管理（SIEM）プラットフォームと統合されていることを確認してください。            |   1   | D/V  |
| 12.2.3 | 強化されたセキュリティイベントに、モデル識別子、信頼度スコア、安全フィルターの決定などのAI固有のコンテキストが含まれていることを確認してください。                       |   2   | D/V  |
| 12.2.4 | 行動異常検知が異常な会話パターン、過剰な再試行回数、または体系的なプロービング行動を識別することを確認してください。                                       |   2   | D/V  |
| 12.2.5 | リアルタイムのアラート機構が、潜在的なポリシー違反や攻撃試行が検出された際にセキュリティチームに通知することを確認してください。                                 |   2   | D/V  |
| 12.2.6 | カスタムルールが、協調的なジャイルブレイク試行、プロンプトインジェクションキャンペーン、およびモデル抽出攻撃を含むAI固有の脅威パターンを検出するために組み込まれていることを確認してください。 |   2   | D/V  |
| 12.2.7 | 自動化されたインシデント対応ワークフローが、侵害されたモデルを隔離し、悪意のあるユーザーをブロックし、重大なセキュリティイベントをエスカレーションできることを検証してください。         |   3   | D/V  |

---

## C12.3 モデルドリフト検出

|   #    | Description                                                                  | Level | Role |
| :----: | ---------------------------------------------------------------------------- | :---: | :--: |
| 12.3.1 | システムが、モデルのバージョンや期間にわたって、精度、信頼度スコア、遅延、エラー率などの基本的なパフォーマンス指標を追跡していることを確認してください。 |   1   | D/V  |
| 12.3.2 | パフォーマンス指標が事前に定義された劣化閾値を超えるか、ベースラインから大幅に逸脱した場合に自動アラートが発動することを確認する。            |   2   | D/V  |
| 12.3.3 | モデルの出力に事実誤認、不整合、または捏造された情報が含まれている場合に、幻覚検出モニターがそれを特定しフラグを立てることを検証してください。      |   2   | D/V  |

---

## C12.4 パフォーマンスおよび動作テレメトリ

|   #    | Description                                                                         | Level | Role |
| :----: | ----------------------------------------------------------------------------------- | :---: | :--: |
| 12.4.1 | リクエスト遅延、トークン消費量、メモリ使用量、およびスループットを含む運用指標が継続的に収集および監視されていることを確認してください。                |   1   | D/V  |
| 12.4.2 | 成功率と失敗率が、エラータイプとその根本原因の分類を伴って追跡されていることを確認してください。                                    |   1   | D/V  |
| 12.4.3 | リソース利用状況の監視にGPU/CPU使用率、メモリ消費、およびストレージ要件が含まれていることを確認し、しきい値を超えた場合にアラートが発生するようにしてください。 |   2   | D/V  |

---

## C12.5 AIインシデント対応計画と実行

|   #    | Description                                                                    | Level | Role |
| :----: | ------------------------------------------------------------------------------ | :---: | :--: |
| 12.5.1 | インシデント対応計画が、モデルの侵害、データポイズニング、および敵対的攻撃を含むAI関連のセキュリティイベントに具体的に対応していることを確認してください。 |   1   | D/V  |
| 12.5.2 | インシデント対応チームが、モデルの挙動や攻撃ベクトルを調査するために、AI専用のフォレンジックツールおよび専門知識にアクセスできることを確認する。      |   2   | D/V  |
| 12.5.3 | 事後分析にモデルの再訓練の考慮、安全性フィルターの更新、そして得られた教訓のセキュリティ管理への統合が含まれていることを確認してください。          |   3   | D/V  |

---

## C12.5 AI性能劣化検知

AIモデルのパフォーマンスおよび品質の劣化を時間の経過とともに監視・検出する。

|   #    | Description                                                     | Level | Role |
| :----: | --------------------------------------------------------------- | :---: | :--: |
| 12.5.1 | モデルの精度、適合率、再現率、およびF1スコアが継続的に監視され、ベースラインの閾値と比較されていることを確認してください。  |   1   | D/V  |
| 12.5.2 | データドリフト検出が、モデルの性能に影響を与える可能性のある入力分布の変化を監視することを確認してください。          |   1   | D/V  |
| 12.5.3 | 概念ドリフト検出が入力と期待される出力との関係の変化を特定することを検証する。                         |   2   | D/V  |
| 12.5.4 | パフォーマンスの低下が自動アラートをトリガーし、モデルの再トレーニングまたは置換ワークフローを開始することを確認してください。 |   2   | D/V  |
| 12.5.5 | 劣化の根本原因分析が、パフォーマンスの低下をデータの変化、インフラ問題、または外的要因と関連付けていることを確認する。     |   3   |  V   |

---

## C12.6 DAGの可視化とワークフローのセキュリティ

ワークフロー可視化システムを情報漏洩および改ざん攻撃から保護する。

|   #    | Description                                                                    | Level | Role |
| :----: | ------------------------------------------------------------------------------ | :---: | :--: |
| 12.6.1 | 保存または送信の前に、DAGの可視化データが機微な情報を取り除くようにサニタイズされていることを確認してください。                      |   1   | D/V  |
| 12.6.2 | ワークフローの可視化アクセス制御が、権限のあるユーザーのみがエージェントの意思決定経路と推論のトレースを閲覧できることを確認してください。          |   1   | D/V  |
| 12.6.3 | DAGのデータ整合性が暗号署名と改ざん検知可能なストレージメカニズムによって保護されていることを検証してください。                      |   2   | D/V  |
| 12.6.4 | ワークフロー可視化システムが、巧妙に作成されたノードやエッジのデータを通じたインジェクション攻撃を防ぐために、入力検証を実装していることを確認してください。 |   2   | D/V  |
| 12.6.5 | リアルタイムDAG更新がレート制限され、検証されていることを確認し、可視化システムへのサービス拒否攻撃を防止してください。                  |   3   | D/V  |

---

## C12.7 プロアクティブなセキュリティ行動モニタリング

プロアクティブなエージェント行動分析を通じたセキュリティ脅威の検出と防止。

|   #    | Description                                                   | Level | Role |
| :----: | ------------------------------------------------------------- | :---: | :--: |
| 12.7.1 | リスク評価の統合を伴い、プロアクティブなエージェントの動作が実行前にセキュリティ検証されていることを確認する。       |   1   | D/V  |
| 12.7.2 | 自律的なイニシアティブのトリガーには、セキュリティコンテキストの評価と脅威状況の評価が含まれていることを確認してください。 |   2   | D/V  |
| 12.7.3 | 積極的な行動パターンが潜在的なセキュリティへの影響や予期せぬ結果について分析されていることを確認する。           |   2   | D/V  |
| 12.7.4 | セキュリティに重要な事前対応は、監査記録のある明示的な承認連鎖を必要とすることを確認してください。             |   3   | D/V  |
| 12.7.5 | 行動異常検知が、侵害を示す可能性のあるプロアクティブエージェントのパターンの逸脱を特定することを検証する。         |   3   | D/V  |

---

## 参考文献

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)

