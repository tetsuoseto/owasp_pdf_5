# モデル、フレームワーク、およびデータのためのC6サプライチェーンセキュリティ

## 制御目標

AIサプライチェーン攻撃は、サードパーティのモデル、フレームワーク、またはデータセットを悪用してバックドア、バイアス、または悪用可能なコードを埋め込みます。これらの制御は、エンドツーエンドの出自管理、脆弱性管理、監視を提供し、モデルのライフサイクル全体を保護します。

---

## C6.1 事前学習モデルの検証と由来

微調整や展開の前に、サードパーティモデルの起源、ライセンス、および隠れた挙動を評価し認証してください。

|   #   | Description                                                                | Level | Role |
| :---: | -------------------------------------------------------------------------- | :---: | :--: |
| 6.1.1 | すべてのサードパーティモデルアーティファクトに、ソースリポジトリとコミットハッシュを特定する署名付きの由来記録が含まれていることを確認してください。 |   1   | D/V  |
| 6.1.2 | モデルをインポートする前に、悪意のあるレイヤーやトロイの木馬トリガーが自動化ツールを用いてスキャンされていることを確認してください。         |   1   | D/V  |
| 6.1.3 | 転移学習のファインチューニングが隠れた動作を検出するための敵対的評価に合格することを確認してください。                        |   2   |  D   |
| 6.1.4 | モデルライセンス、輸出管理タグ、およびデータ起源の声明がML-BOMエントリに記録されていることを確認してください。                 |   2   |  V   |
| 6.1.5 | 高リスクモデル（公開されている重み、未検証の作成者）は、人間によるレビューと承認が行われるまで検疫状態を維持することを確認してください。       |   3   | D/V  |

---

## C6.2 フレームワークおよびライブラリのスキャン

MLフレームワークおよびライブラリを継続的にスキャンし、CVEおよび悪意のあるコードを検出してランタイムスタックのセキュリティを維持します。

|   #   | Description                                                       | Level | Role |
| :---: | ----------------------------------------------------------------- | :---: | :--: |
| 6.2.1 | CIパイプラインがAIフレームワークおよび重要なライブラリに対して依存関係スキャナーを実行していることを確認してください。     |   1   | D/V  |
| 6.2.2 | 重要な脆弱性（CVSS ≥ 7.0）が本番用イメージへの昇格をブロックすることを確認してください。                 |   1   | D/V  |
| 6.2.3 | フォークされたまたはベンダリングされたMLライブラリで、静的コード解析が実行されることを確認してください。             |   2   |  D   |
| 6.2.4 | フレームワークのアップグレード提案に、公的なCVEフィードを参照したセキュリティ影響評価が含まれていることを確認してください。   |   2   |  V   |
| 6.2.5 | 署名されたSBOMから逸脱する予期しない動的ライブラリの読み込みに対して、ランタイムセンサーが警告を発することを確認してください。 |   3   |  V   |

---

## C6.3 依存関係のピン留めと検証

すべての依存関係を不変のダイジェストに固定し、ビルドを再現して同一で改ざんされていない成果物を保証します。

|   #   | Description                                                       | Level | Role |
| :---: | ----------------------------------------------------------------- | :---: | :--: |
| 6.3.1 | すべてのパッケージマネージャーがロックファイルによるバージョン固定を強制していることを確認してください。              |   1   | D/V  |
| 6.3.2 | コンテナ参照において、変更可能なタグの代わりに不変のダイジェストが使用されていることを確認してください。              |   1   | D/V  |
| 6.3.3 | 再現可能ビルドのチェックが、CI実行間でハッシュを比較して同一の出力を確保していることを検証してください。             |   2   |  D   |
| 6.3.4 | 監査トレーサビリティのために、ビルド証明が18か月間保存されていることを確認してください。                     |   2   |  V   |
| 6.3.5 | 期限切れの依存関係が、自動的なプルリクエストをトリガーして、固定されたバージョンの更新またはフォークを行うことを確認してください。 |   3   |  D   |

---

## C6.4 信頼できるソースの強制

暗号的に検証され、組織によって承認されたソースからのアーティファクトのダウンロードのみを許可し、それ以外はすべてブロックします。

|   #   | Description                                                         | Level | Role |
| :---: | ------------------------------------------------------------------- | :---: | :--: |
| 6.4.1 | モデルの重み、データセット、およびコンテナが、承認されたドメインまたは内部レジストリからのみダウンロードされることを確認してください。 |   1   | D/V  |
| 6.4.2 | Sigstore/Cosignの署名が、アーティファクトがローカルにキャッシュされる前に公開者の身元を検証することを確認してください。 |   1   | D/V  |
| 6.4.3 | アーティファクトの未認証ダウンロードをブロックして、信頼できるソースのポリシーを強制することを確認してください。            |   2   |  D   |
| 6.4.4 | リポジトリの許可リストが四半期ごとにレビューされ、各エントリに対して業務上の正当な理由の証拠があることを確認してください。       |   2   |  V   |
| 6.4.5 | ポリシー違反がアーティファクトの隔離および依存するパイプライン実行のロールバックを引き起こすことを確認してください。          |   3   |  V   |

---

## C6.5 第三者データセットリスク評価

外部データセットを毒性、バイアス、法的遵守の観点から評価し、そのライフサイクル全体を通じて監視します。

|   #   | Description                                                         | Level | Role |
| :---: | ------------------------------------------------------------------- | :---: | :--: |
| 6.5.1 | 外部データセットがポイズニングリスクスコアリング（例：データフィンガープリンティング、外れ値検出）を受けていることを検証してください。 |   1   | D/V  |
| 6.5.2 | バイアス指標（人口統計的均等性、機会均等性）がデータセット承認前に計算されていることを確認してください。                |   1   |  D   |
| 6.5.3 | ML-BOMエントリにおいて、データセットの発生元およびライセンス条項が正確に記録されていることを確認してください。          |   2   |  V   |
| 6.5.4 | ホストされたデータセットのドリフトや破損を定期的な監視で検出することを確認してください。                        |   2   |  V   |
| 6.5.5 | 学習前に自動スクラビングにより、許可されていないコンテンツ（著作権、個人識別情報）が削除されていることを確認してください。       |   3   |  D   |

---

## C6.6 サプライチェーン攻撃監視

CVEフィード、監査ログ分析、レッドチームのシミュレーションを通じて、サプライチェーンの脅威を早期に検出します。

|   #   | Description                                                              | Level | Role |
| :---: | ------------------------------------------------------------------------ | :---: | :--: |
| 6.6.1 | CI/CDの監査ログが異常なパッケージの取得や改ざんされたビルドステップの検出のためにSIEMにストリーミングされていることを検証してください。 |   1   |  V   |
| 6.6.2 | インシデント対応プレイブックに、侵害されたモデルやライブラリのロールバック手順が含まれていることを確認してください。               |   2   |  D   |
| 6.6.3 | アラートトリアージにおいて、脅威インテリジェンスの強化がML特有の指標（例：モデル汚染IoC）にタグ付けされていることを確認してください。    |   3   |  V   |

---

## C6.7 モデルアーティファクトのためのML-BOM

詳細な機械学習（ML）専用ソフトウェア部品表（SBOM）（ML-BOM）を生成および署名し、下流の利用者が展開時にコンポーネントの完全性を検証できるようにします。

|   #   | Description                                                                  | Level | Role |
| :---: | ---------------------------------------------------------------------------- | :---: | :--: |
| 6.7.1 | すべてのモデルアーティファクトが、データセット、重み、ハイパーパラメータ、およびライセンスを一覧化したML‑BOMを公開していることを確認してください。 |   1   | D/V  |
| 6.7.2 | ML-BOMの生成とCosign署名がCIで自動化されており、マージに必須であることを確認してください。                         |   1   | D/V  |
| 6.7.3 | コンポーネントのメタデータ（ハッシュ、ライセンス）のいずれかが欠如している場合、ML-BOMの完全性チェックがビルドを失敗させることを確認してください。 |   2   |  D   |
| 6.7.4 | ダウンストリームの利用者がAPIを介してML-BOMを照会し、デプロイ時にインポートされたモデルを検証できることを確認してください。           |   2   |  V   |
| 6.7.5 | ML-BOM（機械学習部品表）がバージョン管理され、差分比較されて不正な改変を検出できることを確認してください。                     |   3   |  V   |

---

## 参考文献

* [ML Supply Chain Compromise – MITRE ATLAS](https://misp-galaxy.org/mitre-atlas-attack-pattern/)
* [Supply‑chain Levels for Software Artifacts (SLSA)](https://slsa.dev/)
* [CycloneDX – Machine Learning Bill of Materials](https://cyclonedx.org/capabilities/mlbom/)
* [What is Data Poisoning? – SentinelOne](https://www.sentinelone.com/cybersecurity-101/cybersecurity/data-poisoning/)
* [Transfer Learning Attack – OWASP ML Security Top 10](https://owasp.org/www-project-machine-learning-security-top-10/docs/ML07_2023-Transfer_Learning_Attack)
* [AI Data Security Best Practices – CISA](https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-142a)
* [Secure CI/CD Supply Chain – Sumo Logic](https://www.sumologic.com/blog/secure-azure-devops-github-supply-chain-attacks)
* [AI & Transparency: Protect ML Models – ReversingLabs](https://www.reversinglabs.com/blog/ai-and-transparency-how-ml-model-creators-can-protect-against-supply-chain-attacks)
* [SBOM Overview – CISA](https://www.cisa.gov/sbom)
* [Training Data Poisoning Guide – Lakera.ai](https://www.lakera.ai/blog/training-data-poisoning)
* [Dependency Pinning for Reproducible Python – Medium](https://medium.com/data-science-collective/guarantee-a-locked-reproducible-environment-with-every-python-run-c0e2bf19fb53)

