# AIコンポーネントおよびユーザーのためのC5アクセス制御とアイデンティティ管理

## 管理目標

AIシステムにおける効果的なアクセス制御には、堅牢なアイデンティティ管理、コンテキスト認識型の認可、およびゼロトラスト原則に基づく実行時の強制が必要です。これらの制御により、人間、サービス、自律エージェントは、明示的に許可された範囲内でのみモデル、データ、計算資源とやり取りし、継続的な検証および監査機能が確保されます。

---

## C5.1 アイデンティティ管理と認証

特権操作のために多要素認証を用い、すべてのエンティティに対して暗号的に裏付けられたアイデンティティを確立する。

|   #   | Description                                                                                                                                       | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.1.1 | すべての人間ユーザーおよびサービスプリンシパルが、OIDC/SAMLプロトコルを使用して一元化されたエンタープライズアイデンティティプロバイダー（IdP）を通じて認証され、ユニークなアイデンティティとトークンのマッピング（共有アカウントや資格情報なし）が行われていることを確認してください。 |   1   | D/V  |
| 5.1.2 | 高リスク操作（モデルのデプロイ、重みのエクスポート、トレーニングデータアクセス、プロダクション設定変更）には、多要素認証またはセッション再検証を伴うステップアップ認証が必要であることを確認してください。                                             |   1   | D/V  |
| 5.1.3 | 新しい管理者が本番システムアクセスを受ける前に、NIST 800-63-3 IAL-2または同等の基準に準拠した本人確認が行われていることを確認してください。                                                                   |   2   |  D   |
| 5.1.4 | アクセスレビューが四半期ごとに実施され、休眠アカウントの自動検出、資格情報のローテーション強制、およびプロビジョニング解除のワークフローが行われていることを確認してください。                                                           |   2   |  V   |
| 5.1.5 | 連携AIエージェントが、最長有効期間24時間の署名付きJWTアサーションを介して認証され、かつ発信元の暗号的証明が含まれていることを確認してください。                                                                       |   3   | D/V  |

---

## C5.2 リソース認可と最小権限

すべてのAIリソースに対して明示的な許可モデルと監査証跡を備えた詳細なアクセス制御を実装する。

|   #   | Description                                                                                                           | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.2.1 | すべてのAIリソース（データセット、モデル、エンドポイント、ベクターコレクション、埋め込みインデックス、計算インスタンス）が明示的な許可リストとデフォルト拒否ポリシーを用いた役割ベースアクセス制御を実施していることを確認してください。 |   1   | D/V  |
| 5.2.2 | サービスアカウントに対して、デフォルトで最小権限の原則が適用されていることを確認し、読み取り専用の権限から開始し、書き込みアクセスには文書化された業務上の正当な理由が必要とされていることを保証してください。               |   1   | D/V  |
| 5.2.3 | すべてのアクセス制御の変更が承認された変更要求に関連付けられていること、およびタイムスタンプ、実行者の識別情報、リソース識別子、権限の差分とともに不変的に記録されていることを確認する。                          |   1   |  V   |
| 5.2.4 | データ分類ラベル（PII、PHI、輸出管理対象、機密情報）が、派生リソース（埋め込み、プロンプトキャッシュ、モデル出力）に自動的に伝播し、一貫したポリシー適用が行われることを検証してください。                      |   2   |  D   |
| 5.2.5 | 不正アクセス試行および権限昇格イベントが、文脈メタデータとともに5分以内にSIEMシステムへリアルタイムアラートをトリガーすることを確認してください。                                           |   2   | D/V  |

---

## C5.3 動的ポリシー評価

監査機能を備えたコンテキスト認識の認可決定のために、属性ベースアクセス制御（ABAC）エンジンを展開します。

|   #   | Description                                                                                   | Level | Role |
| :---: | --------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.3.1 | 認可の決定が、認証されたAPIを介してアクセス可能な専用のポリシーエンジン（OPA、Cedar、または同等のもの）に外部委譲され、暗号的な完全性保護が施されていることを確認してください。 |   1   | D/V  |
| 5.3.2 | ポリシーがユーザーのクリアランスレベル、リソースの機密性分類、リクエストのコンテキスト、テナント分離、および時間的制約を含む動的属性を実行時に評価することを検証してください。       |   1   | D/V  |
| 5.3.3 | ポリシー定義がバージョン管理されており、ピアレビューを経て、CI/CDパイプライン内の自動テストによって検証された後に本番環境へ展開されることを確認してください。             |   2   |  D   |
| 5.3.4 | ポリシー評価結果に構造化された意思決定の根拠が含まれていることを確認し、それが相関分析およびコンプライアンス報告のためにSIEMシステムに送信されていることを検証してください。      |   2   |  V   |
| 5.3.5 | 高感度リソースに対してはポリシーキャッシュの有効期間（TTL）が5分を超えないこと、標準リソースに対してはキャッシュ無効化機能付きで1時間を超えないことを確認してください。        |   3   | D/V  |

---

## C5.4 クエリ時のセキュリティ強制

必須のフィルタリングおよび行レベルのセキュリティポリシーを用いて、データベース層のセキュリティ制御を実装する。

|   #   | Description                                                                                                          | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.4.1 | すべてのベクターデータベースおよびSQLクエリに、データベースエンジンレベルで強制される必須のセキュリティフィルター（テナントID、機密ラベル、ユーザースコープ）が含まれていることを確認してください。アプリケーションコードではなく。 |   1   | D/V  |
| 5.4.2 | すべてのベクトルデータベース、検索インデックス、トレーニングデータセットに対して、ポリシー継承を伴う行レベルセキュリティ（RLS）ポリシーおよびフィールドレベルのマスキングが有効になっていることを確認してください。          |   1   | D/V  |
| 5.4.3 | 認証失敗の評価が、「混乱した代理攻撃（confused deputy attacks）」を防止するために、クエリを直ちに中止し、空の結果セットを返すのではなく、明確な認証エラーコードを返すことを確認してください。           |   2   |  D   |
| 5.4.4 | ポリシー評価のレイテンシが継続的に監視され、承認バイパスを可能にするタイムアウト条件に対して自動アラートが設定されていることを確認してください。                                             |   2   |  V   |
| 5.4.5 | クエリの再試行メカニズムが、アクティブなユーザーセッション内での動的な権限変更を考慮するために認可ポリシーを再評価することを検証してください。                                              |   3   | D/V  |

---

## C5.5 出力フィルタリングとデータ損失防止

AI生成コンテンツにおける不正なデータ露出を防止するため、後処理制御を展開する。

|   #   | Description                                                                                  | Level | Role |
| :---: | -------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.5.1 | 推論後のフィルタリング機構が、要求者にコンテンツを提供する前に無許可の個人識別情報（PII）、機密情報、および専有データをスキャンし、検閲していることを確認してください。        |   1   | D/V  |
| 5.5.2 | モデル出力における引用、参考文献、および情報源の帰属が呼び出し元の権限に照らして検証され、権限外アクセスが検出された場合は削除されることを確認してください。               |   1   | D/V  |
| 5.5.3 | ユーザーの権限レベルおよびデータの分類に基づいて、出力フォーマット制限（サニタイズされたPDF、メタデータが削除された画像、承認されたファイルタイプ）が適用されていることを検証します。 |   2   |  D   |
| 5.5.4 | 検閲アルゴリズムが決定的であり、バージョン管理されていて、コンプライアンス調査およびフォレンジック分析を支援するための監査ログを維持していることを確認してください。           |   2   |  V   |
| 5.5.5 | 高リスクの改ざんイベントが、データを露出させることなく、フォレンジックのための復元に使用可能な元のコンテンツの暗号ハッシュを含む適応型ログを生成することを検証してください。       |   3   |  V   |

---

## C5.6 マルチテナント分離

共有AIインフラストラクチャにおけるテナント間の暗号的および論理的分離を確保する。

|   #   | Description                                                                                   | Level | Role |
| :---: | --------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.6.1 | メモリ空間、埋め込みストア、キャッシュエントリ、および一時ファイルがテナントごとに名前空間で分離されており、テナントの削除またはセッション終了時に安全に消去されることを検証してください。 |   1   | D/V  |
| 5.6.2 | すべてのAPIリクエストに、セッションコンテキストおよびユーザー権限と暗号学的に検証された認証済みテナント識別子が含まれていることを確認してください。                   |   1   | D/V  |
| 5.6.3 | サービスメッシュおよびコンテナオーケストレーションプラットフォーム内でのテナント間通信に対して、ネットワークポリシーがデフォルト拒否ルールを実装していることを検証してください。      |   2   |  D   |
| 5.6.4 | 顧客管理キー（CMK）サポートとテナントのデータストア間の暗号的分離を伴い、テナントごとに暗号化キーが一意であることを確認してください。                          |   3   |  D   |

---

## C5.7 自律エージェント認可

スコープ付き能力トークンと継続的認可を通じて、AIエージェントおよび自律システムの制御権限を管理します。

|   #   | Description                                                                                    | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------- | :---: | :--: |
| 5.7.1 | 自律エージェントが許可されたアクション、アクセス可能なリソース、時間の制限、および運用上の制約を明示的に列挙したスコープ付き能力トークンを受け取っていることを確認してください。       |   1   | D/V  |
| 5.7.2 | 高リスク機能（ファイルシステムアクセス、コード実行、外部APIコール、金融取引）はデフォルトで無効化されており、有効化には明確な承認と業務上の正当な理由が必要であることを確認してください。 |   1   | D/V  |
| 5.7.3 | 機能トークンがユーザーセッションに紐付けられていることを確認し、暗号学的な完全性保護が含まれていること、そしてオフライン環境での永続化や再利用ができないことを保証してください。       |   2   |  D   |
| 5.7.4 | エージェント発動のアクションが、完全なコンテキスト評価と監査ログ記録を伴うABACポリシーエンジンによる二次認可を受けていることを確認してください。                     |   2   |  V   |
| 5.7.5 | エージェントのエラー条件と例外処理に、インシデント分析およびフォレンジック調査をサポートするための能力範囲情報が含まれていることを確認してください。                     |   3   |  V   |

---

## 参考文献

### 標準とフレームワーク

* [NIST SP 800-63-3: Digital Identity Guidelines](https://pages.nist.gov/800-63-3/)
* [Zero Trust Architecture – NIST SP 800-207](https://nvlpubs.nist.gov/nistpubs/specialpublications/NIST.SP.800-207.pdf)
* [OWASP Application Security Verification Standard (AISVS)](https://owasp.org/www-project-application-security-verification-standard/)
  ​
### 実装ガイド

* [Identity and Access Management in the AI Era: 2025 Guide – IDSA](https://www.idsalliance.org/blog/identity-and-access-management-in-the-ai-era-2025-guide/)
* [Attribute-Based Access Control with OPA – Permify](https://medium.com/permify-tech-blog/attribute-based-access-control-abac-implementation-with-open-policy-agent-opa-b47052248f29)
* [How We Designed Cedar to Be Intuitive, Fast, and Safe – AWS](https://aws.amazon.com/blogs/security/how-we-designed-cedar-to-be-intuitive-to-use-fast-and-safe/)
  ​
### AI特有のセキュリティ

* [Row Level Security in Vector DBs for RAG – Bluetuple.ai](https://medium.com/bluetuple-ai/implementing-row-level-security-in-vector-dbs-for-rag-applications-fdbccb63d464)
* [Tenant Isolation in Multi-Tenant Systems – WorkOS](https://workos.com/blog/tenant-isolation-in-multi-tenant-systems)
* [Handling AI Agent Permissions – Stytch](https://stytch.com/blog/handling-ai-agent-permissions/)
* [OWASP Top 10 for Large Language Model Applications](https://owasp.org/www-project-top-10-for-large-language-model-applications/)

