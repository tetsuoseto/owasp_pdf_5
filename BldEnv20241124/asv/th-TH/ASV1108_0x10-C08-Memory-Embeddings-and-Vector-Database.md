# ความปลอดภัยของหน่วยความจำ C8, การฝังข้อมูล และฐานข้อมูลเวกเตอร์

## วัตถุประสงค์การควบคุม

การฝังตัวและร้านเวกเตอร์ทำหน้าที่เป็น "ความทรงจำสด" ของระบบปัญญาประดิษฐ์สมัยใหม่ โดยรับข้อมูลที่ผู้ใช้ป้อนอย่างต่อเนื่องและแสดงข้อมูลนั้นกลับเข้าสู่บริบทของแบบจำลองผ่านการสร้างข้อมูลเสริมด้วยการดึงข้อมูล (Retrieval-Augmented Generation - RAG) หากปล่อยให้ไม่มีการควบคุม ความทรงจำนี้อาจรั่วไหลข้อมูลส่วนบุคคลที่สำคัญ (PII) ละเมิดความยินยอม หรือถูกย้อนกลับเพื่อสร้างข้อความต้นฉบับได้ วัตถุประสงค์ของกลุ่มมาตรการควบคุมนี้คือการเสริมความมั่นคงให้กับกระบวนการความทรงจำและฐานข้อมูลเวกเตอร์เพื่อให้การเข้าถึงเกิดสิทธิ์ต่ำสุด (least-privilege) การฝังตัวถูกออกแบบให้รักษาความเป็นส่วนตัว เวกเตอร์ที่จัดเก็บมีวันหมดอายุหรือลบได้ตามคำขอ และความทรงจำต่อผู้ใช้แต่ละรายจะไม่ปนเปื้อนกับคำสั่งหรือผลลัพธ์ของผู้ใช้อื่น

---

## C8.1 การควบคุมการเข้าถึงหน่วยความจำและดัชนี RAG

บังคับใช้การควบคุมการเข้าถึงแบบละเอียดในแต่ละชุดเวกเตอร์ทุกชุด

|   #   | Description                                                                                                                                                                                                                                                 | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.1.1 | ตรวจสอบให้แน่ใจว่ากฎการควบคุมการเข้าถึงในระดับแถว/เนมสเปซจำกัดการดำเนินการแทรก ลบ และการสืบค้นตามผู้เช่า คอลเลคชัน หรือแท็กเอกสาร                                                                                                                           |   1   | D/V  |
| 8.1.2 | ตรวจสอบให้แน่ใจว่า API keys หรือ JWTs มีสิทธิ์แบบจำกัดขอบเขต (เช่น รหัสคอลเล็กชัน, คำกริยาแอ็กชัน) และมีการเปลี่ยนใหม่อย่างน้อยทุกไตรมาส                                                                                                                    |   1   | D/V  |
| 8.1.3 | ตรวจสอบให้แน่ใจว่าการพยายามเลื่อนสิทธิ์ (เช่น การสืบค้นความคล้ายคลึงกันข้ามเนมสเปซ) ถูกตรวจจับและบันทึกไปยัง SIEM ภายใน 5 นาที                                                                                                                              |   2   | D/V  |
| 8.1.4 | ตรวจสอบให้แน่ใจว่าระบบตรวจสอบฐานข้อมูลเวกเตอร์สามารถบันทึกข้อมูลตัวระบุหัวข้อ (subject-identifier), ปฏิบัติการ (operation), รหัสเวกเตอร์/เนมสเปซ (vector ID/namespace), เกณฑ์ความคล้ายคลึง (similarity threshold) และจำนวนผลลัพธ์ (result count) ได้ครบถ้วน |   2   | D/V  |
| 8.1.5 | ตรวจสอบให้แน่ใจว่าการตัดสินใจเข้าถึงถูกทดสอบเพื่อหาช่องโหว่การเลี่ยงเมื่อตัวเอนจินได้รับการอัปเกรดหรือตารางการแบ่งชาร์ดดัชนีมีการเปลี่ยนแปลง                                                                                                                |   3   |  V   |

---

## C8.2 การทำความสะอาดและการตรวจสอบความถูกต้องของการฝังข้อมูล

ตรวจสอบข้อความเบื้องต้นสำหรับข้อมูลระบุตัวบุคคล (PII) ทำการลบหรือแทนที่ด้วยรหัสก่อนการสร้างเวกเตอร์ และสามารถประมวลผลฝังตัว (embeddings) เพิ่มเติมเพื่อลบสัญญาณที่ตกค้างได้ตามต้องการ

|   #   | Description                                                                                                                                                                                                            | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.2.1 | ตรวจสอบให้แน่ใจว่าข้อมูลระบุบุคคล (PII) และข้อมูลที่ถูกควบคุมได้รับการตรวจจับผ่านตัวจัดประเภทอัตโนมัติและถูกซ่อนไว้, แทนที่ด้วยโทเค็น หรือถูกลบก่อนการฝังข้อมูล (pre-embedding)                                        |   1   | D/V  |
| 8.2.2 | ตรวจสอบให้แน่ใจว่า pipeline การฝังข้อมูลปฏิเสธหรือตรวจแยกอินพุตที่มีโค้ดที่สามารถรันได้หรือข้อมูลที่ไม่ใช่ UTF-8 ซึ่งอาจทำให้อินเด็กซ์เกิดการปนเปื้อน                                                                  |   1   |  D   |
| 8.2.3 | ตรวจสอบให้แน่ใจว่ามีการใช้การทำให้ข้อมูลเป็นความลับเชิงความแตกต่างแบบพื้นที่ท้องถิ่นหรือเชิงมาตรวัดกับการฝังประโยคที่ระยะห่างไปยังโทเค็นข้อมูลระบุตัวตนส่วนบุคคล (PII) ที่ทราบใด ๆ น้อยกว่าค่าธรณีที่สามารถกำหนดค่าได้ |   2   | D/V  |
| 8.2.4 | ตรวจสอบให้แน่ใจว่าประสิทธิภาพของการทำความสะอาดข้อมูล (เช่น การเรียกคืนการลบข้อมูลส่วนบุคคล, การเปลี่ยนแปลงความหมาย) ได้รับการตรวจสอบอย่างน้อยทุก ๆ หกเดือนโดยใช้ชุดข้อมูลมาตรฐาน                                       |   2   |  V   |
| 8.2.5 | ตรวจสอบให้แน่ใจว่าการตั้งค่าการทำความสะอาดข้อมูลถูกควบคุมเวอร์ชันและการเปลี่ยนแปลงได้รับการทบทวนโดยเพื่อนร่วมงาน                                                                                                       |   3   | D/V  |

---

## C8.3 การหมดอายุ การเพิกถอน และการลบหน่วยความจำ

กฎหมาย GDPR “สิทธิ์ที่จะถูกลืม” และกฎหมายที่คล้ายกันกำหนดให้ต้องลบข้อมูลทันเวลา ดังนั้นระบบจัดเก็บเวกเตอร์จึงต้องรองรับการตั้งอายุข้อมูล (TTL), การลบถาวร และการทำเครื่องหมายลบ (tomb-stoning) เพื่อให้เวกเตอร์ที่ถูกเพิกถอนไม่สามารถกู้คืนหรือทำดัชนีใหม่ได้อีก

|   #   | Description                                                                                                                                    | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.3.1 | ตรวจสอบให้แน่ใจว่าทุกเวกเตอร์และระเบียนเมตาดาต้ามี TTL หรือติดป้ายเก็บรักษาชัดเจนที่ได้รับการปฏิบัติตามโดยงานทำความสะอาดอัตโนมัติ              |   1   | D/V  |
| 8.3.2 | ตรวจสอบให้แน่ใจว่าคำขอการลบที่ผู้ใช้ริเริ่มจะลบเวกเตอร์ ข้อมูลเมตา สำเนาแคช และดัชนีย่อยภายใน 30 วัน                                           |   1   | D/V  |
| 8.3.3 | ตรวจสอบให้แน่ใจว่าการลบเชิงตรรกะตามด้วยการทำลายข้อมูลในบล็อกเก็บข้อมูลด้วยการเข้ารหัสลับหากฮาร์ดแวร์รองรับ หรือโดยการทำลายกุญแจในคลังเก็บกุญแจ |   2   |  D   |
| 8.3.4 | ตรวจสอบให้แน่ใจว่าวิเตอร์ที่หมดอายุถูกตัดออกจากผลการค้นหาเพื่อนบ้านที่ใกล้ที่สุดภายในเวลาไม่เกิน 500 มิลลิวินาทีหลังจากหมดอายุ                 |   3   | D/V  |

---

## C8.4 ป้องกันการย้อนกลับและการรั่วไหลของการฝังข้อมูล

การป้องกันล่าสุด—การซ้อนเสียง, เครือข่ายฉายภาพ, การรบกวนเซลล์ประสาทความเป็นส่วนตัว, และการเข้ารหัสระดับแอปพลิเคชัน—สามารถลดอัตราการย้อนกลับในระดับโทเค็นให้ต่ำกว่า 5% ได้

|   #   | Description                                                                                                                                                                                             | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.4.1 | ตรวจสอบให้แน่ใจว่ามีแบบจำลองภัยคุกคามอย่างเป็นทางการที่ครอบคลุมการโจมตีแบบย้อนกลับ การโจมตีสมาชิก และการโจมตีการอนุมานคุณลักษณะ และมีการทบทวนทุกปี                                                      |   1   |  V   |
| 8.4.2 | ตรวจสอบให้แน่ใจว่าการเข้ารหัสที่ชั้นแอปพลิเคชันหรือการเข้ารหัสที่สามารถค้นหาได้ปกป้องเวกเตอร์จากการอ่านโดยตรงโดยผู้ดูแลโครงสร้างพื้นฐานหรือพนักงานคลาวด์                                                |   2   | D/V  |
| 8.4.3 | ตรวจสอบให้แน่ใจว่าพารามิเตอร์การป้องกัน (ε สำหรับ DP, สัญญาณรบกวน σ, อันดับการฉายภาพ k) สามารถสร้างสมดุลระหว่างความเป็นส่วนตัวที่ ≥ 99% การปกป้องโทเค็น และประโยชน์ใช้สอยที่มีการสูญเสียความแม่นยำ ≤ 3% |   3   |  V   |
| 8.4.4 | ตรวจสอบให้แน่ใจว่าเมตริกความทนทานต่อการกลับด้านถูกนำมาใช้เป็นส่วนหนึ่งของเกตการปล่อยสำหรับการอัปเดตโมเดล โดยมีงบประมาณการถดถอยที่กำหนดไว้แล้ว                                                           |   3   | D/V  |

---

## C8.5 การบังคับใช้ขอบเขตสำหรับหน่วยความจำเฉพาะผู้ใช้

การรั่วไหลข้ามผู้เช่า (cross-tenant leakage) ยังคงเป็นความเสี่ยงอันดับต้น ๆ ของ RAG: การกรองคำค้นหาความคล้ายคลึงที่ไม่เหมาะสมอาจทำให้เอกสารส่วนตัวของลูกค้ารายอื่นถูกเปิดเผยได้

|   #   | Description                                                                                                                                                      | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.5.1 | ตรวจสอบให้แน่ใจว่าทุกคำค้นหาการดึงข้อมูลได้รับการกรองหลังโดยใช้รหัสผู้เช่า/ผู้ใช้ก่อนที่จะส่งไปยัง prompt ของ LLM                                                |   1   | D/V  |
| 8.5.2 | ตรวจสอบให้แน่ใจว่าชื่อของคอลเลกชันหรือ ID ที่มีพื้นที่ชื่อมีการใส่ค่า salt ตามผู้ใช้หรือผู้เช่าเพื่อป้องกันไม่ให้เวกเตอร์ชนกันข้ามขอบเขตต่าง ๆ                   |   1   |  D   |
| 8.5.3 | ตรวจสอบให้แน่ใจว่าผลลัพธ์ความคล้ายคลึงที่เกินกว่าค่าธรณีห่างที่กำหนดได้แต่ไม่อยู่ในขอบเขตของผู้เรียกจะถูกทิ้งและทำให้เกิดการแจ้งเตือนด้านความปลอดภัย             |   2   | D/V  |
| 8.5.4 | ตรวจสอบให้มั่นใจว่าสำหรับการทดสอบความเครียดแบบหลายผู้เช่า จำลองคำถามที่เป็นการโจมตีซึ่งพยายามดึงเอกสารที่อยู่นอกขอบเขต และแสดงให้เห็นว่าไม่มีการรั่วไหลข้อมูลใดๆ |   2   |  V   |
| 8.5.5 | ตรวจสอบให้แน่ใจว่ากุญแจเข้ารหัสถูกแยกตามแต่ละผู้เช่า เพื่อให้มีการแยกทางการเข้ารหัสแม้ว่าจะใช้พื้นที่จัดเก็บทางกายภาพร่วมกันก็ตาม                                |   3   | D/V  |

---

## C8.6 ความปลอดภัยของระบบหน่วยความจำขั้นสูง

การควบคุมความปลอดภัยสำหรับสถาปัตยกรรมหน่วยความจำที่ซับซ้อนรวมถึงหน่วยความจำเหตุการณ์ (episodic), หน่วยความจำเชิงความหมาย (semantic), และหน่วยความจำทำงาน (working memory) โดยมีข้อกำหนดเฉพาะในการแยกส่วนและการตรวจสอบความถูกต้อง

|   #   | Description                                                                                                                                                                                                                                                           | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 8.6.1 | ตรวจสอบให้แน่ใจว่าประเภทหน่วยความจำที่แตกต่างกัน (episodic, semantic, working) มีบริบทความปลอดภัยแยกจากกันโดยใช้การควบคุมการเข้าถึงตามบทบาท มีคีย์การเข้ารหัสแยกต่างหาก และมีเอกสารบันทึกลักษณะการเข้าถึงสำหรับแต่ละประเภทหน่วยความจำ                                 |   1   | D/V  |
| 8.6.2 | ตรวจสอบให้แน่ใจว่า กระบวนการรวบรวมความทรงจำมีการตรวจสอบความปลอดภัยเพื่อป้องกันการแทรกแซงของความทรงจำที่เป็นอันตราย ผ่านการทำความสะอาดเนื้อหา การตรวจสอบแหล่งที่มา และการตรวจสอบความสมบูรณ์ก่อนจัดเก็บ                                                                 |   2   | D/V  |
| 8.6.3 | ตรวจสอบให้แน่ใจว่าการค้นคืนหน่วยความจำได้รับการตรวจสอบความถูกต้องและทำความสะอาดเพื่อป้องกันการดึงข้อมูลที่ไม่ได้รับอนุญาตผ่านการวิเคราะห์รูปแบบคำค้น, การบังคับใช้การควบคุมการเข้าถึง และการกรองผลลัพธ์                                                               |   2   | D/V  |
| 8.6.4 | ตรวจสอบให้แน่ใจว่า กลไกการลืมข้อมูลในหน่วยความจำได้ลบข้อมูลที่ละเอียดอ่อนอย่างปลอดภัยด้วยการลบเชิงเข้ารหัส โดยใช้การลบคีย์ การเขียนทับหลายรอบ หรือการลบข้อมูลอย่างปลอดภัยบนฮาร์ดแวร์พร้อมใบรับรองการยืนยัน                                                            |   3   | D/V  |
| 8.6.5 | ตรวจสอบให้แน่ใจว่าความสมบูรณ์ของระบบหน่วยความจำถูกตรวจสอบอย่างต่อเนื่องเพื่อหาการแก้ไขที่ไม่ได้รับอนุญาตหรือความเสียหายผ่านทางเช็คซัม (checksums), บันทึกการตรวจสอบ (audit logs) และการแจ้งเตือนอัตโนมัติเมื่อเนื้อหาของหน่วยความจำเปลี่ยนแปลงนอกเหนือจากการทำงานปกติ |   3   | D/V  |

---

## เอกสารอ้างอิง

* [Vector database security: Pinecone – IronCore Labs](https://ironcorelabs.com/vectordbs/pinecone-security/)
* [Securing the Backbone of AI: Safeguarding Vector Databases and Embeddings – Privacera](https://privacera.com/blog/securing-the-backbone-of-ai-safeguarding-vector-databases-and-embeddings/)
* [Enhancing Data Security with RBAC of Qdrant Vector Database – AI Advances](https://ai.gopubby.com/enhancing-data-security-with-role-based-access-control-of-qdrant-vector-database-3878769bec83)
* [Mitigating Privacy Risks in LLM Embeddings from Embedding Inversion – arXiv](https://arxiv.org/html/2411.05034v1)
* [DPPN: Detecting and Perturbing Privacy-Sensitive Neurons – OpenReview](https://openreview.net/forum?id=DF5TVzpTW0)
* [Art. 17 GDPR – Right to Erasure](https://gdpr-info.eu/art-17-gdpr/)
* [Sensitive Data in Text Embeddings Is Recoverable – Tonic.ai](https://www.tonic.ai/blog/sensitive-data-in-text-embeddings-is-recoverable)
* [PII Identification and Removal – NVIDIA NeMo Docs](https://docs.nvidia.com/nemo-framework/user-guide/latest/datacuration/personalidentifiableinformationidentificationandremoval.html)
* [De-identifying Sensitive Data – Google Cloud DLP](https://cloud.google.com/sensitive-data-protection/docs/deidentify-sensitive-data)
* [Remove PII from Conversations Using Sensitive Information Filters – AWS Bedrock Guardrails](https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-sensitive-filters.html)
* [Think Your RAG Is Secure? Think Again – Medium](https://medium.com/%40vijay.poudel1/think-your-rag-is-secure-think-again-heres-how-to-actually-lock-it-down-c4c30e3864e7)
* [Design a Secure Multitenant RAG Inferencing Solution – Microsoft Learn](https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/secure-multitenant-rag)
* [Best Practices for Multi-Tenancy RAG with Milvus – Milvus Blog](https://milvus.io/blog/build-multi-tenancy-rag-with-milvus-best-practices-part-one.md)

