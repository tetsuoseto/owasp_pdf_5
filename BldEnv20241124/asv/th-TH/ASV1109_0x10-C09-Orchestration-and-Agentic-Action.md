# 9 การประสานงานอัตโนมัติและการดำเนินการโดยตัวแทนอย่างมั่นคง

## วัตถุประสงค์การควบคุม

ตรวจสอบให้แน่ใจว่าระบบ AI อัตโนมัติหรือระบบ AI หลายตัวแทนสามารถดำเนินการได้เฉพาะการกระทำที่ตั้งใจไว้อย่างชัดเจน ผ่านการตรวจสอบสิทธิ์ ตรวจสอบย้อนกลับได้ และอยู่ภายในขอบเขตของต้นทุนและความเสี่ยงที่กำหนดไว้ ซึ่งจะช่วยป้องกันภัยคุกคามต่าง ๆ เช่น การโจมตีระบบอัตโนมัติ การใช้เครื่องมือในทางที่ผิด การตรวจจับวงจรของตัวแทน การจี้การสื่อสาร การปลอมแปลงตัวตน การควบคุมฝูง และการบิดเบือนเจตนา

---

## 9.1 งบประมาณการวางแผนงานตัวแทนและการเรียกซ้ำ

จำกัดแผนการทำงานแบบเรียกซ้ำและบังคับให้มีจุดตรวจสอบของมนุษย์สำหรับการดำเนินการที่มีสิทธิพิเศษ

|   #   | Description                                                                                                                                                                                          | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.1.1 | ตรวจสอบให้มั่นใจว่าการกำหนดค่าระดับความลึกของการเรียกซ้ำสูงสุด ความกว้าง เวลานาฬิกาผนัง โทเค็น และต้นทุนทางการเงินต่อการทำงานของตัวแทนนั้นถูกกำหนดค่าแบบรวมศูนย์และมีการควบคุมเวอร์ชัน               |   1   | D/V  |
| 9.1.2 | ตรวจสอบให้แน่ใจว่าการดำเนินการที่ได้รับสิทธิพิเศษหรือไม่สามารถย้อนกลับได้ (เช่น การคอมมิตโค้ด การโอนเงิน) ต้องได้รับการอนุมัติอย่างชัดเจนจากมนุษย์ผ่านช่องทางที่สามารถตรวจสอบได้ก่อนการดำเนินการจริง |   1   | D/V  |
| 9.1.3 | ตรวจสอบให้แน่ใจว่าเครื่องมือตรวจสอบทรัพยากรแบบเรียลไทม์จะทำการหยุดวงจร (circuit-breaker interruption) เมื่อเกินขีดจำกัดงบประมาณใดๆ เพื่อหยุดการขยายงานเพิ่มเติม                                      |   2   |  D   |
| 9.1.4 | ตรวจสอบให้แน่ใจว่าเหตุการณ์เบรกเกอร์วงจรถูกบันทึกพร้อมด้วยรหัสไอเอเจนต์ เงื่อนไขที่ทำให้เกิดการทำงาน และสถานะแผนที่ถูกจับภาพสำหรับการตรวจสอบทางนิติเวช                                               |   2   | D/V  |
| 9.1.5 | ตรวจสอบให้แน่ใจว่าการทดสอบความปลอดภัยครอบคลุมสถานการณ์การใช้จ่ายเกินงบประมาณและแผนที่ออกนอกเส้นทาง โดยยืนยันว่าหยุดทำงานได้อย่างปลอดภัยโดยไม่สูญเสียข้อมูล                                           |   3   |  V   |
| 9.1.6 | ตรวจสอบให้แน่ใจว่านโยบายงบประมาณถูกแสดงออกในรูปแบบนโยบายเป็นโค้ด (policy-as-code) และบังคับใช้ในกระบวนการ CI/CD เพื่อป้องกันการเปลี่ยนแปลงการกำหนดค่าที่ไม่ได้รับอนุญาต (configuration drift)        |   3   |  D   |

---

## 9.2 การแยกสภาพแวดล้อมปลั๊กอินเครื่องมือ

แยกการโต้ตอบของเครื่องมือเพื่อป้องกันการเข้าถึงระบบหรือการประมวลผลโค้ดโดยไม่ได้รับอนุญาต

|   #   | Description                                                                                                                                                                                         | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.2.1 | ตรวจสอบให้แน่ใจว่าเครื่องมือ/ปลั๊กอินทุกตัวทำงานภายในระบบปฏิบัติการ คอนเทนเนอร์ หรือแซนด์บ็อกซ์ระดับ WASM ที่มีนโยบายเข้าถึงระบบไฟล์ เครือข่าย และการเรียกใช้ระบบด้วยสิทธิ์ต่ำสุด (least-privilege) |   1   | D/V  |
| 9.2.2 | ตรวจสอบให้แน่ใจว่าโควตาทรัพยากรแซนด์บ็อกซ์ (CPU, หน่วยความจำ, ดิสก์, การส่งออกเครือข่าย) และเวลาหมดอายุการทำงานถูกบังคับใช้และบันทึกไว้                                                             |   1   | D/V  |
| 9.2.3 | ตรวจสอบให้แน่ใจว่าไบนารีหรือคำอธิบายของเครื่องมือได้รับการลงนามดิจิทัล; ลายเซ็นจะได้รับการตรวจสอบความถูกต้องก่อนการโหลด                                                                             |   2   | D/V  |
| 9.2.4 | ตรวจสอบว่าเทเลเมทรีในแซนด์บ็อกซ์สตรีมไปยัง SIEM; ความผิดปกติ (เช่น การพยายามเชื่อมต่อออกไปด้านนอก) ทำให้เกิดการแจ้งเตือน                                                                            |   2   |  V   |
| 9.2.5 | ตรวจสอบให้แน่ใจว่า ปลั๊กอินที่มีความเสี่ยงสูงได้รับการตรวจสอบความปลอดภัยและทดสอบเจาะระบบก่อนการนำไปใช้งานจริง                                                                                       |   3   |  V   |
| 9.2.6 | ตรวจสอบให้แน่ใจว่าการพยายามหลบหนีจาก sandbox ถูกบล็อกโดยอัตโนมัติและปลั๊กอินที่กระทำผิดถูกกักกันเพื่อรอการตรวจสอบ                                                                                   |   3   | D/V  |

---

## 9.3 วงจรอิสระและการจำกัดค่าใช้จ่าย

ตรวจจับและหยุดการเรียกซ้ำระหว่างเอเจนต์ที่ไม่สามารถควบคุมได้และการระเบิดของต้นทุน

|   #   | Description                                                                                                                    | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 9.3.1 | ตรวจสอบให้แน่ใจว่าการเรียกข้ามเอเจนต์มีการตั้งค่าขีดจำกัดการโดด (hop-limit) หรือ TTL ที่รันไทม์ลดค่าลงและบังคับใช้อย่างถูกต้อง |   1   | D/V  |
| 9.3.2 | ตรวจสอบให้แน่ใจว่าเอเย่นต์รักษา ID กราฟการเรียกใช้งานที่ไม่ซ้ำกันเพื่อระบุการเรียกใช้งานตัวเองหรือรูปแบบที่เป็นวงจร            |   2   |  D   |
| 9.3.3 | ตรวจสอบให้แน่ใจว่าตัวนับหน่วยคำนวณสะสมและการใช้จ่ายถูกติดตามตามลำดับคำขอแต่ละชุด; หากเกินขีดจำกัดจะยกเลิกชุดคำขอนั้น           |   2   | D/V  |
| 9.3.4 | ตรวจสอบให้แน่ใจว่าการวิเคราะห์เชิงรูปแบบหรือการตรวจสอบแบบโมเดลแสดงให้เห็นถึงการไม่มีการเรียกซ้ำแบบไม่จำกัดในโพรโตคอลตัวแทน     |   3   |  V   |
| 9.3.5 | ตรวจสอบให้แน่ใจว่าเหตุการณ์การยกเลิกลูปสร้างการแจ้งเตือนและป้อนข้อมูลเมตริกการปรับปรุงอย่างต่อเนื่อง                           |   3   |  D   |

---

## 9.4 การป้องกันการใช้งานผิดระดับโปรโตคอล

ช่องทางการสื่อสารที่ปลอดภัยระหว่างเอเจนต์กับระบบภายนอกเพื่อป้องกันการถูกยึดครองหรือการถูกแก้ไขข้อมูลอย่างไม่ถูกต้อง

|   #   | Description                                                                                                                                                      | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.4.1 | ตรวจสอบให้แน่ใจว่าข้อความทั้งหมดระหว่างตัวแทนกับเครื่องมือและระหว่างตัวแทนด้วยกันนั้นได้รับการตรวจสอบสิทธิ์ (เช่น mutual TLS หรือ JWT) และเข้ารหัสแบบ end-to-end |   1   | D/V  |
| 9.4.2 | ตรวจสอบให้แน่ใจว่าสคีมาได้รับการตรวจสอบอย่างเคร่งครัด; ฟิลด์ที่ไม่รู้จักหรือข้อความที่มีรูปแบบผิดจะถูกปฏิเสธ                                                     |   1   |  D   |
| 9.4.3 | ตรวจสอบให้แน่ใจว่าการตรวจสอบความสมบูรณ์ (MAC หรือ ลายเซ็นดิจิทัล) ครอบคลุมข้อมูลทั้งหมดของข้อความรวมถึงพารามิเตอร์ของเครื่องมือด้วย                              |   2   | D/V  |
| 9.4.4 | ตรวจสอบให้แน่ใจว่าการป้องกันการเล่นซ้ำ (nonce หรือช่วงเวลาของ timestamp) ถูกบังคับใช้ในชั้นโปรโตคอล                                                              |   2   |  D   |
| 9.4.5 | ตรวจสอบให้แน่ใจว่าการใช้งานโปรโตคอลได้รับการทดสอบด้วยฟัซซิงและการวิเคราะห์แบบสแตติกเพื่อหาช่องโหว่จากการฉีดโค้ดหรือการถอดรหัสผิดพลาด                             |   3   |  V   |

---

## 9.5 ตัวตนของเอเจนต์และหลักฐานการปลอมแปลง

ตรวจสอบให้แน่ใจว่าการกระทำสามารถติดตามถึงผู้ทำได้และการเปลี่ยนแปลงสามารถตรวจจับได้

|   #   | Description                                                                                                                        | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.5.1 | ตรวจสอบให้แน่ใจว่าแต่ละอินสแตนซ์ของเอเจนต์มีอัตลักษณ์ทางคริปโตกราฟีที่ไม่ซ้ำกัน (คู่กุญแจหรือข้อมูลประจำตัวที่ฝังในฮาร์ดแวร์)      |   1   | D/V  |
| 9.5.2 | ตรวจสอบให้แน่ใจว่าการกระทำของเอเย่นต์ทั้งหมดถูกลงนามและประทับเวล; บันทึกรวมถึงลายเซ็นสำหรับการปฏิเสธความรับผิดชอบไม่ได้            |   2   | D/V  |
| 9.5.3 | ตรวจสอบให้แน่ใจ่ว่าบันทึกที่ตรวจจับการปลอมแปลงได้ถูกจัดเก็บในสื่อที่สามารถเพิ่มข้อมูลอย่างเดียวหรือเขียนได้เพียงครั้งเดียวเท่านั้น |   2   |  V   |
| 9.5.4 | ตรวจสอบให้แน่ใจว่ากุญแจระบุตัวตนจะหมุนเวียนตามกำหนดเวลาที่กำหนดไว้และเมื่อมีสัญญาณบ่งชี้ว่ากุญแจถูกบุกรุก                          |   3   |  D   |
| 9.5.5 | ตรวจสอบให้แน่ใจว่าการพยายามปลอมแปลงหรือความขัดแย้งของกุญแจทำให้เกิดการกักกันเอเยนต์ที่ได้รับผลกระทบทันที                           |   3   | D/V  |

---

## 9.6 การลดความเสี่ยงของฝูงหลายตัวแทน

ลดความเสี่ยงจากพฤติกรรมแบบกลุ่มผ่านการแยกตัวและการสร้างแบบจำลองความปลอดภัยอย่างเป็นทางการ

|   #   | Description                                                                                                                             | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.6.1 | ตรวจสอบว่าเอเจนต์ที่ทำงานในโดเมนความปลอดภัยที่แตกต่างกันทำงานในสภาพแวดล้อมรันไทม์แซนด์บ็อกซ์หรือเซ็กเมนต์เครือข่ายที่แยกกันอย่างโดดเด่น |   1   | D/V  |
| 9.6.2 | ตรวจสอบให้แน่ใจว่าพฤติกรรมของฝูงถูกสร้างแบบจำลองและตรวจสอบอย่างเป็นทางการเพื่อความมีชีวิตชีวาและความปลอดภัยก่อนการนำไปใช้               |   3   |  V   |
| 9.6.3 | ตรวจสอบให้แน่ใจว่า runtime monitors ตรวจจับรูปแบบความไม่ปลอดภัยที่เกิดขึ้นใหม่ (เช่น การสั่น การติดล็อก) และเริ่มดำเนินการแก้ไขทันที    |   3   |  D   |

---

## 9.7 การตรวจสอบสิทธิ์ / การอนุญาตของผู้ใช้และเครื่องมือ

ดำเนินการควบคุมการเข้าถึงที่แข็งแกร่งสำหรับทุกการกระทำที่ถูกกระตุ้นโดยเอเจนต์

|   #   | Description                                                                                                                          | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 9.7.1 | ตรวจสอบให้แน่ใจว่าเอเย่นต์ยืนยันตัวตนในฐานะผู้มีอำนาจหลักระดับหนึ่งกับระบบปลายทาง โดยไม่ใช้ข้อมูลประจำตัวของผู้ใช้ปลายทางซ้ำ         |   1   | D/V  |
| 9.7.2 | ตรวจสอบให้นโยบายการอนุญาตละเอียดจำกัดว่าเครื่องมือใดที่ตัวแทนอาจเรียกใช้งานได้และพารามิเตอร์ใดที่สามารถส่งได้                        |   2   |  D   |
| 9.7.3 | ตรวจสอบให้แน่ใจว่าการตรวจสอบสิทธิ์จะถูกประเมินใหม่ในทุกครั้งที่เรียกใช้งาน (การอนุญาตต่อเนื่อง) ไม่ใช่เฉพาะตอนเริ่มต้นเซสชันเท่านั้น |   2   |  V   |
| 9.7.4 | ตรวจสอบให้แน่ใจว่า สิทธิ์ที่มอบหมายหมดอายุโดยอัตโนมัติและต้องได้รับความยินยอมใหม่หลังจากหมดเวลา หรือมีการเปลี่ยนแปลงขอบเขตสิทธิ์     |   3   |  D   |

---

## 9.8 ความปลอดภัยในการสื่อสารระหว่างเอเย่นต์

เข้ารหัสและปกป้องความสมบูรณ์ของข้อความระหว่างตัวแทนทั้งหมดเพื่อป้องกันการดักฟังและการแก้ไขข้อมูล

|   #   | Description                                                                                                                                                         | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.8.1 | ตรวจสอบให้แน่ใจว่าการตรวจสอบสิทธิ์แบบสองฝ่ายและการเข้ารหัสที่รักษาความลับล่วงหน้าอย่างสมบูรณ์ (เช่น TLS 1.3) เป็นข้อบังคับสำหรับช่องทางตัวแทน                       |   1   | D/V  |
| 9.8.2 | ตรวจสอบให้แน่ใจว่าสภาพสมบูรณ์ของข้อความและที่มาถูกตรวจสอบก่อนการประมวลผล; ในกรณีที่ล้มเหลวจะส่งสัญญาณเตือนและยกเลิกข้อความนั้นทันที                                 |   1   |  D   |
| 9.8.3 | ตรวจสอบให้แน่ใจว่าข้อมูลเมตาของการสื่อสาร (เช่น เวลา, หมายเลขลำดับ) ถูกบันทึกไว้เพื่อสนับสนุนการสร้างหลักฐานย้อนหลัง                                                |   2   | D/V  |
| 9.8.4 | ตรวจสอบให้แน่ใจว่าการพิสูจน์ความถูกต้องอย่างเป็นทางการหรือการตรวจสอบแบบจำลองยืนยันได้ว่าเครื่องจักรสถานะของโปรโตคอลไม่สามารถถูกขับเคลื่อนไปสู่สถานะที่ไม่ปลอดภัยได้ |   3   |  V   |

---

## 9.9 การยืนยันเจตนาและการบังคับใช้ข้อจำกัด

ตรวจสอบให้แน่ใจว่าการกระทำของตัวแทนสอดคล้องกับเจตนาที่ผู้ใช้ระบุไว้และข้อจำกัดของระบบ

|   #   | Description                                                                                                                                                                   | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.9.1 | ตรวจสอบให้แน่ใจว่าเครื่องแก้ข้อจำกัดก่อนการดำเนินการตรวจสอบการกระทำที่เสนอเทียบกับกฎความปลอดภัยและนโยบายที่ฝังไว้ในโค้ดอย่างเคร่งครัด                                         |   1   |  D   |
| 9.9.2 | ตรวจสอบให้แน่ใจว่าการดำเนินการที่มีผลกระทบรุนแรง (ทางการเงิน, การทำลาย, ความเป็นส่วนตัวที่ละเอียดอ่อน) ต้องได้รับการยืนยันเจตนาอย่างชัดเจนจากผู้ใช้ที่เริ่มต้นดำเนินการนั้น   |   2   | D/V  |
| 9.9.3 | ตรวจสอบให้แน่ใจว่าการตรวจสอบหลังเงื่อนไขยืนยันว่าการดำเนินการที่เสร็จสมบูรณ์ได้บรรลุผลที่ตั้งใจไว้โดยไม่มีผลข้างเคียง; ความคลาดเคลื่อนจะทำให้เกิดการย้อนกลับข้อมูล (rollback) |   2   |  V   |
| 9.9.4 | ตรวจสอบให้แน่ใจว่าวิธีการเชิงรูปธรรม (เช่น การตรวจสอบแบบจำลอง การพิสูจน์ทฤษฎีบท) หรือการทดสอบแบบอิงสมบัติ แสดงให้เห็นว่าแผนงานของเอเยนต์เป็นไปตามข้อจำกัดที่ระบุทั้งหมด       |   3   |  V   |
| 9.9.5 | ตรวจสอบให้แน่ใจว่าเหตุการณ์ความผิดพลาดของเจตนาหรือการละเมิดข้อจำกัดได้ป้อนข้อมูลเข้าสู่กระบวนการปรับปรุงอย่างต่อเนื่องและการแบ่งปันข้อมูลข่าวกรองภัยคุกคาม                    |   3   |  D   |

---

## 9.10 กลยุทธ์การให้เหตุผลของเอเย่นต์ด้านความปลอดภัย

การเลือกและดำเนินกลยุทธ์การให้เหตุผลที่แตกต่างกันอย่างปลอดภัย รวมถึงวิธีการ ReAct, Chain-of-Thought, และ Tree-of-Thoughts

|   #    | Description                                                                                                                                                                                                               | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.10.1 | ตรวจสอบให้แน่ใจว่าการเลือกกลยุทธ์การให้เหตุผลใช้เกณฑ์ที่เป็นเชิงกำหนด (ความซับซ้อนของอินพุต, ประเภทของงาน, บริบทความปลอดภัย) และอินพุตที่เหมือนกันจะให้การเลือกกลยุทธ์ที่เหมือนกันภายในบริบทความปลอดภัยเดียวกัน           |   1   | D/V  |
| 9.10.2 | ตรวจสอบให้แน่ใจว่ายุทธศาสตร์การให้เหตุผลแต่ละประเภท (ReAct, Chain-of-Thought, Tree-of-Thoughts) มีการตรวจสอบความถูกต้องของข้อมูลนำเข้า การล้างข้อมูลผลลัพธ์ และการจำกัดเวลาการทำงานที่เฉพาะเจาะจงสำหรับวิธีการคิดของตนเอง |   1   | D/V  |
| 9.10.3 | ตรวจสอบให้แน่ใจว่าการเปลี่ยนแปลงกลยุทธ์การให้เหตุผลถูกบันทึกพร้อมบริบทที่ครบถ้วน รวมถึงลักษณะของข้อมูลนำเข้า ค่าของเกณฑ์การเลือก และเมตาดาต้าการดำเนินงานเพื่อการสร้างเส้นทางการตรวจสอบย้อนหลัง                           |   2   | D/V  |
| 9.10.4 | ตรวจสอบให้แน่ใจว่าเหตุผลในรูปแบบ Tree-of-Thoughts รวมถึงกลไกการตัดแต่งกิ่งที่หยุดการสำรวจเมื่อพบการละเมิดนโยบาย ขีดจำกัดทรัพยากร หรือขอบเขตด้านความปลอดภัย                                                                |   2   | D/V  |
| 9.10.5 | ตรวจสอบให้แน่ใจว่ารอบ ReAct (Reason-Act-Observe) มีจุดตรวจสอบการยืนยันในแต่ละขั้นตอน ได้แก่ การตรวจสอบความถูกต้องของขั้นตอนการสรุปเหตุผล การอนุญาตการดำเนินการ และการทำความสะอาดผลการสังเกตก่อนดำเนินการต่อไป             |   2   | D/V  |
| 9.10.6 | ตรวจสอบให้แน่ใจว่ามาตรวัดประสิทธิภาพของกลยุทธ์การให้เหตุผล (เวลาการประมวลผล การใช้ทรัพยากร คุณภาพผลลัพธ์) ได้รับการติดตามด้วยการแจ้งเตือนอัตโนมัติเมื่อมาตรวัดเบี่ยงเบนเกินเกณฑ์ที่ตั้งไว้                                |   3   | D/V  |
| 9.10.7 | ตรวจสอบให้แน่ใจว่าวิธีการใช้เหตุผลแบบผสมผสานที่รวมกลยุทธ์หลายอย่างจะรักษาการตรวจสอบความถูกต้องของข้อมูลนำเข้าและข้อจำกัดผลลัพธ์ของกลยุทธ์แต่ละอย่างโดยไม่ละเมิดการควบคุมความปลอดภัยใดๆ                                    |   3   | D/V  |
| 9.10.8 | ตรวจสอบให้แน่ใจว่าการทดสอบความปลอดภัยของกลยุทธ์การให้เหตุผลประกอบด้วยการฟัซซิงด้วยข้อมูลป้อนเข้าที่ผิดรูปแบบ, การใช้คำสั่งที่จงใจโจมตีเพื่อบังคับให้เปลี่ยนกลยุทธ์, และการทดสอบเงื่อนไขขอบเขตสำหรับแต่ละวิธีทางปัญญา      |   3   | D/V  |

---

## 9.11 การจัดการสถานะวงจรชีวิตของเอเจนต์และความมั่นคงปลอดภัย

การเริ่มต้นตัวแทนที่ปลอดภัย การเปลี่ยนแปลงสถานะ และการสิ้นสุดด้วยร่องรอยการตรวจสอบทางคริปโตกราฟีและขั้นตอนการกู้คืนที่กำหนดไว้

|   #    | Description                                                                                                                                                                                                                                                  | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 9.11.1 | ตรวจสอบให้แน่ใจว่าการเริ่มต้นตัวแทรรวมถึงการสร้างเอกลักษณ์ทางคริปโตกราฟีโดยใช้ข้อมูลประจำตัวที่หนุนด้วยฮาร์ดแวร์และบันทึกการตรวจสอบการเริ่มต้นระบบที่ไม่สามารถแก้ไขได้ซึ่งประกอบด้วยรหัสตัวแทน, เวลาที่บันทึก, แฮชการกำหนดค่า และพารามิเตอร์การเริ่มต้นระบบ  |   1   | D/V  |
| 9.11.2 | ตรวจสอบให้แน่ใจว่าการเปลี่ยนแปลงสถานะของเอเจนต์ได้รับลายเซ็นทางคริปโตกราฟี มีการประทับเวลาที่ถูกต้อง และถูกบันทึกไว้พร้อมบริบทที่ครบถ้วน รวมถึงเหตุการณ์ที่เป็นตัวกระตุ้น รหัสแฮชสถานะก่อนหน้า รหัสแฮชสถานะใหม่ และการตรวจสอบด้านความปลอดภัยที่ดำเนินการแล้ว |   2   | D/V  |
| 9.11.3 | ตรวจสอบให้แน่ใจว่าขั้นตอนการปิดตัวเอเจนต์รวมถึงการลบหน่วยความจำอย่างปลอดภัยโดยใช้การลบด้วยการเข้ารหัสหรือการเขียนทับหลายรอบ การเพิกถอนข้อมูลรับรองพร้อมการแจ้งหน่วยงานออกใบรับรอง และการสร้างใบรับรองการยุติการทำงานที่ตรวจจับการปลอมแปลงได้                 |   2   | D/V  |
| 9.11.4 | ตรวจสอบให้แน่ใจว่า กลไกการกู้คืนตัวแทน ตรวจสอบความถูกต้องของสถานะโดยใช้ตรวจสอบความสมบูรณ์ด้วยรหัสลับ (checksum แบบ SHA-256 ขั้นต่ำ) และย้อนกลับไปยังสถานะที่รู้ว่าปลอดภัยเมื่อพบการเสียหาย พร้อมทั้งแจ้งเตือนอัตโนมัติและกำหนดให้ต้องได้รับการอนุมัติด้วยมือ |   3   | D/V  |
| 9.11.5 | ตรวจสอบให้แน่ใจว่าเครื่องมือเก็บข้อมูลสถานะของเอเย่นต์ทำการเข้ารหัสข้อมูลสถานะที่สำคัญด้วยคีย์ AES-256 ต่อเอเย่นต์ และดำเนินการหมุนเวียนคีย์อย่างปลอดภัยตามตารางเวลาที่กำหนดค่าได้ (สูงสุด 90 วัน) พร้อมการปรับใช้โดยไม่หยุดชะงัก                            |   3   | D/V  |

---

## 9.12 กรอบการรักษาความปลอดภัยการรวมเครื่องมือ

การควบคุมความปลอดภัยสำหรับการโหลดเครื่องมือแบบไดนามิก การดำเนินการ และการตรวจสอบผลลัพธ์ พร้อมกระบวนการประเมินความเสี่ยงและอนุมัติที่กำหนดไว้

|   #    | Description                                                                                                                                                                                                                                                            | Level | Role |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.12.1 | ตรวจสอบให้แน่ใจว่าตัวบ่งชี้เครื่องมือมีเมตาดาต้าด้านความปลอดภัยที่ระบุสิทธิ์ที่จำเป็น (อ่าน/เขียน/ดำเนินการ), ระดับความเสี่ยง (ต่ำ/ปานกลาง/สูง), ขีดจำกัดทรัพยากร (ซีพียู, หน่วยความจำ, เครือข่าย) และข้อกำหนดการตรวจสอบที่ได้รับการบันทึกในเอกสารเครื่องมือ           |   1   | D/V  |
| 9.12.2 | ตรวจสอบให้แน่ใจว่าผลลัพธ์การทำงานของเครื่องมือนั้นได้รับการยืนยันความถูกต้องตามแบบแผนที่คาดไว้ (JSON Schema, XML Schema) และนโยบายความปลอดภัย (การทำความสะอาดผลลัพธ์, การจัดประเภทข้อมูล) ก่อนการรวมระบบ พร้อมด้วยข้อจำกัดด้านเวลาและขั้นตอนการจัดการข้อผิดพลาด        |   1   | D/V  |
| 9.12.3 | ตรวจสอบให้แน่ใจว่าบันทึกการโต้ตอบเครื่องมือรวมบริบทด้านความปลอดภัยอย่างละเอียด ซึ่งรวมถึงการใช้สิทธิ์ รูปแบบการเข้าถึงข้อมูล เวลาการดำเนินการ การใช้ทรัพยากร และรหัสการคืนค่าพร้อมกับการบันทึกอย่างมีโครงสร้างเพื่อการผนวกรวมกับ SIEM                                  |   2   | D/V  |
| 9.12.4 | ตรวจสอบให้แน่ใจว่าเมคานิซึมการโหลดเครื่องมือแบบไดนามิกทำการตรวจสอบลายเซ็นดิจิทัลโดยใช้โครงสร้างพื้นฐาน PKI และนำโปรโตคอลการโหลดที่ปลอดภัยมาใช้โดยมีการแยกส่วน sandbox และการตรวจสอบสิทธิ์ก่อนการประมวลผล                                                               |   2   | D/V  |
| 9.12.5 | ตรวจสอบให้แน่ใจว่าการประเมินความปลอดภัยของเครื่องมือถูกทริกเกอร์โดยอัตโนมัติสำหรับเวอร์ชันใหม่พร้อมกับเกตการอนุมัติที่บังคับใช้ซึ่งรวมถึงการวิเคราะห์แบบคงที่ การทดสอบแบบไดนามิก และการตรวจสอบโดยทีมความปลอดภัยโดยมีเกณฑ์การอนุมัติและข้อกำหนด SLA ที่เป็นเอกสารประกอบ |   3   | D/V  |

---

### บรรณานุกรม

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)

