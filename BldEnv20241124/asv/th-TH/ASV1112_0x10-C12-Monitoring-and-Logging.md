# การตรวจสอบ การบันทึก และการตรวจจับความผิดปกติ (C12)

## วัตถุประสงค์การควบคุม

ส่วนนี้ให้ข้อกำหนดสำหรับการมอบการมองเห็นแบบเรียลไทม์และการวิเคราะห์ทางนิติวิทยาศาสตร์เกี่ยวกับสิ่งที่โมเดลและส่วนประกอบ AI อื่นๆ เห็น ทำ และส่งคืน เพื่อให้สามารถตรวจจับ จัดลำดับความสำคัญ และเรียนรู้จากภัยคุกคามได้

## C12.1 การบันทึกคำขอและการตอบสนอง

|   #    | Description                                                                                                                                                                                                     | Level | Role |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.1.1 | ตรวจสอบให้แน่ใจว่าทุกข้อความคำสั่งของผู้ใช้และการตอบกลับของโมเดลถูกบันทึกพร้อมกับเมตาดาต้าที่เหมาะสม (เช่น ตราประทับเวลาที่, รหัสผู้ใช้, รหัสเซสชัน, เวอร์ชันของโมเดล)                                          |   1   | D/V  |
| 12.1.2 | ตรวจสอบให้แน่ใจว่าบันทึกถูกเก็บไว้ในที่เก็บข้อมูลที่ปลอดภัย มีการควบคุมการเข้าถึง พร้อมกับมีนโยบายการเก็บรักษาข้อมูลและขั้นตอนการสำรองข้อมูลที่เหมาะสม                                                          |   1   | D/V  |
| 12.1.3 | ตรวจสอบให้แน่ใจว่าระบบจัดเก็บบันทึกใช้การเข้ารหัสทั้งในสถานะพักข้อมูลและระหว่างการส่งข้อมูลเพื่อปกป้องข้อมูลที่ละเอียดอ่อนที่บรรจุอยู่ในบันทึก                                                                  |   1   | D/V  |
| 12.1.4 | ตรวจสอบให้แน่ใจว่าข้อมูลที่ละเอียดอ่อนในคำสั่งและผลลัพธ์ถูกปกปิดหรือซ่อนไว้ก่อนบันทึกโดยอัตโนมัติ โดยมีกฎการปกปิดที่สามารถกำหนดค่าได้สำหรับข้อมูลระบุตัวตนส่วนบุคคล (PII), ข้อมูลรับรอง และข้อมูลทรัพย์สินเฉพาะ |   1   | D/V  |
| 12.1.5 | ตรวจสอบให้แน่ใจว่าการตัดสินใจนโยบายและการดำเนินการกรองความปลอดภัยมีการบันทึกอย่างละเอียดเพียงพอเพื่อรองรับการตรวจสอบและการแก้ไขปัญหาระบบการควบคุมเนื้อหา                                                        |   2   | D/V  |
| 12.1.6 | ตรวจสอบให้แน่ใจว่าความสมบูรณ์ของบันทึกถูกปกป้องผ่านเช่น ลายเซ็นทางคริปโตกราฟฟิกหรือการจัดเก็บแบบเขียนอย่างเดียว                                                                                                 |   2   | D/V  |

---

## C12.2 การตรวจจับและแจ้งเตือนการละเมิด

|   #    | Description                                                                                                                                                      | Level | Role |
| :----: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.2.1 | ตรวจสอบให้แน่ใจว่าระบบตรวจจับและแจ้งเตือนรูปแบบ jailbreak ที่รู้จัก, พยายามโจมตีด้วย prompt injection, และข้อมูลป้อนที่เป็นอันตรายโดยใช้การตรวจจับตามลายเซ็น     |   1   | D/V  |
| 12.2.2 | ตรวจสอบให้แน่ใจว่าระบบสามารถรวมเข้ากับแพลตฟอร์มจัดการข้อมูลและเหตุการณ์ด้านความปลอดภัย (SIEM) ที่มีอยู่โดยใช้รูปแบบบันทึกและโปรโตคอลมาตรฐาน                      |   1   | D/V  |
| 12.2.3 | ตรวจสอบให้แน่ใจว่าเหตุการณ์ความปลอดภัยที่ได้รับการเพิ่มข้อมูลประกอบด้วยบริบทเฉพาะของ AI เช่น ตัวระบุโมเดล คะแนนความมั่นใจ และการตัดสินใจของตัวกรองความปลอดภัย    |   2   | D/V  |
| 12.2.4 | ตรวจสอบให้แน่ใจว่าการตรวจจับพฤติกรรมผิดปกติสามารถระบุรูปแบบการสนทนาที่ผิดปกติ ความพยายามในการลองซ้ำมากเกินไป หรือพฤติกรรมการสืบค้นอย่างเป็นระบบได้               |   2   | D/V  |
| 12.2.5 | ตรวจสอบให้แน่ใจว่า กลไกการแจ้งเตือนแบบเรียลไทม์แจ้งเตือนทีมรักษาความปลอดภัยเมื่อพบการละเมิดนโยบายที่อาจเกิดขึ้นหรือตรวจจับความพยายามโจมตีได้                     |   2   | D/V  |
| 12.2.6 | ตรวจสอบให้แน่ใจว่ามีกฎที่กำหนดเองรวมอยู่เพื่อใช้ตรวจจับรูปแบบภัยคุกคามเฉพาะ AI รวมถึงความพยายามเจลเบรกที่ประสานงานกัน การรณรงค์ฉีดคำสั่ง และการโจมตีสกัดแบบจำลอง |   2   | D/V  |
| 12.2.7 | ตรวจสอบให้แน่ใจว่าเวิร์กโฟลว์การตอบสนองต่อเหตุการณ์อัตโนมัติสามารถแยกโมเดลที่ถูกโจมตี บล็อกผู้ใช้ที่เป็นอันตราย และยกระดับเหตุการณ์ความปลอดภัยที่สำคัญได้        |   3   | D/V  |

---

## C12.3 การตรวจจับการลอยของแบบจำลอง

|   #    | Description                                                                                                                                                                | Level | Role |
| :----: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.3.1 | ตรวจสอบให้แน่ใจว่าระบบติดตามเมตริกประสิทธิภาพพื้นฐาน เช่น ความแม่นยำ คะแนนความมั่นใจ ความหน่วงเวลา และอัตราข้อผิดพลาดในแต่ละเวอร์ชันของโมเดลและช่วงระยะเวลาต่างๆ           |   1   | D/V  |
| 12.3.2 | ตรวจสอบให้แน่ใจว่าการแจ้งเตือนอัตโนมัติทำงานเมื่อเมตริกประสิทธิภาพเกินเกณฑ์การเสื่อมประสิทธิภาพที่กำหนดไว้ล่วงหน้าหรือเบี่ยงเบนอย่างมีนัยสำคัญจากมาตรฐานฐานข้อมูล          |   2   | D/V  |
| 12.3.3 | ตรวจสอบให้แน่ใจว่าตัวตรวจจับการหลงผิดสามารถระบุและแจ้งเตือนกรณีที่ผลลัพธ์ของโมเดลมีข้อมูลที่ไม่ถูกต้องตามข้อเท็จจริง ไม่สอดคล้องกัน หรือถูกสร้างขึ้นมาใหม่อย่างไม่มีมูลฐาน |   2   | D/V  |

---

## C12.4 การเก็บข้อมูลประสิทธิภาพและพฤติกรรม

|   #    | Description                                                                                                                                                        | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 12.4.1 | ตรวจสอบให้แน่ใจว่ามาตรวัดการปฏิบัติงานรวมถึงความล่าช้าของคำขอ การใช้โทเค็น การใช้หน่วยความจำ และอัตราการประมวลผล ถูกเก็บรวบรวมและติดตามอย่างต่อเนื่อง              |   1   | D/V  |
| 12.4.2 | ตรวจสอบให้แน่ใจว่าอัตราความสำเร็จและความล้มเหลวถูกติดตามพร้อมกับการจัดหมวดหมู่ประเภทข้อผิดพลาดและสาเหตุหลักของข้อผิดพลาดเหล่านั้น                                  |   1   | D/V  |
| 12.4.3 | ตรวจสอบให้แน่ใจว่าการติดตามการใช้งานทรัพยากรรวมถึงการใช้งาน GPU/CPU, การใช้หน่วยความจำ, และความต้องการพื้นที่จัดเก็บ พร้อมการแจ้งเตือนเมื่อเกินขีดจำกัดที่กำหนดไว้ |   2   | D/V  |

---

## C12.5 การวางแผนและดำเนินการตอบสนองเหตุการณ์ AI

|   #    | Description                                                                                                                                                                     | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.5.1 | ตรวจสอบให้แน่ใจว่าแผนการตอบสนองเหตุการณ์มีการระบุชัดเจนถึงเหตุการณ์ด้านความปลอดภัยที่เกี่ยวข้องกับ AI เช่น การถูกประนีประนอมของโมเดล การปลอมปนข้อมูล และการโจมตีโดยผู้ไม่หวังดี |   1   | D/V  |
| 12.5.2 | ตรวจสอบให้แน่ใจว่าทีมตอบสนองเหตุการณ์มีการเข้าถึงเครื่องมือพิสูจน์หลักฐานเฉพาะ AI และความเชี่ยวชาญในการสอบสวนพฤติกรรมของโมเดลและเวกเตอร์การโจมตี                                |   2   | D/V  |
| 12.5.3 | ตรวจสอบให้แน่ใจว่าการวิเคราะห์หลังเหตุการณ์รวมถึงการพิจารณาการฝึกสอนโมเดลใหม่ การปรับปรุงตัวกรองความปลอดภัย และการบูรณาการบทเรียนที่ได้รับเข้าสู่การควบคุมความปลอดภัย           |   3   | D/V  |

---

## C12.5 การตรวจจับการเสื่อมประสิทธิภาพของ AI

ตรวจสอบและตรวจจับการเสื่อมสภาพของประสิทธิภาพและคุณภาพของโมเดล AI ตลอดเวลา

|   #    | Description                                                                                                                                                 | Level | Role |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.5.1 | ตรวจสอบให้แน่ใจว่าความแม่นยำของโมเดล ค่า Precision, Recall และคะแนน F1 ถูกติดตามอย่างต่อเนื่องและเปรียบเทียบกับเกณฑ์มาตรฐานพื้นฐาน                          |   1   | D/V  |
| 12.5.2 | ตรวจสอบให้แน่ใจว่าการตรวจจับการเปลี่ยนแปลงข้อมูล (data drift detection) เฝ้าดูการเปลี่ยนแปลงของการแจกแจงข้อมูลอินพุตที่อาจส่งผลกระทบต่อประสิทธิภาพของโมเดล  |   1   | D/V  |
| 12.5.3 | ตรวจสอบให้แน่ใจว่าการตรวจจับการเปลี่ยนแปลงของแนวคิดสามารถระบุการเปลี่ยนแปลงในความสัมพันธ์ระหว่างข้อมูลนำเข้าและผลลัพธ์ที่คาดหวังได้อย่างถูกต้อง             |   2   | D/V  |
| 12.5.4 | ตรวจสอบให้แน่ใจว่าการลดลงของประสิทธิภาพจะเป็นสาเหตุให้เกิดการแจ้งเตือนอัตโนมัติและเริ่มต้นกระบวนการฝึกโมเดลใหม่หรือการเปลี่ยนโมเดล                          |   2   | D/V  |
| 12.5.5 | ตรวจสอบให้แน่ใจว่าการวิเคราะห์สาเหตุรากเหง้าของการเสื่อมสภาพเชื่อมโยงการลดลงของประสิทธิภาพกับการเปลี่ยนแปลงของข้อมูล ปัญหาโครงสร้างพื้นฐาน หรือปัจจัยภายนอก |   3   |  V   |

---

## C12.6 การแสดงภาพ DAG และความปลอดภัยของเวิร์กโฟลว์

ปกป้องระบบการแสดงภาพเวิร์กโฟลว์จากการรั่วไหลของข้อมูลและการโจมตีโดยการบิดเบือนข้อมูล

|   #    | Description                                                                                                                                                                    | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 12.6.1 | ตรวจสอบให้แน่ใจว่าข้อมูลการแสดงผล DAG ผ่านการทำความสะอาดเพื่อกำจัดข้อมูลที่ละเอียดอ่อนก่อนการจัดเก็บหรือส่งต่อ                                                                 |   1   | D/V  |
| 12.6.2 | ตรวจสอบให้แน่ใจว่าการควบคุมการเข้าถึงการแสดงภาพเวิร์กโฟลว์ช่วยให้เฉพาะผู้ใช้ที่ได้รับอนุญาตเท่านั้นที่สามารถดูเส้นทางการตัดสินใจของเอเจนต์และการติดตามเหตุผลได้                |   1   | D/V  |
| 12.6.3 | ตรวจสอบให้แน่ใจว่าความสมบูรณ์ของข้อมูล DAG ถูกป้องกันผ่านลายเซ็นทางคริปโตกราฟีและกลไกการจัดเก็บที่ตรวจจับการแก้ไขข้อมูลได้                                                     |   2   | D/V  |
| 12.6.4 | ตรวจสอบให้แน่ใจว่าระบบการแสดงภาพเวิร์กโฟลว์มีการตรวจสอบความถูกต้องของข้อมูลนำเข้าเพื่อป้องกันการโจมตีแบบฉีดข้อมูลผ่านข้อมูลโหนดหรือลักษณะเชื่อมโยงที่ถูกสร้างขึ้นอย่างประดิษฐ์ |   2   | D/V  |
| 12.6.5 | ตรวจสอบให้แน่ใจว่าการอัปเดต DAG แบบเรียลไทม์ถูกจำกัดความถี่และได้รับการตรวจสอบเพื่อลดการโจมตีปฏิเสธการให้บริการบนระบบการแสดงผลข้อมูล                                           |   3   | D/V  |

---

## C12.7 การเฝ้าติดตามพฤติกรรมด้านความปลอดภัยเชิงรุก

การตรวจจับและป้องกันภัยคุกคามด้านความปลอดภัยผ่านการวิเคราะห์พฤติกรรมของตัวแทนแบบเชิงรุก

|   #    | Description                                                                                                                                   | Level | Role |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 12.7.1 | ตรวจสอบให้แน่ใจว่าพฤติกรรมของตัวแทนเชิงรุกได้รับการตรวจสอบด้านความปลอดภัยก่อนการดำเนินการ โดยมีการบูรณาการการประเมินความเสี่ยง                |   1   | D/V  |
| 12.7.2 | ตรวจสอบให้แน่ใจว่าการริเริ่มอัตโนมัติรวมถึงการประเมินบริบทความปลอดภัยและการประเมินภูมิทัศน์ภัยคุกคามด้วย                                      |   2   | D/V  |
| 12.7.3 | ตรวจสอบให้แน่ใจว่ารูปแบบพฤติกรรมเชิงรุกได้รับการวิเคราะห์เพื่อหาผลกระทบด้านความปลอดภัยที่อาจเกิดขึ้นและผลที่ไม่คาดคิด                         |   2   | D/V  |
| 12.7.4 | ตรวจสอบให้แน่ใจว่าการดำเนินการเชิงรุกที่สำคัญด้านความปลอดภัยจำเป็นต้องได้รับการอนุมัติอย่างชัดเจนพร้อมกับมีเส้นทางการตรวจสอบ (audit trails)   |   3   | D/V  |
| 12.7.5 | ตรวจสอบให้แน่ใจว่าการตรวจจับความผิดปกติของพฤติกรรมสามารถระบุความเบี่ยงเบนในรูปแบบของเอเจนต์ที่มีความเป็นเชิงรุกซึ่งอาจบ่งชี้ถึงการถูกโจมตีได้ |   3   | D/V  |

---

## เอกสารอ้างอิง

* [NIST AI Risk Management Framework 1.0 - Manage 4.1 and 4.3](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [ISO/IEC 42001:2023 — AI Management Systems Requirements - Annex B 6.2.6](https://www.iso.org/standard/81230.html)
* [EU AI Act — Article 12, 13, 16 and 19 on Logging and Record-keeping](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32024R1689)

