# 9 אבטחת תיאום אוטונומי ופעולה סוכנית

## מטרת הבקרה

וודאו שמערכות AI אוטונומיות או רב-סוכניות יכולות לבצע רק פעולות שמיועדות במפורש, מאומתות, ניתנות לבדיקת ביקורת, ובתוך גבולות של עלות וסיכון מוגדרים. זה מגן מפני איומים כמו פגיעה במערכת אוטונומית, שימוש לרעה בכלים, גילוי לולאות סוכן, חטיפת תקשורת, זיוף זהות, מניפולציה על רס"ר (Swarm), ומניפולציה על כוונות.

---

## 9.1 תקציבי תכנון משימות סוכן ורקורסיה

הגבל תוכניות רקורסיביות וכפה נקודות ביקורת אנושיות עבור פעולות מועדפות.

|   #   | Description                                                                                                                                           | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.1.1 | וודא שעומק הרקורסיה המרבי, רוחב הפעולה, זמן השעון האמיתי, מספר הטוקנים והעלות הכספית לביצוע כל סוכן מוגדרים באופן מרכזי ומתוחזקים בשליטת גרסאות.      |   1   | D/V  |
| 9.1.2 | אשר כי פעולות שיש להן זכויות יתר או שאינן הפיכות (למשל, התחייבויות קוד, העברות כספיות) דורשות אישור מפורש מבני אדם דרך ערוץ הניתן לבדיקה לפני ביצוען. |   1   | D/V  |
| 9.1.3 | אמת שהמנטרים בזמן אמת של המשאבים מפעילים ניתוק של המעגל כשהיעד התקציבי כלשהו מופרז, ועוצרים הרחבה נוספת של המשימות.                                   |   2   |  D   |
| 9.1.4 | אמתו כי אירועי מפסק המעגל מתועדים עם מזהה הסוכן, תנאי ההפעלה ומצב התכנית הנלכד לצורך סקירה פורנזית.                                                   |   2   | D/V  |
| 9.1.5 | אמת כי בדיקות אבטחה כוללות תרחישי מיצוי תקציב ותכניות רצות ללא שליטה, ומאשרות עצירה בטוחה ללא איבוד נתונים.                                           |   3   |  V   |
| 9.1.6 | וידא כי מדיניות התקציב מבוטאת כמדיניות-כקוד ומאוכפת ב-CI/CD כדי למנוע סטיות בתצורה.                                                                   |   3   |  D   |

---

## 9.2 סנדבוקסינג של תוספי כלים

לבודד אינטראקציות של כלי כדי למנוע גישה לא מאושרת למערכת או ביצוע קוד.

|   #   | Description                                                                                                                               | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.2.1 | וודא שכל כלי/תוסף מתבצע בתוך מערכת הפעלה, מכולה, או סנדרבוקס ברמת WASM עם מדיניות הרשאות מינימלית לניהול מערכת קבצים, רשת, וקריאות מערכת. |   1   | D/V  |
| 9.2.2 | וודא כי מגבלות המשאבים של הסביבה המבודדת (CPU, זיכרון, דיסק, יציאת רשת) וזמני ההפעלה נאכפים ומתועדים ביומן.                               |   1   | D/V  |
| 9.2.3 | אמת שהקבצים המקוריים של הכלים או התיאורים שלהם חתומים דיגיטלית; חתימות מאומתות לפני טעינה.                                                |   2   | D/V  |
| 9.2.4 | אמת כי הזרמת טלמטריה מהסנדבוקס ל-SIEM מתבצעת; חריגות (למשל, ניסיונות לחיבורים יוצאים) גורמות להתרעות.                                     |   2   |  V   |
| 9.2.5 | וודא כי תוספים בסיכון גבוה עוברים סקירת אבטחה ובדיקות חדירה לפני פריסת הייצור.                                                            |   3   |  V   |
| 9.2.6 | וודא שניסיונות בריחה מתיבת חול מנועים אוטומטית והתוסף המפר זכאי להסגר במצב המתנה לחקירה.                                                  |   3   | D/V  |

---

## 9.3 לולאה אוטונומית והגבלת עלות

לאתר ולמנוע רקורסיה בלתי מבוקרת בין סוכנים ופיצוץ עלויות.

|   #   | Description                                                                                        | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.3.1 | אמתו שקריאות בין סוכנים כוללות מגבלת קפיצה או TTL שהסביבת הריצה מפחיתה ומחייבת.                    |   1   | D/V  |
| 9.3.2 | אמת כי הסוכנים שומרים על מזהה ייחודי של גרף קריאות לזיהוי קריאות עצמית או דפוסים מחזוריים.         |   2   |  D   |
| 9.3.3 | וודא שמונים מצטברים של יחידות חישוב והוצאות מנוטרים לכל שרשרת בקשה; חריגה מהמגבלה מבטלת את השרשרת. |   2   | D/V  |
| 9.3.4 | אמתו כי ניתוח פורמלי או בדיקת מודל מראים העדר רקורסיה בלתי מוגבלת בפרוטוקולים של הסוכן.            |   3   |  V   |
| 9.3.5 | אשר שאירועי עצירת לולאה מייצרים התראות ומספקים מדדי שיפור מתמשך.                                   |   3   |  D   |

---

## 9.4 הגנה מפני שימוש לרעה ברמת הפרוטוקול

ערוצי תקשורת מאובטחים בין סוכנים למערכות חיצוניות כדי למנוע חטיפה או מניפולציה.

|   #   | Description                                                                                                | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.4.1 | אמת שכל ההודעות בין סוכן לכלי וסוכן לסוכן מאומתות (למשל, באמצעות TLS הדדי או JWT) ומוצפנות מקצה לקצה.      |   1   | D/V  |
| 9.4.2 | וודא שסכימות מאומתים בקפדנות; שדות לא מוכרים או הודעות שבורות נדחות.                                       |   1   |  D   |
| 9.4.3 | וודא שבדיקות השלמות (MACים או חתימות דיגיטליות) כוללות את כל משקל ההודעה כולל פרמטרי הכלי.                 |   2   | D/V  |
| 9.4.4 | וודא כי הגנת ההשמעה מחדש (nonce או חלונות חותמות זמן) נאכפת בשכבת הפרוטוקול.                               |   2   |  D   |
| 9.4.5 | אשר שיישומי הפרוטוקול עוברים בדיקת פאזינג וניתוח סטטי לזיהוי ליקויים בהזרקה או בנרמול מחדש (דיזריאליזציה). |   3   |  V   |

---

## 9.5 זהות הסוכן והוכחת זדוניות

וודא שהפעולות ניתן לייחס אותן ושינויים ניתנים לזיהוי.

|   #   | Description                                                                                   | Level | Role |
| :---: | --------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.5.1 | וודא שלכל מופע סוכן יש זהות קריפטוגרפית ייחודית (זוג מפתחות או אישור שמקורו בחומרה).          |   1   | D/V  |
| 9.5.2 | אשר שכל פעולות הסוכן חתומות ומסומנות בזמן; היומנים כוללים את החתימה לצורך אי הכחשה.           |   2   | D/V  |
| 9.5.3 | אמת שהיומנים המראים סימני נזק נשמרים במדיה שניתן להוסיף אליה בלבד או לכתוב אליה פעם אחת בלבד. |   2   |  V   |
| 9.5.4 | וודא שמפתחות הזיהוי מסתובבים על פי לוח זמנים מוגדר ועל סמנים של פגיעה.                        |   3   |  D   |
| 9.5.5 | ודא כי ניסיונות זיוף או קונפליקט מפתחות מפעילים בידוד מיידי של הסוכן המושפע.                  |   3   | D/V  |

---

## 9.6 הפחתת סיכון בעזרת קבוצת סוכנים רב-סוכנית

להפחית סיכונים בהתנהגות קולקטיבית באמצעות בידוד ומידול בטיחות פורמלי.

|   #   | Description                                                                                          | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.6.1 | וודא שהסוכנים הפועלים בדומיינים שונים של אבטחה מבוצעים בסביבות ריצה מבודדות או במקטעי רשת מבודדים.   |   1   | D/V  |
| 9.6.2 | אמתו כי התנהגויות קבוצתיות מדומיינות ומאומתות פורמלית לחיות ובטיחות לפני הפריסה.                     |   3   |  V   |
| 9.6.3 | ודא שמוניטורים בזמן ריצה מזהים תבניות לא בטוחות המתהוות (למשל, תנודות, כתמים) ומתחילים בפעולה מתקנת. |   3   |  D   |

---

## 9.7 אימות ואסמכתא של משתמשים וכלים

יש לממש בקרות גישה חזקות לכל פעולה המופעלת על ידי סוכן.

|   #   | Description                                                                                          | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.7.1 | וודא שסוכנים מאמתים את עצמם כגופים ראשוניים למערכות מטה, ולא משתמשים מחדש באישורי משתמשי הקצה.       |   1   | D/V  |
| 9.7.2 | וודא כי מדיניות הרשאות מדויקת מגבילה אילו כלים סוכן רשאי להפעיל ואילו פרמטרים הוא רשאי לספק.         |   2   |  D   |
| 9.7.3 | וודא כי בדיקות ההרשאות נשנות בכל קריאה (אישור רציף), ולא רק בתחילת המפגש.                            |   2   |  V   |
| 9.7.4 | וודא שההרשאות המוענקות פגות תוקף אוטומטית ודורשות הסכמה מחודשת לאחר תום הזמן או שינוי בטווח ההרשאות. |   3   |  D   |

---

## 9.8 אבטחת תקשורת סוכן-אל-סוכן

הצפן והגן על שלמות כל ההודעות בין הסוכנים כדי למנוע האזנה ועריכה בלתי מורשית.

|   #   | Description                                                                                              | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.8.1 | אמתו כי אימות הדדי והצפנת סודיות מושלמת קדימה (למשל TLS 1.3) הם חובה לערוצי הסוכן.                       |   1   | D/V  |
| 9.8.2 | ודא כי שלמות ההודעה ומקורה מאומתים לפני העיבוד; כשלים גורמים להתרעות ולהשלכת ההודעה.                     |   1   |  D   |
| 9.8.3 | אמתו שמטא-דאטה של תקשורת (חותמות זמן, מספרי רצף) מתועדת על מנת לתמוך בשחזור פורנזי.                      |   2   | D/V  |
| 9.8.4 | אמת שאימות פורמלי או בדיקת מודלים מאשרים שמכונות מצבים של הפרוטוקול אינן יכולות להימצא במצבים לא בטוחים. |   3   |  V   |

---

## 9.9 אימות כוונה ואכיפת מגבלות

לאמת שפעולות הסוכן תואמות לכוונת המשתמש המוצהרת ולמגבלות המערכת.

|   #   | Description                                                                                                                           | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.9.1 | ודא שמפענחי מגבלות לפני ביצוע בודקים את הפעולות המוצעות בהתאם לכללי בטיחות ומדיניות שנקבעו בקוד.                                      |   1   |  D   |
| 9.9.2 | וודא כי פעולות עם השפעה גבוהה (כלכלית, הרסנית, רגישות לפרטיות) דורשות אישור כוונה מפורש מהמשתמש היוזם.                                |   2   | D/V  |
| 9.9.3 | אמתו שבדיקות לאחר תנאי מאמתות שהפעולות שהושלמו השיגו את התוצאות המיועדות ללא תופעות לוואי; אי התאמות גורמות לביצוע חזרה (rollback).   |   2   |  V   |
| 9.9.4 | אמת שיטות פורמליות (לדוגמה, בדיקת מודלים, הוכחת משפטים) או בדיקות מבוססות תכונות מראות כי תוכניות הסוכן עונות על כל המגבלות המוצהרות. |   3   |  V   |
| 9.9.5 | וודא כי מקרים של חוסר התאמה בכוונה או הפרת מגבלות מזינים מחזורי שיפור מתמיד ושיתוף מודיעין איומים.                                    |   3   |  D   |

---

## 9.10 אבטחת אסטרטגיית הסקת מסקנות של סוכן

בחירה וביצוע מאובטחים של אסטרטגיות היסק שונות הכוללות את הגישות ReAct, שרשרת-מחשבה (Chain-of-Thought), ועץ-מחשבות (Tree-of-Thoughts).

|   #    | Description                                                                                                                                                        | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 9.10.1 | וודא כי בחירת אסטרטגיית ההסקה משתמשת בקריטריונים דטרמיניסטיים (מורכבות הקלט, סוג המשימה, הקשר אבטחה) וכי קלטים זהים מייצרים בחירות אסטרטגיה זהות באותו הקשר אבטחה. |   1   | D/V  |
| 9.10.2 | אשר כי לכל אסטרטגיית חשיבה (ReAct, שרשרת מחשבה, עץ מחשבות) יש ולידציה ייעודית לקלט, סניטיזציה של הפלט ומגבלות זמן ביצוע ספציפיות לגישת החשיבה שלה.                 |   1   | D/V  |
| 9.10.3 | אמתו שמעבר אסטרטגיות החשיבה מתועד עם הקשר מלא הכולל תכונות הקלט, ערכי קריטריוני הבחירה ומטא-נתוני הביצוע לשחזור מסלול הביקורת.                                     |   2   | D/V  |
| 9.10.4 | וודא שמנגנוני הסינון בסיעור מוחות מסוג Tree-of-Thoughts כוללים עצירת חקר כאשר מתגלות הפרות מדיניות, מגבלות משאבים או גבולות בטיחות.                                |   2   | D/V  |
| 9.10.5 | וודא כי מחזורי ReAct (הסקה-פעולה-תצפית) כוללים נקודות בדיקה לאימות בכל שלב: אימות שלב ההסקה, אישור הפעולה, וניקוי התצפית לפני ההתקדמות.                            |   2   | D/V  |
| 9.10.6 | וודא כי מדדי ביצוע של אסטרטגיית ההסקה (זמן ביצוע, שימוש במשאבים, איכות הפלט) מפוקחים עם התראות אוטומטיות כאשר המדדים חריגים מעבר לספים שהוגדרו.                    |   3   | D/V  |
| 9.10.7 | וודא כי גישות הסקת מסקנות היברידיות שמשלבות מספר אסטרטגיות שומרות על אימות הקלט ומגבלות הפלט של כל האסטרטגיות המרכיבות מבלי לעקוף כל בקרות אבטחה.                  |   3   | D/V  |
| 9.10.8 | אמת כי בדיקות אבטחת אסטרטגיית ההיגיון כוללות פאזינג עם קלטים מעוותים, הנחיות מתחרות שמטרתן לכפות החלפת אסטרטגיה, ובדיקות תנאי גבול לכל גישה קוגניטיבית.            |   3   | D/V  |

---

## 9.11 ניהול מצב מחזור חיים של סוכן ואבטחה

אתחול סוכן מאובטח, מעברי מצב, וסיום עם מעקב ביקורת קריפטוגרפי ופרוצדורות שחזור מוגדרות.

|   #    | Description                                                                                                                                                                                               | Level | Role |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.11.1 | אמת כי אתחול הסוכן כולל הקמת זהות קריפטוגרפית עם אישורים מגובים בחומרה ויומני ביקורת התחלה שאינם ניתנים לשינוי המכילים את מזהה הסוכן, חותמת זמן, גיבוב התצורה ופרמטרי אתחול.                              |   1   | D/V  |
| 9.11.2 | אמתו שמעברי מצב של הסוכן חתומים בצורה קריפטוגרפית, מתועדים עם חותמת זמן ונרשמים בלוג עם הקשר מלא הכולל את האירועים שהפעילו אותם, ערך הגיבוב של המצב הקודם, ערך הגיבוב של המצב החדש, ואימותי אבטחה שבוצעו. |   2   | D/V  |
| 9.11.3 | וודא שלנהלים לכיבוי הסוכן כלול מחיקה מאובטחת של זיכרון באמצעות מחיקה קריפטוגרפית או כתיבה חוזרת מרובת מעבר, ביטול הרשאות עם הודעה לרשות התעודות, ויצירת תעודות סיום מתנגדות לזיוף.                        |   2   | D/V  |
| 9.11.4 | אמתו שמנגנוני התאוששות הסוכן מאמתים את שלמות המצב באמצעות סכומי ביקורת קריפטוגרפיים (מינימום SHA-256) ומבצעים חזרה למצבים תקינים ידועים כאשר מתגלה שחיתות, עם התרעות אוטומטיות ודרישות לאישור ידני.       |   3   | D/V  |
| 9.11.5 | אמת שהמנגנונים לשימור סוכן מצפינים את נתוני המצב הרגישים באמצעות מפתחות AES-256 ייעודיים לכל סוכן, ומיישמים סיבוב מפתחות מאובטח בלוחות זמנים הניתנים להגדרה (מקסימום 90 יום) עם פריסה ללא השבתה.          |   3   | D/V  |

---

## 9.12 מסגרת אבטחת אינטגרציה של כלי עבודה

בקרות אבטחה להטענה דינמית של כלים, ביצועם ואימות התוצאות עם הערכת סיכונים מוגדרת ותהליכי אישור.

|   #    | Description                                                                                                                                                                                      | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 9.12.1 | וודא שתיאורי הכלים כוללים מטא-נתוני אבטחה שמפרטים הרשאות נדרשות (קריאה/כתיבה/הרצה), רמות סיכון (נמוך/בינוני/גבוה), גבולות משאבים (מעבד, זיכרון, רשת), ודרישות אימות המתועדות במניפסטים של הכלים. |   1   | D/V  |
| 9.12.2 | אמתו שהתוצאות של הרצת הכלי מאומתות לעומת סכימות צפויות (סכמת JSON, סכמת XML) ומדיניות אבטחה (ניקוי פלט, סיווג נתונים) לפני האינטגרציה, עם הגבלות זמן לטיפול ונהלי ניהול שגיאות.                  |   1   | D/V  |
| 9.12.3 | אמת שהלוגים של אינטראקציות הכלי כוללים הקשר אבטחה מפורט הכולל שימוש בהרשאות, דפוסי גישה לנתונים, זמן ביצוע, צריכת משאבים וקודי החזרה עם רישום מובנה לאינטגרציה עם SIEM.                          |   2   | D/V  |
| 9.12.4 | אמת שמנגנוני טעינת כלים דינמית מאשרים אימות חתימות דיגיטליות באמצעות תשתית PKI ומממשים פרוטוקולי טעינה מאובטחים עם בידוד סנדבוקס ואימות הרשאות לפני ביצוע.                                       |   2   | D/V  |
| 9.12.5 | אמת שהערכת אבטחת הכלים מופעלת באופן אוטומטי עבור גרסאות חדשות עם שערי אישור חובה הכוללים ניתוח סטטי, בדיקות דינמיות, ובחינת צוות האבטחה עם קריטריונים מאושרים ומסמכים לדרישות SLA.               |   3   | D/V  |

---

### ביבליוגרפיה

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)

