# אימות קלט משתמש C2

## מטרת הבקרה

אימות חזק של קלט משתמש הוא קו ההגנה הראשון מול חלק מההתקפות המזיקות ביותר על מערכות בינה מלאכותית. התקפות הזרקת פקודות (Prompt injection) יכולות להחליף הנחיות מערכת, לדלוף מידע רגיש, או להוביל את המודל להתנהגות שאינה מותרת. אלא אם כן קיימים פילטרים ייעודיים והירכיות הנחיות, מחקרים מראים ש"פריצות jailbreak מרובות" הניצלות מחלונות הקשר ארוכים מאוד יהיו יעילות. בנוסף, התקפות שינוי מתוחכמות -- כמו החלפות הומוגליפים או שימוש ב-leetspeak -- יכולות לשנות את ההחלטות של המודל באופן שקט.

---

## C2.1 הגנה מפני הזרקת פרומפט

הזרקת פרומפט היא אחד הסיכונים הגדולים ביותר למערכות בינה מלאכותית. ההגנות נגד טקטיקה זו משתמשות בשילוב של מסנני דפוסים סטטיים, מסווגים דינמיים ואכיפת היררכיית הוראות.

|   #   | Description                                                                                                                                                                        | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.1.1 | וודא שקלטי המשתמש מסוננים אל מול ספרייה שמתעדכנת באופן רציף של דפוסי הזרקת הנחיות ידועים (מילות מפתח להצתת סורגים, "התעלם מקודם", שרשראות משחק תפקידים, התקפות עקיפות ב-HTML/URL). |   1   | D/V  |
| 2.1.2 | אמת שהמערכת אוכפת היררכיית הוראות שבה הודעות של המערכת או המפתח גוברות על הוראות המשתמש, אפילו לאחר הרחבת חלון ההקשר.                                                              |   1   | D/V  |
| 2.1.3 | אמת שבדיקות הערכה עוינת (למשל, פקודות "many-shot" של צוות אדום) מתבצעות לפני כל שחרור של מודל או תבנית פקודה, עם סף שיעורי הצלחה וחוסמים אוטומטיים למניעת נסיגות.                  |   2   | D/V  |
| 2.1.4 | אמת כי ההנחיות המגיעות מתוכן של צד שלישי (דפי רשת, קבצי PDF, דוא"ל) מעובדות בסביבה מבודדת לפני שהן משולבות להנחיה הראשית.                                                          |   2   |  D   |
| 2.1.5 | אמתו שכל עדכוני כלל מסנן ההנחיות, גרסאות דגם הממיין ושינויים ברשימת החסימה מנוהלים בגרסאות וניתנים לביקורת.                                                                        |   3   | D/V  |

---

## C2.2 עמידות לדוגמאות עוינות

מודלים של עיבוד שפה טבעית (NLP) עדיין פגיעים להפרעות עדינות ברמה של תווים או מילים שלרוב בני אדם מפספסים אך המודלים נוטים לסווגן בצורה שגויה.

|   #   | Description                                                                                                                                         | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.2.1 | וודא ששלבי נרמול הקלט הבסיסיים (Unicode NFC, מיפוי הומוגליפים, חיתוך רווחים) מתבצעים לפני הטוקניזציה.                                               |   1   |  D   |
| 2.2.2 | אמת שבדיקת חריגות סטטיסטיות מסמנת קלטים עם מרחק עריכה גבוה מהממוצע לנורמות השפה, חזרות חריגות של טוקנים, או מרחקי הטמעה לא תקינים.                  |   2   | D/V  |
| 2.2.3 | וודא כי צינור האינפרנס תומך בגרסאות מודל מחוזקות באימון אדברסרי אופציונלי או בשכבות הגנה (למשל, אקראיות, דיסטילציה הגנתית) לנקודות קצה בסיכון גבוה. |   2   |  D   |
| 2.2.4 | וודא כי קלטים חשודים של התקפות מועברים לבידוד, מתועדים עם כל המטען (לאחר הסרת מידע אישי מזהה).                                                      |   2   |  V   |
| 2.2.5 | אמת שיתרונות העמידות (שיעור ההצלחה של חבילות התקפה ידועות) מנוטרים לאורך זמן ושהירידות בביצועים מפעילות חסימת שחרור.                                |   3   | D/V  |

---

## C2.3 אימות סכימה, סוג ואורך

התקפות בינה מלאכותית הכוללות קלטים מעוותים או גדולים מדי יכולות לגרום לשגיאות ניתוח, לדליפת פקודות בין שדות ולניצול יתר של משאבים. אכיפה מחמירה של סכימה היא גם דרישה מוקדמת בעת ביצוע קריאות לכלים דטרמיניסטיים.

|   #   | Description                                                                                                                                          | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.3.1 | וודא שלכל נקודת קצה של קריאת API או פונקציה מוגדרת סכמת קלט מפורשת (JSON Schema, Protobuf או מקבילה מולטימודלית) ושהקלטים מאותתים לפני הרכבת ההנחיה. |   1   |  D   |
| 2.3.2 | אמת כי קלטים החורגים מהמגבלות המקסימליות של טוקנים או בתים נדחים עם שגיאה בטוחה ולעולם אינם מקוצר במשתיקה.                                           |   1   | D/V  |
| 2.3.3 | אמת שהבדיקות מסוג (כגון טווחים מספריים, ערכי enum, סוגי MIME לתמונות/אודיו) נאכפות בצד השרת, ולא רק בקוד הלקוח.                                      |   2   | D/V  |
| 2.3.4 | וודא כי מאמתים סמנטיים (למשל, JSON Schema) פועלים בזמן קבוע כדי למנוע התקפות מניעת שירות אלגוריתמיות (DoS).                                          |   2   |  D   |
| 2.3.5 | וודא כי כישלונות אימות מתועדים עם קטעי_payload_מסוננים וקודי שגיאה ברורים כדי לסייע במיון אבטחה.                                                     |   3   |  V   |

---

## C2.4 סינון תוכן ומדיניות

מפתחים צריכים להיות מסוגלים לזהות פקודות תקינות תחבירית המבקשות תוכן אסור (כגון הוראות בלתי חוקיות, דיבור שנאה, וטקסט מוגן בזכויות יוצרים) ואז למנוע את הפצתן.

|   #   | Description                                                                                                                                       | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.4.1 | ודא כי מסווג תוכן (אפס ירי או מותאם אישית) מדרג כל קלט עבור אלימות, פגיעה עצמית, שנאה, תוכן מיני ובקשות בלתי חוקיות, עם ספי תצורה שניתנים להתאמה. |   1   |  D   |
| 2.4.2 | אמת שקלטים המפרים מדיניות יקבלו סירובים סטנדרטיים או השלמות בטוחות כדי שלא יתפשטו לקריאות מודל שפה גדולות (LLM) בהמשך.                            |   1   | D/V  |
| 2.4.3 | אמתו כי מודל הסינון או מערכת הכללים מתעדכנים/מאומנים מחדש לפחות אחת לרבעון, תוך שילוב דפוסי פריצת מסכות או עקיפת מדיניות שנצפו לאחרונה.           |   2   |  D   |
| 2.4.4 | אמת שהסינון מכבד מדיניות ספציפית למשתמש (גיל, מגבלות חוקיות אזוריות) באמצעות כללי מבוססי תכונות המיושמים בזמן הבקשה.                              |   2   |  D   |
| 2.4.5 | וודא כי יומני המסכים כוללים ציוני ביטחון של הממיין ותוויות קטגוריית מדיניות לצורך קורלציה עם SOC וניגון מחדש עתידי של צוות האדום.                 |   3   |  V   |

---

## C2.5 הגבלת קצב כניסה ומניעת ניצול לרעה

מפתחים צריכים למנוע שימוש לרעה, התנשות משאבים, ותקיפות אוטומטיות נגד מערכות בינה מלאכותית על ידי הגבלת קצבי קלט וזיהוי דפוסי שימוש חריגים.

|   #   | Description                                                                                                  | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.5.1 | אמת כי מגבלות קצב per-user, per-IP, ו-per-API-key נאכפות בכל נקודות הקצה של הקלט.                            |   1   | D/V  |
| 2.5.2 | אמת שגבולות קצב הפיצוץ והקצב המתמשך מכוונים למניעת התקפות דחיסת שירות (DoS) והתקפות כוחניות (brute force).   |   2   | D/V  |
| 2.5.3 | אמתו כי דפוסי שימוש חריגים (למשל, בקשות במהירות גבוהה, הצפה של קלט) מפעילים חסימות אוטומטיות או העלאות דרגה. |   2   | D/V  |
| 2.5.4 | וודא שרשומות מניעת התקפות נשמרות ונבדקות לזיהוי דפוסי התקפה מתפתחים.                                         |   3   |  V   |

---

## C2.6 אימות קלט רב-מודאלי

מערכות בינה מלאכותית צריכות לכלול אימות חזק עבור קלטים לא טקסטואליים (תמונות, אודיו, קבצים) כדי למנוע הזרקה, התחמקות או ניצול משאבים.

|   #   | Description                                                                                 | Level | Role |
| :---: | ------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.6.1 | וודא שכל הקלטים שאינם טקסט (תמונות, אודיו, קבצים) מאומתים לפי סוג, גודל ופורמט לפני העיבוד. |   1   |  D   |
| 2.6.2 | אמת כי הקבצים נסרקים לגילוי נוזקות ועומסי סתרים (סטגאנוגרפיה) לפני ההזנה.                   |   2   | D/V  |
| 2.6.3 | אמתו שקלטי תמונה/אודיו נבדקו עבור הפרעות עוינות או דפוסי התקפה ידועים.                      |   2   | D/V  |
| 2.6.4 | וודא כי כשלי אימות קלט רב-מודאלי מתועדים ומפעילים התראות לחקירה.                            |   3   |  V   |

---

## C2.7 מקור ותיחום קלט

מערכות בינה מלאכותית צריכות לתמוך בביקורת, במעקב אחר שימוש לרעה ובהתאמה לרגולציה על ידי ניטור ותיוג של מקורות כל קלטי המשתמשים.

|   #   | Description                                                                                      | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.7.1 | אשר שכל קלטי המשתמש מתויגים עם מטא-דאטה (מזהה משתמש, סשן, מקור, חותמת זמן, כתובת IP) בעת הקליטה. |   1   | D/V  |
| 2.7.2 | אמת כי מטה-נתוני המקור נשמרים וניתנים לביקורת עבור כל הקלטים המעובדים.                           |   2   | D/V  |
| 2.7.3 | וודא שמקורות קלט חריגים או לא מהימנים מסומנים ונתונים לבחינה מוגברת או לחסימה.                   |   2   | D/V  |

---

## C2.8 גילוי איומים אדפטיבי בזמן אמת

מפתחים צריכים להשתמש במערכות זיהוי איומים מתקדמות לבינה מלאכותית המתאימות את עצמן לתבניות התקפה חדשות ומספקות הגנה בזמן אמת באמצעות התאמת תבניות מקומפלת.

|   #   | Description                                                                                                                                | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.8.1 | אמתו כי דפוסי גילוי האיומים מותקנים במנועי ביטוי רגולרי (regex) מותאמים לטיפול יעיל בזמן אמת עם השפעה מזערית על ההשהייה.                   |   1   | D/V  |
| 2.8.2 | וודאו שמערכות זיהוי איומים שומרות ספריות תבניות נפרדות עבור קטגוריות איומים שונות (הזרקת פרומפט, תוכן מזיק, נתונים רגישים, פקודות מערכת).  |   1   | D/V  |
| 2.8.3 | וודא כי זיהוי איומים אדפטיבי משלב מודלים של למידת מכונה שמתעדכנים בהתבסס על תדירות ההתקפות ושיעורי ההצלחה של האיומים.                      |   2   | D/V  |
| 2.8.4 | אמת ששירותי מודיעין איומים בזמן אמת מעדכנים אוטומטית את ספריות הדפוסים עם חתימות התקפה חדשות ומדדי הפרה (Indicators of Compromise - IOCs). |   2   | D/V  |
| 2.8.5 | אמת שיחסי גילוי איומים חיוביים כוזבים מנוטרים באופן רציף ושתבנית הספציפיות מותאמת אוטומטית כדי למזער הפרעה למקרי שימוש לגיטימיים.          |   3   | D/V  |
| 2.8.6 | אמת שניתוח איומים קונטקסטואלי לוקח בחשבון את מקור הקלט, דפוסי התנהגות המשתמש והיסטוריית המפגשים על מנת לשפר את דיוק הגילוי.                |   3   | D/V  |
| 2.8.7 | וודא שמדדי ביצועי זיהוי איומים (שעור זיהוי, זמן עיבוד, ניצול משאבים) מנוטרים ומאובטחים בזמן אמת.                                           |   3   | D/V  |

---

## C2.9 צנרת אימות אבטחה רב-מודאלית

מפתחים צריכים לספק אימות אבטחה לטקסט, תמונה, אודיו ומודלים אחרים של קלט AI עם סוגים ספציפיים של זיהוי איומים ובידוד משאבים.

|   #   | Description                                                                                                                                                                 | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.9.1 | אמת שכל מודל קלט כולל מבקרי אבטחה ייעודיים עם דפוסי איומים מתועדים (טקסט: הזרקת פרומפט, תמונות: סטגנווגרפיה, שמע: התקפות ספקטרוגרמה) וספי גילוי.                            |   1   | D/V  |
| 2.9.2 | אמתו שקלטים רב-מודאליים עובדו בסביבת סנדבוקס מבודדת עם מגבלות משאבים מוגדרות (זיכרון, מעבד, זמן עיבוד) הספציפיות לכל סוג מודאליות ומתועדות במדיניות אבטחה.                  |   2   | D/V  |
| 2.9.3 | אמת כי זיהוי התקפות בין-מודאליות מזהה התקפות מתואמות החוצות סוגי קלט מרובים (למשל, עומסי סתגרפיה בתמונות בשילוב עם זריקת פקודות בטקסט) באמצעות חוקי קורלציה ויצירת התראות.  |   2   | D/V  |
| 2.9.4 | אמת כי כשלונות באימות רב-מודאלי מפעילים רישום מפורט הכולל את כל המואדיות הקלט, תוצאות האימות, ציוני האיומים, וניתוח קורלציה עם פורמטים מובנים של רישום לשילוב במערכות SIEM. |   3   | D/V  |
| 2.9.5 | וודא כי מסווגי תוכן ספציפיים למודאליות מתעדכנים בהתאם ללוחות זמנים מתועדים (מינימום רבעוני) עם דפוסי איום חדשים, דוגמאות עוינות, ותחומי ביצועים שנשמרים מעל ספי הבסיס.      |   3   | D/V  |

---

## ביבליוגרפיה

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)

