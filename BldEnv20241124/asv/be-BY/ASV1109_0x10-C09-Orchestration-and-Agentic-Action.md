# 9 Аўтаномная аркестроўка і бяспека агенцкай дзейнасці

## Мэта кантролю

Забяспечце, каб аўтаномныя або мультыагентныя сістэмы штучнага інтэлекту маглі выконваць толькі тыя дзеянні, якія адназначна прызначаныя, аўтэнтыфікаваныя, аўдытуюцца і знаходзяцца ў межах абмежаваных парогаў кошту і рызыкі. Гэта абараняе ад пагроз, такіх як кампраметацыя аўтаномнай сістэмы, злоўжыванне інструментамі, выяўленне цыклаў агента, захоп камунікацый, падрабязванне ідэнтычнасці, маніпуляцыя ройам і маніпуляцыя намерамі.

---

## 9.1 Бюджэты планавання задач агента і рэкурэнцыі

Абмяжуйце рэкурсіўныя планы і прымушайце праверкі чалавека пры выкананні прывілеяваных дзеянняў.

|   #   | Description                                                                                                                                                                               | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.1.1 | Праверце, ці максімальная глыбіня рэкурсіўнага выкліку, шырыня, рэальны час, колькасць токенаў і грашовы кошт за выкананне агента цэнтральна наладжаны і версіраваны.                     |   1   | D/V  |
| 9.1.2 | Праверце, каб прывілеяваныя або незваротныя дзеянні (напрыклад, фіксацыя кода, фінансавыя пераклады) патрабавалі выразнага чалавечага адабрэння праз аўдыравальны канал перад выкананнем. |   1   | D/V  |
| 9.1.3 | Пераканайцеся, што сістэмы маніторынгу рэсурсаў у рэальным часе выклікаюць перапыненне цыклу-разрыву, калі перавышаны любы парог бюджэту, спыняючы далейшае пашырэнне задач.              |   2   |  D   |
| 9.1.4 | Праверце, што падзеі аўтаматычнага адключальніка запісваюцца з ідэнтыфікатарам агента, умовай спрацоўвання і зафіксаваным станам плана для судова-экспертнага аналізу.                    |   2   | D/V  |
| 9.1.5 | Праверце, ці ахопліваюць тэсты бяспекі сцэнарыі вычарпання бюджэту і некантралюемага плана, пацвярджаючы бяспечную прыпыненне без страты дадзеных.                                        |   3   |  V   |
| 9.1.6 | Праверце, што бюджэтныя палітыкі выказаны як палітыка ў выглядзе кода і прымяняюцца ў CI/CD для прадухілення дрэйфу канфігурацыі.                                                         |   3   |  D   |

---

## 9.2 Пясочніца для плагінаў інструмента

Ізалюйце ўзаемадзеянне інструментаў, каб прадухіліць несанкцыянаваны доступ да сістэмы або выкананне кода.

|   #   | Description                                                                                                                                                                                                | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.2.1 | Праверце, каб кожны інструмент/плагін выконваўся ўнутры аперацыйнай сістэмы, кантэйнера або пясочніцы на ўзроўні WASM з палітыкамі мінімальных прывілеяў для файлавай сістэмы, сеткі і сістэмных выклікаў. |   1   | D/V  |
| 9.2.2 | Праверце, што квоты рэсурсаў пясочніцы (ЦП, памяць, дыск, выхадныя сеткавыя злучэнні) і тайм-аўты выканання прымяняюцца і рэгіструюцца.                                                                    |   1   | D/V  |
| 9.2.3 | Праверце, што файлы інструментаў або іх апісальнікі маюць лічбавы подпіс; подпісы правяраюцца перад загрузкай.                                                                                             |   2   | D/V  |
| 9.2.4 | Праверце, што тэлеметрыя пясочніцы адпраўляецца ў SIEM; анамаліі (напрыклад, спробы ўсталяваць злучэнні на выхад) выклікаюць апавяшчэнні.                                                                  |   2   |  V   |
| 9.2.5 | Праверце, каб плагіны з высокім рызыкай праходзілі агляд бяспекі і тэставанне на пранікненне перад разгортваннем у вытворчасць.                                                                            |   3   |  V   |
| 9.2.6 | Праверце, што спробы ўцёкаў з пясочніцы аўтаматычна блакуюцца, а вінаваты плагін змяшчаецца ў каранцін да завяршэння расследавання.                                                                        |   3   | D/V  |

---

## 9.3 Аўтаномны цыкл і абмежаванне выдаткаў

Вырайце і спыніце некантраляваныя рэкурсіі агент-да-агента і выбухі выдаткаў.

|   #   | Description                                                                                                                                    | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.3.1 | Праверце, што ўзаемадзеянні паміж агентамі ўключаюць ліміт пераходаў або TTL, які выканальнае асяроддзе памяншае і кантралюе.                  |   1   | D/V  |
| 9.3.2 | Праверце, што агенты падтрымліваюць унікальны ID графа выклікаў, каб выявіць самавыкананне або цыклічныя ўзоры.                                |   2   |  D   |
| 9.3.3 | Праверце, што кумулятыўныя лічыльнікі вылічальных блокаў і расходаў адсочваюцца для кожнага ланцуга запытаў; перавышэнне ліміту спыняе ланцуг. |   2   | D/V  |
| 9.3.4 | Праверце, што фармальны аналіз або праверка мадэлі дэманструюць адсутнасць неабмежаванай рэкурсіўнасці ў пратаколах агентаў.                   |   3   |  V   |
| 9.3.5 | Праверце, ці выклікаюць падзеі спынення цыкла папярэджанні і забяспечваюць метрыкі бесперапыннага ўдасканалення.                               |   3   |  D   |

---

## 9.4 Ахова ад злоўжыванняў на ўзроўні пратаколу

Бяспечныя каналы сувязі паміж агентамі і знешнімі сістэмамі для прадухілення захопу або маніпуляцый.

|   #   | Description                                                                                                                                                                                        | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.4.1 | Праверце, што ўсе паведамленні паміж агентам і інструментам, а таксама паміж агентамі, праходзяць аўтэнтыфікацыю (напрыклад, з выкарыстаннем узаемнага TLS або JWT) і шыфруюцца ад канца да канца. |   1   | D/V  |
| 9.4.2 | Праверце, што схемы строгa правяраюцца; невядомыя палі або пашкоджаныя паведамленні адхіляюцца.                                                                                                    |   1   |  D   |
| 9.4.3 | Праверце, што праверкі цэласнасці (MAC-ы або лічбавыя подпісы) ахопліваюць увесь груз паведамлення ўключна з параметрамі інструмента.                                                              |   2   | D/V  |
| 9.4.4 | Праверце, ці ажыццяўляецца абарона ад паўтарэння (nonce або акно метак часу) на ўзроўні пратаколу.                                                                                                 |   2   |  D   |
| 9.4.5 | Праверце, каб рэалізацыі пратаколаў праходзілі фузінг і статычны аналіз на наяўнасць уразлівасцяў у ін'екцыі або дэсерыялізацыі.                                                                   |   3   |  V   |

---

## 9.5 Асоба агента і доказ ненарушальнасці

Забеспечце магчымасць адсочвання дзеянняў і выяўлення змен.

|   #   | Description                                                                                                                                        | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.5.1 | Праверце, што кожны асобнік агента мае ўнікальную крыптаграфічную асобу (крыптаграфічную пару ключоў або кандзішн, заснаваны на апаратным карані). |   1   | D/V  |
| 9.5.2 | Праверце, каб усе дзеянні агента былі падпісаныя і пазначаныя часам; журналы ўключаюць подпіс для немагчымасці адхілення адказнасці.               |   2   | D/V  |
| 9.5.3 | Праверце, што змены ў журналах, якія паказваюць падробку, захоўваюцца ў носьбіце толькі для дадавання або ў адным фармаце запісу (write-once).     |   2   |  V   |
| 9.5.4 | Праверце, што ключы ідэнтыфікацыі круцяцца па вызначаным графіку і пры паказчыках кампраметацыі.                                                   |   3   |  D   |
| 9.5.5 | Праверце, што спробы падробкі або канфлікту ключоў выклікаюць неадкладную кватэрынацыю пацярпелага агента.                                         |   3   | D/V  |

---

## 9.6 Зніжэнне рызыкі з дапамогай шматагентных рояў

Змяншайце рызыкі калектыўнай паводзінаў праз ізаляцыю і фармальнае мадэляванне бяспекі.

|   #   | Description                                                                                                                                     | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.6.1 | Праверце, што агенты, якія працуюць у розных даменах бяспекі, выконваюцца ў ізаляваных пясочніцах часопіснага выканання або сеткавых сегментах. |   1   | D/V  |
| 9.6.2 | Праверце, што паводзіны рою мадэлююцца і фармальна правяраюцца на жывасць і бяспеку перад разгортваннем.                                        |   3   |  V   |
| 9.6.3 | Праверце, што маніторы часу выканання выяўляюць узнікаючыя небяспечныя ўзоры (напрыклад, асцыляцыі, завісі) і пачынаюць карэктыўныя дзеянні.    |   3   |  D   |

---

## 9.7 Аўтэнтыфікацыя / аўтарызацыя карыстальнікаў і інструментаў

Рэалізуйце надзейныя кантролі доступу для кожнай дзеянні, выкліканай агентам.

|   #   | Description                                                                                                                                                          | Level | Role |
| :---: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.7.1 | Праверце, што агенты аўтэнтыфікуюцца як прыярытэтныя суб'екты для наступных сістэм, ніколі не выкарыстоўваючы паўторна ўліковыя дадзеныя канчатковых карыстальнікаў. |   1   | D/V  |
| 9.7.2 | Праверце, што палітыкі дазволаў з дробнай дэталізацыяй абмяжоўваюць, якія інструменты агент можа выклікаць і якія параметры ён можа пастаўляць.                      |   2   |  D   |
| 9.7.3 | Праверце, што праверкі правоў пераглядаюцца пры кожным выкліку (пастаянная аўтарызацыя), а не толькі ў пачатку сеансу.                                               |   2   |  V   |
| 9.7.4 | Праверце, што дэлегаваныя прывілеі аўтаматычна сканчаюцца і патрабуюць паўторнага згоды пасля тайм-ауту або змены вобласці.                                          |   3   |  D   |

---

## 9.8 Бяспека камунікацыі паміж агентамі

Шыфруйце і забяспечвайце цэласнасць усіх паведамленняў паміж агентамі для прадухілення падслухоўвання і змянення.

|   #   | Description                                                                                                                                         | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.8.1 | Праверце, што ўзаемная аўтэнтыфікацыя і шыфраванне з ідэальнай сакрэтнасцю наперад (напрыклад, TLS 1.3) з'яўляюцца абавязковымі для каналаў агента. |   1   | D/V  |
| 9.8.2 | Праверце, што цэласнасць і паходжанне паведамлення пацверджаны перад апрацоўкай; пры збоі выклікаюцца апавяшчэнні і паведамленне адкідваецца.       |   1   |  D   |
| 9.8.3 | Праверце, ці захоўваецца метададзеныя сувязі (часавыя меткі, паслядоўныя нумары) для падтрымкі крыміналістычнай рэканструкцыі.                      |   2   | D/V  |
| 9.8.4 | Праверце, што фармальная верыфікацыя або мадэляванне пацвярджае, што станавая машына пратаколу не можа быць пераведзена ў небяспечныя станы.        |   3   |  V   |

---

## 9.9 Праверка намеру і прымяненне абмежаванняў

Праверце, ці супадаюць дзеянні агента з выказанымі карыстальнікам намеры і сістэмнымі абмежаваннямі.

|   #   | Description                                                                                                                                                                     | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.9.1 | Праверце, ці правяраюць галавічныя рашальнікі абмежаванняў перад выкананнем прапанаваныя дзеянні ў адпаведнасці з жорстка ўбудаванымі правіламі бяспекі і палітыкі.             |   1   |  D   |
| 9.9.2 | Праверце, што дзеянні з высокім уплывам (фінансавыя, разбуральныя, звязаныя з канфідэнцыяльнасцю) патрабуюць адназначнага пацверджання намеру ад карыстальніка, які іх ініцыюе. |   2   | D/V  |
| 9.9.3 | Праверце, што праверкі постумоваў пацвярджаюць, што завершаныя дзеянні дасягнулі меркаваныя эфекты без пабочных эфектаў; несупадзенні запускаюць адкат.                         |   2   |  V   |
| 9.9.4 | Праверце, што фармальныя метады (напрыклад, мадэляванне, доказ тэарэм) або тэсты на аснове ўласцівасцей паказваюць, што планы агента задавальняюць усе абвешчаныя абмежаванні.  |   3   |  V   |
| 9.9.5 | Праверце, каб выпадкі несупадзення намераў або парушэння абмежаванняў стымулявалі цыклы бесперапыннага ўдасканалення і абмен інфармацыяй аб пагрозах.                           |   3   |  D   |

---

## 9.10 Стратэгія бяспекі логікі агента

Бяспечны выбар і выкананне розных стратэгій разважання, уключаючы падыходы ReAct, Chain-of-Thought і Tree-of-Thoughts.

|   #    | Description                                                                                                                                                                                                                                     | Level | Role |
| :----: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.10.1 | Праверце, што выбар стратэгіі разваджання выкарыстоўвае дэтэрмінатыўныя крытэрыі (складанасць уводу, тып задачы, кантэкст бяспекі), і аднолькавыя ўваходныя даныя прыводзяць да аднолькавых выбараў стратэгіі ў межах аднаго кантэксту бяспекі. |   1   | D/V  |
| 9.10.2 | Праверце, ці ёсць у кожнай стратэгіі вырашэння задач (ReAct, Chain-of-Thought, Tree-of-Thoughts) спецыфічная праверка ўводу, ачышчэнне вынікаў і абмежаванні часу выканання, якія адпавядаюць яе кагнітыўнаму падыходу.                         |   1   | D/V  |
| 9.10.3 | Праверце, што пераходы стратэгіі разважання рэгіструюцца з поўным кантэкстам, уключаючы характарыстыкі ўводу, значэнні крытэрыяў выбару і метаданыя выканання для аднаўлення аўдытарскага шляху.                                                |   2   | D/V  |
| 9.10.4 | Праверце, што метад разважанняў «Дрэва думак» ўключае механізмы адсякання галін, якія спыняюць даследаванне пры выяўленні парушэнняў палітыкі, абмежаванняў рэсурсаў або межаў бяспекі.                                                         |   2   | D/V  |
| 9.10.5 | Праверце, што цыклы ReAct (Reason-Act-Observe) ўключаюць пункты праверкі на кожным этапе: верыфікацыю кроку разважання, аўтарызацыю дзеяння і санітызацыю назірання перад працягам.                                                             |   2   | D/V  |
| 9.10.6 | Праверце, што метрыкі прадукцыйнасці стратэгіі разважання (час выканання, выкарыстанне рэсурсаў, якасць вынікаў) кантралююцца з дапамогай аўтаматычных апавяшчэнняў, калі метрыкі выходзяць за межы наладжаных парогаў.                         |   3   | D/V  |
| 9.10.7 | Праверце, ці гібрыдныя падыходы да разважання, якія аб’ядноўваюць некалькі стратэгій, захоўваюць праверку ўводу і абмежаванні вываду ўсіх складовых стратэгій без абыходу любых кантроляў бяспекі.                                              |   3   | D/V  |
| 9.10.8 | Праверце, што тэставанне бяспекі стратэгіі разважання ўключае фузінг з некарэктнымі ўводнымі дадзенымі, варажэбныя падказкі, распрацаваныя для прымушэння пераключэння стратэгіі, і тэставанне межавых умоў для кожнага кагнітыўнага падыходу.  |   3   | D/V  |

---

## 9.11 Кіраванне станам жыццёвага цыклу агента і бяспека

Бяспечная ініцыялізацыя агенту, пераходы станаў і завяршэнне з криптаграфічнымі аўдытнымі слядамі і вызначанымі працэдурамі аднаўлення.

|   #    | Description                                                                                                                                                                                                                                                                                               | Level | Role |
| :----: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.11.1 | Праверце, што ініцыялізацыя агента ўключае ўстанаўленне крыптаграфічнай асобы з выкарыстаннем абсталяваных кантралём прылад і непадзельных журналаў аўдыту запуску, якія ўтрымліваюць ідэнтыфікатар агента, часовы штамп, хэш канфігурацыі і параметры ініцыялізацыі.                                     |   1   | D/V  |
| 9.11.2 | Праверце, што пераходы стану агента криптографічна падпісаны, пазначаны часам і запісаны з поўным кантэкстам, уключаючы выклікаючыя падзеі, хэш папярэдняга стану, хэш новага стану і выкананыя праверкі бяспекі.                                                                                         |   2   | D/V  |
| 9.11.3 | Праверце, што працэдуры завяршэння працы агента ўключаюць бяспечнае ачышчэнне памяці з выкарыстаннем крыптаграфічнага сцёрвання або шматразовага перазапісу, адкліканне ўліковых дадзеных з апавяшчэннем органа сертыфікацыі, а таксама генерацыю сертыфікатаў завяршэння з доказамі аб спробах умяшання. |   2   | D/V  |
| 9.11.4 | Пацвердзіце, што механізмы аднаўлення агента правяраюць цэласнасць стану з дапамогай крыптаграфічных кантрольных сум (мінімума SHA-256) і адкочваюцца да вядомых правільных станаў пры выяўленні пашкоджанняў з аўтаматызаванымі апавяшчэннямі і патрабаваннямі ручнога зацвярджэння.                     |   3   | D/V  |
| 9.11.5 | Праверце, што механізмы захоўвання агента шыфруюць канфідэнцыяльныя даныя стану з дапамогай індывідуальных ключоў AES-256 для кожнага агента і рэалізуюць бяспечную ротацыю ключоў па канфігуруемых графіках (максімум 90 дзён) з разгортваннем без прастояў.                                             |   3   | D/V  |

---

## 9.12 Рамка бяспекі інтэграцыі інструментаў

Кантроль бяспекі для дынамічнай загрузкі інструментаў, іх выканання і праверкі вынікаў з вызначанымі працэсамі ацэнкі рызыкі і зацвярджэння.

|   #    | Description                                                                                                                                                                                                                                                                                 | Level | Role |
| :----: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 9.12.1 | Праверце, ці ўключаюць апісанні інструментаў метаданыя бяспекі, якія ўказваюць неабходныя прывілеі (чытаць/запісваць/выконваць), узроўні рызыкі (нізкі/сярэдні/высокі), абмежаванні рэсурсаў (ЦП, памяць, сетка) і патрабаванні да верыфікацыі, задокументаваныя ў манифестах інструментаў. |   1   | D/V  |
| 9.12.2 | Праверце, што вынікі выканання інструмента валідуюцца ў адпаведнасці з чаканымі схемамі (JSON Schema, XML Schema) і палітыкамі бяспекі (санітызацыя вываду, класіфікацыя дадзеных) перад інтэграцыяй з абмежаваннямі часу выканання і працэдурамі апрацоўкі памылак.                        |   1   | D/V  |
| 9.12.3 | Праверце, што журналы ўзаемадзеяння інструмента ўключаюць падрабязны кантэкст бяспекі, у тым ліку выкарыстанне прывілеяў, схемы доступу да даных, час выканання, спажыванне рэсурсаў і коды вяртання з структураваным лагаваннем для інтэграцыі з SIEM.                                     |   2   | D/V  |
| 9.12.4 | Праверце, ці гарантуе механізм дынамічнай загрузкі інструментаў праверку лічбавых подпісаў з выкарыстаннем інфраструктуры PKI і рэалізуе пратаколы бяспечнай загрузкі з ізаляцыяй у пясочніцы і праверкай дазволаў перад выкананнем.                                                        |   2   | D/V  |
| 9.12.5 | Праверце, што ацэнкі бяспекі інструментаў аўтаматычна запускаюцца для новых версій з абавязковымі этапамі адабрэння, уключаючы статычны аналіз, дынамічнае тэставанне і агляд бяспекі камандай з дакументаванымі крытэрамі адабрэння і патрабаваннямі SLA.                                  |   3   | D/V  |

---

### Спасылкі

* [MITRE ATLAS tactics ML09](https://atlas.mitre.org/)
* [Circuit-breaker research for AI agents — Zou et al., 2024](https://arxiv.org/abs/2406.04313)
* [Trend Micro analysis of sandbox escapes in AI agents — Park, 2025](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/unveiling-ai-agent-vulnerabilities-code-execution)
* [Auth0 guidance on human-in-the-loop authorization for agents — Martinez, 2025](https://auth0.com/blog/secure-human-in-the-loop-interactions-for-ai-agents/)
* [Medium deep-dive on MCP & A2A protocol hijacking — ForAISec, 2025](https://medium.com/%40foraisec/security-analysis-potential-ai-agent-hijacking-via-mcp-and-a2a-protocol-insights-cd1ec5e6045f)
* [Rapid7 fundamentals on spoofing attack prevention — 2024](https://www.rapid7.com/fundamentals/spoofing-attacks/)
* [Imperial College verification of swarm systems — Lomuscio et al.](https://sail.doc.ic.ac.uk/projects/swarms/)
* [NIST AI Risk Management Framework 1.0, 2023](https://nvlpubs.nist.gov/nistpubs/ai/nist.ai.100-1.pdf)
* [WIRED security briefing on encryption best practices, 2024](https://www.wired.com/story/encryption-apps-chinese-telecom-hacking-hydra-russia-exxon)
* [OWASP Top 10 for LLM Applications, 2025](https://owasp.org/www-project-top-10-for-large-language-model-applications/)
* [Comprehensive Vulnerability Analysis is Necessary for Trustworthy LLM-MAS](https://arxiv.org/html/2506.01245v1)
* [How Is LLM Reasoning Distracted by Irrelevant Context?
  An Analysis Using a Controlled Benchmark](https://www.arxiv.org/pdf/2505.18761)
* [Large Language Model Sentinel: LLM Agent for Adversarial Purification](https://arxiv.org/pdf/2405.20770)
* [Securing Agentic AI: A Comprehensive Threat Model and Mitigation Framework for Generative AI Agents](https://arxiv.org/html/2504.19956v2)

