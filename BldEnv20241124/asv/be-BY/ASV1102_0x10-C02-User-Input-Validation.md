# Праверка карыстальніцкага ўводу C2

## Мэта кіравання

Надзейная праверка карыстальніцкага ўводу з'яўляецца першай лініяй абароны ад адных з самых шкодных атак на сістэмы штучнага інтэлекту. Атаки ўзлому праз вставку падказак могуць перапісваць сістэмныя інструкцыі, выцягваць канфідэнцыяльныя дадзеныя або накіроўваць мадэль на непрыкметныя паводзіны. Калі не ўсталяваны спецыяльныя фільтры і іерархіі інструкцый, даследаванні паказваюць, што "шматразовыя" ўзломы, якія выкарыстоўваюць вельмі доўгія кантэкстныя вокны, будуць эфектыўнымі. Таксама тонкія атакі з выкарыстаннем адвэрсарыяльных змяненняў — такія як замены гомагліфаў або лістспік— могуць ціхамірна змяняць рашэнні мадэлі.

---

## C2.1 Абарона ад уколу падказак

Ін'екцыя запытаў з'яўляецца адным з галоўных рызыкаў для сістэм штучнага інтэлекту. Абарона ад гэтай тактыкі ўключае камбінацыю статычных фільтраў па ўзорах, дынамічных класіфікатараў і забеспячэння выканання іерархіі інструкцый.

|   #   | Description                                                                                                                                                                                                                                             | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.1.1 | Праверце, ці праходзяць уваходныя даныя карыстальніка фільтрацыю праз пастаянна абнаўляльную бібліятэку вядомых шаблонаў ін'екцый падказак (ключавыя словы jailbreak, "ігнараваць папярэдняе", ланцужкі ролевых гульняў, ускосныя атакі праз HTML/URL). |   1   | D/V  |
| 2.1.2 | Праверце, ці забяспечвае сістэма захаванне іерархіі інструкцый, у якой паведамленні сістэмы або распрацоўшчыка маюць вышэйшы прыярытэт за інструкцыі карыстальніка, нават пасля пашырэння кантэкстнага акна.                                            |   1   | D/V  |
| 2.1.3 | Праверце, каб тэсты супрацьдзеяння атак (напрыклад, шматразовыя запыты Чырвонай каманды) выконваліся перад кожным выпуском мадэлі або шаблона запытаў, з усталяванымі парогамі ўзроўню паспяховасці і аўтаматызаванымі блакіроўкамі для рэгрэсій.       |   2   | D/V  |
| 2.1.4 | Праверце, што запыты, якія паходзяць з кантэнту трэціх бакоў (вэб-старонкі, PDF-дакументы, электронныя лісты), ачышчаюцца ў ізаляваным кантэксце разбору перад іх далучэннем да галоўнага запыту.                                                       |   2   |  D   |
| 2.1.5 | Праверце, што ўсе абнаўленні правілаў фільтрацыі падказак, версіі мадэляў класіфікатараў і змены ў чорным спісе кіруюцца версіямі і падлягаюць аўдыту.                                                                                                  |   3   | D/V  |

---

## C2.2 Устойлівасць да атак з дапамогай адвярсальных прыкладаў

Мадэлі апрацоўкі натуральнай мовы (NLP) па-ранейшаму ўразлівыя да тонкіх парушэнняў на ўзроўні знакаў або слоў, якія людзі часта не заўважаюць, але мадэлі схільныя няправільна класіфікаваць.

|   #   | Description                                                                                                                                                                                                              | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.2.1 | Праверце, што асноўныя крокі нармалізацыі ўваходных даных (Unicode NFC, адлюстраванне гамагліфаў, абразанне прабелаў) выконваюцца перад токенізацыяй.                                                                    |   1   |  D   |
| 2.2.2 | Праверце, што статыстычнае выяўленне анамалій адзначае ўваходныя дадзеныя з незвычайна высокай адлегласцю рэдакцый ад нормы мовы, празмернымі паўтаранымі токенамі або ненармальнымі адлегласцямі ў вектарных уяўленнях. |   2   | D/V  |
| 2.2.3 | Праверце, ці падтрымлівае канвеер вываду неабавязковыя мадэлі, умацаваныя шляхам праціўніцкага навучання, або абарончыя слаі (напрыклад, рандомізацыю, абарончую дыстыляцыю) для высокарызыкоўных канчатковых кропак.    |   2   |  D   |
| 2.2.4 | Праверце, каб падазроныя варожыя ўваходныя дадзеныя былі ізаляваны, зарэгістраваны з поўным змесцівам (пасля рэдактуры асабістых дадзеных).                                                                              |   2   |  V   |
| 2.2.5 | Праверце, што метрыкі ўстойлівасці (працэнт паспяховасці вядомых набораў атак) адсочваюцца ў часе і рэгрэсіі выклікаюць блакіроўку выпуску.                                                                              |   3   | D/V  |

---

## C2.3 Праверка схемы, тыпу і даўжыні

Атакі штучнага інтэлекту з выкарыстаннем пашкоджаных ці празмерна вялікіх уваходных даных могуць выклікаць памылкі разбору, пераліванне падказак праз палі і вычарпанне рэсурсаў. Строгае выкананне схемы таксама з'яўляецца папярэдняй умовай пры выкананні дэтэрмінатыўных выклікаў інструментаў.

|   #   | Description                                                                                                                                                                                                            | Level | Role |
| :---: | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.3.1 | Праверце, што кожны API або выклік функцыі мае выразна вызначаную схему ўваходных дадзеных (JSON Schema, Protobuf або эквівалент у мультымодальным фармаце) і што ўваходныя даныя правяраюцца перад складаннем запыту. |   1   |  D   |
| 2.3.2 | Праверце, што ўводы, якія перавышаюць максімальныя абмежаванні па колькасці токенаў або байтаў, адхіляюцца з бяспечнай памылкай і ніколі не абразаюцца маўкліва.                                                       |   1   | D/V  |
| 2.3.3 | Праверце, што праверкі тыпаў (напрыклад, лікавыя дыяпазоны, пералічальныя значэнні, MIME-тыпаў для малюнкаў/аўдыё) выконваюцца на баку сервера, а не толькі ў кліенцкім кодзе.                                         |   2   | D/V  |
| 2.3.4 | Праверце, што семантычныя валідацыі (напрыклад, JSON Schema) выконваюцца за пастаянны час, каб прадухіліць алгарытмічныя DoS-атакі.                                                                                    |   2   |  D   |
| 2.3.5 | Праверце, што збояў валідацыі рэгіструюцца з абрэзанымі ўрывкамі нагрузкі і недвухсэнсоўнымі кодамі памылак для палягчэння трыяжа бяспекі.                                                                             |   3   |  V   |

---

## C2.4 Фільтрацыя змесціва і палітыкі

Распрацоўшчыкі павінны мець магчымасць выяўляць сінтаксічна карэктныя запыты, якія просяць непазволены кантэнт (такі як незаконныя інструкцыі, мова нянавісці і тэксты з аўтарскім правам), а затым прадухіляць іх распаўсюджванне.

|   #   | Description                                                                                                                                                                                                               | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.4.1 | Праверце, ці ацэньвае класіфікатар кантэнту (zero shot або з дадатковым навучаннем) кожны ўваход па крытэрах гвалту, самаахвярнасці, дзвярства, сэксуальнага змесціва і незаконных запытаў, з магчымасцю наладкі парогаў. |   1   |  D   |
| 2.4.2 | Праверце, што ўваходныя дадзеныя, якія парушаюць палітыкі, атрымаюць стандартныя адмовы або бяспечныя завяршэнні, каб яны не распаўсюджваліся на наступныя выклікі LLM.                                                   |   1   | D/V  |
| 2.4.3 | Праверце, ці мадэль адсеву або набор правіл перанавучаецца/абнаўляецца не радзей чым штоквартальна, уключаючы новыя выяўленыя схемы абыходу абмежаванняў або палітыкі.                                                    |   2   |  D   |
| 2.4.4 | Правярайце, каб скрынінг адпавядаў карыстальніцкім палітыкам (узрост, рэгіянальныя прававыя абмежаванні) праз правілы на аснове атрыбутаў, якія вырашаюцца ў момант запыту.                                               |   2   |  D   |
| 2.4.5 | Праверце, ці ўключаюць журналы скрынінгу ацэнкі даверу класіфікатара і тэгі катэгорый палітыкі для карэляцыі SOC і будучага прайгравання чырвонай каманды.                                                                |   3   |  V   |

---

## C2.5 Абмежаванне хуткасці ўваходных дадзеных і прадухіленне злоўжыванняў

Распрацоўшчыкі павінны прадухіляць злоўжыванні, вычарпанне рэсурсаў і аўтаматызаваныя атакі на сістэмы штучнага інтэлекту, абмяжоўваючы хуткасць уводу і выяўляючы анамальныя ўзоры выкарыстання.

|   #   | Description                                                                                                                                            | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.5.1 | Праверце, што абмежаванні частаты для кожнага карыстальніка, кожнага IP-адраса і кожага API-ключа выконваюцца для ўсіх уваходных канечных кропак.      |   1   | D/V  |
| 2.5.2 | Праверце, што ліміты хуткасці пікаў і працягласці настроены для прадухілення DoS і брутфорс-атак.                                                      |   2   | D/V  |
| 2.5.3 | Праверце, што анамальныя ўзоры выкарыстання (напрыклад, хуткія запыты, захлёст уваходных дадзеных) выклікаюць аўтаматычнае блакіраванне або эскалацыю. |   2   | D/V  |
| 2.5.4 | Праверце, што журналы прадухілення злоўжыванняў захоўваюцца і аналізуюцца для выяўлення новых схем атак.                                               |   3   |  V   |

---

## C2.6 Праверка ўваходных дадзеных з мультымадальнай інфармацыяй

Сістэмы ШІ павінны ўключаць надзейную валідацыю для нетэкставых уводаў (малюнкі, аўдыё, файлы) каб прадухіліць уколы, абыход або злоўжыванне рэсурсамі.

|   #   | Description                                                                                                                                             | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.6.1 | Праверце, каб усе ўваходныя даныя, якія не з’яўляюцца тэкставымі (выявы, аўдыё, файлы), праходзілі праверку па тыпу, памеры і фармаце перад апрацоўкай. |   1   |  D   |
| 2.6.2 | Праверце, што файлы скануюцца на наяўнасць шкоднасных праграм і стеганаграфічных нагрузак перад загрузкай.                                              |   2   | D/V  |
| 2.6.3 | Праверце, ці ажыццяўляецца праверка ўваходных малюнкаў/аўдыё на наяўнасць адвэрсарыяльных перамен або вядомых узораў атак.                              |   2   | D/V  |
| 2.6.4 | Праверце, што няўдачы ў праверцы ўводу з некалькіх рэжымаў фіксуюцца ў журналах і выклікаюць апавяшчэнні для расследавання.                             |   3   |  V   |

---

## C2.7 Паходжанне ўводу і атрыбуцыя

Сістэмы ШІ павінны падтрымліваць аўдыт, адсочванне злоўжыванняў і выкананне патрабаванняў праз маніторынг і пазначэнне крыніц усіх уваходных дадзеных карыстальнікаў.

|   #   | Description                                                                                                                                                  | Level | Role |
| :---: | ------------------------------------------------------------------------------------------------------------------------------------------------------------ | :---: | :--: |
| 2.7.1 | Праверце, каб усе ўводныя дадзеныя карыстальніка былі пазначаны метаданымі (ідэнтыфікатар карыстальніка, сесія, крыніца, часавы штамп, IP-адрас) пры ўводзе. |   1   | D/V  |
| 2.7.2 | Праверце, што метаданыя паходжання захоўваюцца і даступныя для аўдыту для ўсіх апрацаваных уводных дадзеных.                                                 |   2   | D/V  |
| 2.7.3 | Праверце, каб анамальныя або ненадзейныя крыніцы ўваходных даных былі пазначаны і падвергнуты ўзмоцненаму кантролю або блакаванню.                           |   2   | D/V  |

---

## C2.8 Адаптыўнае выяўленне пагроз у рэальным часе

Распрацоўшчыкі павінны выкарыстоўваць перадавыя сістэмы выяўлення пагроз для штучнага інтэлекту, якія адаптуюцца да новых узораў атакаў і забяспечваюць рэальную абарону ў рэжыме рэальнага часу з дапамогай кампіліраванага супастаўлення ўзораў.

|   #   | Description                                                                                                                                                                             | Level | Role |
| :---: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.8.1 | Праверце, што схемы выяўлення пагроз кампіліруюцца ў аптымізаваныя рэляксныя рухавікі для высокаэфектыўнай рэальнай фільтрацыі з мінімальным уплывам на затрымку.                       |   1   | D/V  |
| 2.8.2 | Праверце, ці падтрымліваюць сістэмы выяўлення пагроз асобныя бібліятэкі шаблонаў для розных катэгорый пагроз (увадка падказак, шкодны змест, адчувальныя даныя, сістэмныя каманды).     |   1   | D/V  |
| 2.8.3 | Праверце, што адаптыўнае выяўленне пагроз выкарыстоўвае мадэлі машыннага навучання, якія абнаўляюць адчувальнасць да пагроз у залежнасці ад частаты атак і ўзроўню іх паспяховасці.     |   2   | D/V  |
| 2.8.4 | Праверце, што патокі інфармацыі пра пагрозы ў рэальным часе аўтаматычна абнаўляюць бібліятэкі шаблонаў новымі сігнатурамі атак і ІВО (Індэкатары кампраметацыі).                        |   2   | D/V  |
| 2.8.5 | Праверце, што ўзровень памылковых сігналаў аб пагрозах пастаянна кантралюецца, а спецыфічнасць ўзораў аўтаматычна наладжваецца для мінімізацыі перашкод законным выпадкам выкарыстання. |   3   | D/V  |
| 2.8.6 | Праверце, што кантэкстуальны аналіз пагроз улічвае крыніцу ўваходных даных, мадэлі паводзін карыстальнікаў і гісторыю сесій дзеля павышэння дакладнасці выяўлення.                      |   3   | D/V  |
| 2.8.7 | Праверце, ці адсочваюцца і аптымізуюцца метрыкі эфектыўнасці выяўлення пагроз (хуткасць выяўлення, затрымка апрацоўкі, выкарыстанне рэсурсаў) у рэжыме рэальнага часу.                  |   3   | D/V  |

---

## C2.9 Мультымадальны канвеер праверкі бяспекі

Распрацоўшчыкі павінны забяспечваць праверку бяспекі для тэксту, выявы, аудыё і іншых мадальнасцей уводу ШІ з выкарыстаннем спецыфічных тыпаў выяўлення пагроз і ізаляцыі рэсурсаў.

|   #   | Description                                                                                                                                                                                                                                                                         | Level | Role |
| :---: | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---: | :--: |
| 2.9.1 | Праверце, што кожны ўводны модаль мае спецыялізаваныя праваднікі бяспекі з дакументаванымі шаблонамі пагроз (тэкст: ін'екцыя падказак, выявы: стэганаграфія, аўдыё: атакі па спектраграме) і парогамі выяўлення.                                                                    |   1   | D/V  |
| 2.9.2 | Праверце, што мультымадальныя ўваходы апрацоўваюцца ў адасобленых пясочніцах з вызначанымі абмежаваннямі рэсурсаў (памяць, ЦП, час апрацоўкі), спецыфічнымі для кожнага тыпу мадальнасці і дакументавана ў палітыках бяспекі.                                                       |   2   | D/V  |
| 2.9.3 | Праверце, ці выяўляе сістэма выяўлення перакрыжаваных атак каардынаваныя атакі, якія ахопліваюць некалькі тыпаў уводу (напрыклад, стэганаграфічныя нагрузкі ў выявах разам з уводам падказак у тэксце) з дапамогай правіл карэляцыі і генерацыі апавяшчэнняў.                       |   2   | D/V  |
| 2.9.4 | Праверце, што адмовы ў мультымадальнай валідацыі выклікаюць падрабязнае рэгістраванне, уключаючы ўсе ўводныя мадальнасці, вынікі валідацыі, балы пагроз і карэляцыйны аналіз з выкарыстаннем структураваных фарматаў журналаў для інтэграцыі са SIEM.                               |   3   | D/V  |
| 2.9.5 | Праверце, што класіфікатары змесціва, спецыфічныя для кожнага рэжыму, абнаўляюцца ў адпаведнасці з дакументаванымі графікамі (мінімум штоквартальна) з новым узорам пагроз, адвэрсарыяльнымі прыкладамі і паказчыкамі прадукцыйнасці, якія падтрымліваюцца вышэй за базавыя парогі. |   3   | D/V  |

---

## Спасылкі

* [LLM01:2025 Prompt Injection – OWASP Top 10 for LLM & Generative AI Security](https://genai.owasp.org/llmrisk/llm01-prompt-injection/)
* [Generative AI's Biggest Security Flaw Is Not Easy to Fix](https://www.wired.com/story/generative-ai-prompt-injection-hacking)
* [Many-shot jailbreaking \ Anthropic](https://www.anthropic.com/research/many-shot-jailbreaking)
* [$PDF$ OpenAI GPT-4.5 System Card](https://cdn.openai.com/gpt-4-5-system-card-2272025.pdf)
* [Notebook for the CheckThat Lab at CLEF 2024](https://ceur-ws.org/Vol-3740/paper-53.pdf)
* [Mitigate jailbreaks and prompt injections – Anthropic](https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks)
* [Chapter 3 MITRE ATT\&CK – Adversarial Model Analysis](https://ama.drwhy.ai/mitre-attck.html)
* [OWASP Top 10 for LLM Applications 2025 – WorldTech IT](https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/)
* [OWASP Machine Learning Security Top Ten](https://owasp.org/www-project-machine-learning-security-top-10/)
* [Few words about AI Security – Jussi Metso](https://www.jussimetso.com/index.php/2024/09/28/few-words-about-ai-security/)
* [How To Ensure LLM Output Adheres to a JSON Schema | Modelmetry](https://modelmetry.com/blog/how-to-ensure-llm-output-adheres-to-a-json-schema)
* [Easily enforcing valid JSON schema following – API](https://community.openai.com/t/feature-request-function-calling-easily-enforcing-valid-json-schema-following/263515?utm_source)
* [AI Safety + Cybersecurity R\&D Tracker – Fairly AI](https://www.fairly.ai/blog/ai-cybersecurity-tracker)
* [Anthropic makes 'jailbreak' advance to stop AI models producing harmful results](https://www.ft.com/content/cf11ebd8-aa0b-4ed4-945b-a5d4401d186e)
* [Pattern matching filter rules - IBM](https://www.ibm.com/docs/ssw_aix_71/security/intrusion_pattern_matching_filter_rules.html)
* [Real-time Threat Detection](https://www.darktrace.com/cyber-ai-glossary/real-time-threat-detection)

